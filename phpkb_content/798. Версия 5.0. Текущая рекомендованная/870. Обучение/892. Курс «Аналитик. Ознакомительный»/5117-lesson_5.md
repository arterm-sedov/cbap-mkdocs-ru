---
title: 'Урок 5. Автоматизация: сценарии, вычисления, условия и проверки'
kbId: 5117
url: 'https://kb.comindware.ru/article.php?id=5117'
---

# Урок 5. Автоматизация: сценарии, вычисления, условия и проверки

## Введение

В ходе этого урока вы научитесь автоматизировать бизнес-процесс найма персонала с помощью сценариев, вычисляемых атрибутов и формул. Мы рассмотрим, как реализовать автоматические проверки и условия перехода между этапами процесса, используя инструменты ПО **{{ productName }}**.

**Предусловия:** пройден [урок 2 «Первый реестр данных»][tutorial_hr_lesson_2].

**Расчётная продолжительность:** 60 мин.

Примечание

В данном уроке представлен продукт **{{ productName }}** версии 5.0, внешний вид страниц и меню в других версиях продукта может отличаться.

Бизнес-логика

В рамках процесса найма персонала кандидат считается успешно прошедшим собеседование, если его Оценка за собеседование составляет 8 баллов и выше, а также он прошёл проверку службы безопасности.

Для этого реализуем следующий порядок действий:

1. *HR-менеджер* и *Нанимающий менеджер* проводят собеседование с кандидатом и фиксируют оценку.
2. *Сотрудник службы безопасности* проводит проверку кандидата и фиксирует результат.
3. Если оба условия выполнены (оценка ≥ 8 и проверка пройдена), система автоматически отмечает кандидата как успешно прошедшего этап и инициирует формирование предложения о работе.
4. В противном случае кандидат считается не прошедшим этап, и процесс завершается соответствующим статусом.

Для автоматизации этой процедуры используем сценарий с вычислением на языке формул **Comindware**.

## Темы, навыки и задания урока

**Темы**

- Сценарии
- Вычисляемые атрибуты
- Язык формул

**Навыки**

- Добавлять и настраивать сценарии для процесса
- Использовать вложенные формы и настраивать доступ к ним
- Пользоваться редактором выражений
- Использовать формулы

**Задания**

- На форму задачи *«Провести собеседование»* поместить вложенную форму с данными кандидата и поля с данными собеседования кандидата.
- Реализовать отслеживание статуса проверки кандидата службой безопасности и оценки за собеседование: логический атрибут и развилки с условным выбором потока на диаграмме процесса.
- Добавить развилки и завершающие события на диаграмму процесса для выполнения усовершенствованной бизнес-логики.
- Проверить, опубликовать и протестировать обновлённый процесс

## Определения

- **Сценарий** — последовательность действий, выполняемых системой автоматически при наступлении определённого события.
- **Вычисляемый атрибут** — атрибут, значение которого формируется автоматически с использованием формулы.
- **Язык формул Comindware** — специальный язык для написания выражений, позволяющих вычислять значения атрибутов и управлять логикой процесса.

### Доработка формы задачи «Зафиксировать результаты тестирования»

Усовершенствуем форму задачи *«Зафиксировать результаты тестирования»*:

- сделаем переключатель результата тестирования наглядным *«Тестирование пройдено / не пройдено»*, вместо неинформативных вариантов *«Да/Нет»*;
- сделаем указание результата тестирования обязательным.

1. Откройте диаграмму процесса *«Найм персонала»* для редактирования.
2. Перейдите к задаче *«Зафиксировать результаты тестирования»*.
3. Нажмите поле атрибута *«Результат тестирования»*.
4. Измените **доступ** к полю на «**Требовать ввод**».
5. В свойстве поля «**Отображать как**» выберите «**Переключатель**».
6. Установите флажок «**Изменить названия вариантов**».
7. Укажите следующие названия вариантов:

   - **Истина:** *Тестирование пройдено*
   - **Ложь:** *Тестирование не пройдено*
8. Сохраните форму задачи.

_![Настройка формы задачи «Зафиксировать результаты тестирования»](/platform/v5.0/tutorials/tutorial_hr/img/lesson_5_task_test_form.png)_

## Доработка формы задачи «Провести собеседование»

Добавим на форму задачи *«Провести собеседование»* полезные поля, зададим ограничение для ввода оценки и настроим наглядный переключатель для фиксации результата собеседования.

1. Откройте диаграмму процесса *«Найм персонала»* для редактирования.
2. Откройте пользовательскую задачу *«Провести собеседование»*.
3. В область *«Результаты собеседования»* добавьте атрибут *«Дата и время собеседования»*.
4. Выберите поле *«Оценка за собеседование»* на макете формы.
5. С помощью панели свойств поля измените **доступ** на «**Требовать ввод**».
6. В свойстве поля «**Максимум**» укажите число *10*. Так мы зададим максимально допустимое значение для ввода в поле.
7. Удалите с формы поле *«Результат собеседования»*. Мы настроим автоматическое вычисление атрибута *«Результат собеседования»* и соответствующие переходы на диаграмме процесса. См. *«[Настройка переходов и сценариев на диаграмме процесса](#tutorial_hr_lesson_5_diagram_scenarios)»*.
8. Сохраните форму.

_![Настройка формы задачи «Провести собеседование»](/platform/v5.0/tutorials/tutorial_hr/img/lesson_5_task_interview.png)_

## Доработка формы задачи «Провести проверку кандидата»

Усовершенствуем форму задачи для службы безопасности:

- сделаем переключатель результата наглядным *«Проверка пройдена / не пройдена»*, вместо неинформативных вариантов *«Да/Нет»*;
- сделаем указание результата проверки обязательным.

1. Откройте диаграмму шаблон процесса *«Найм персонала»* для редактирования.
2. Откройте пользовательскую задачу *«Провести проверку кандидата»*.
3. Нажмите поле атрибута *«Проверка службы безопасности»*.
4. Измените **доступ** к полю на «**Требовать ввод**».
5. В свойстве поля «**Отображать как**» выберите «**Переключатель**».
6. Установите флажок «**Изменить названия вариантов**».
7. Укажите следующие названия вариантов:

   - **Истина:** *Прошёл проверку*
   - **Ложь:** *Не прошёл*
8. Сохраните форму.

_![Настройка формы задачи «Провести проверку кандидата»](/platform/v5.0/tutorials/tutorial_hr/img/lesson_5_task_check.png)_

## Настройка переходов и сценариев на диаграмме процесса

Настроим сценарий и условия переходов на диаграмме процесса, чтобы реализовать бизнес-логику автоматического определения результата собеседования и дальнейших действий.

Бизнес-логика

Кандидат считается успешно прошедшим собеседование, если его оценка будет больше или равна 8 баллам и он пройдёт проверку *Службы безопасности*.

Для этого настроим изменение значения логического атрибута *«Результат собеседования»* при помощи сценария.

1. Откройте диаграмму шаблон процесса *«Найм персонала»* для редактирования.
2. Выберите «**Развилку «и» 2»**.

3. Нажмите кнопку «**Сценарий на выходе**» *‌*.
4. Откроется конструктор сценария, который будет выполняться после выхода токена из развилки.
5. Внутри действия «**Сменить контекст**» нажмите кнопку «**Добавить действие**» *‌* и выберите пункт «**Изменить значения атрибутов**».

   ![Кнопка «Добавить действие» в сценарии](/platform/v5.0/tutorials/tutorial_hr/img/lesson_5_scenario_add.png)

   Кнопка «Добавить действие» в сценарии
6. Внутри действия «**Сменить контекст**» будет создано действие «**Изменить значения атрибутов**».
7. В заголовке действия «**Изменить значения атрибутов**» нажмите кнопку «**Изменить**» *‌*.

   ![Кнопка «Изменить» действия «Изменить значения атрибутов»](/platform/v5.0/tutorials/tutorial_hr/img/lesson_5_change_scenario.png)

   Кнопка «Изменить» действия «Изменить значения атрибутов»
8. Отобразится окно «**Действие: Изменить значения атрибутов**» для настройки действия.
9. Нажмите кнопку «**Создать**», чтобы добавить операцию с атрибутом.
10. В столбце «**Атрибут**» выберите атрибут *«Результат собеседования»*.
11. В столбце «**Операция со значениями**» выберите пункт «**Заменить**».
12. В столбце «**Значение**» выберите пункт «**Формула**».
13. Нажмите поле в столбце «**Значение**». Отобразится компактный редактор выражения.
14. Введите **формулу**:

    ```
    AND($Проверкаслужбыбезопасности,GREATEREQ($Оценказасобеседование,8))
    ```

    Синтаксис формулы для вычисления результата собеседования

    - `AND()` — эта функция принимает в качестве аргументов два выражения, возвращающих логическое значение, и возвращает логическое значение `true`, если оба аргумента вернули `true`.
    - `GREATEREQ()` — эта функция сравнивает значения двух аргументов и возвращает логическое значение `true`, если значение первого аргумента больше или равно значению второго.
    - `$Проверкаслужбыбезопасности`, `$Оценказасобеседование` — обращение к атрибутам атрибуту *«Проверка службы безопасности»* и *«Оценка за собеседование»* по их системным именам.
15. Нажмите кнопку «**Сохранить**».

_![Настройка действия «Изменить значения атрибутов»](/platform/v5.0/tutorials/tutorial_hr/img/lesson_5_scenario_change_attributes_setting.png)_

## Проверка и публикация диаграммы процесса

Поверим и опубликуем обновлённую диаграмму процесса.

1. Проверьте корректность настроек сценариев, условий и форм.
2. Нажмите кнопку «**Проверить**» в конструкторе диаграммы и устраните любые ошибки.
3. Опубликуйте обновлённую диаграмму процесса.

## Тестирование обновлённого процесса

Протестируем обновлённый процесс, чтобы убедиться, что автоматизация и бизнес-логика работают корректно.

1. Создайте запись кандидата.
2. Пройдите этапы процесса, включая задачу *«Зафиксировать результаты тестирования»*.
3. Убедитесь, что поле результата тестирования отображается как переключатель с вариантами *«Тестирование пройдено / не пройдено»*, и что выбор обязателен.
4. Перейдите к задаче *«Провести собеседование»*. Заполните дату, время и оценку за собеседование. Проверьте, что поле оценки ограничено значением 10 и отображается как переключатель.
5. Перейдите к задаче *«Провести проверку кандидата»*. Убедитесь, что результат проверки фиксируется с помощью переключателя *«Проверка пройдена / не пройдена»* и что выбор обязателен.
6. Проверьте, что при выполнении условий (Оценка за собеседование `≥ 8` и проверка пройдена) процесс автоматически переходит на этап формирования предложения кандидату.
7. Проверьте альтернативный сценарий: если хотя бы одно из условий не выполнено, процесс завершается с соответствующим статусом.
8. Проверьте, что значения вычисляемых атрибутов корректно отображаются на формах.
9. При необходимости повторите тестирование с разными вариантами значений для проверки всех веток бизнес-логики.
10. Зафиксируйте результаты тестирования и при необходимости внесите корректировки в настройки процесса.

Факультативное задание

Попробуйте изменить условие автоматического перехода на этап предложения: например, требуйте не только прохождение проверки и высокую оценку, но и чтобы дата собеседования была не ранее определённой даты. Настройте формулу, проверьте работу процесса и проанализируйте, как изменится логика процесса.

## Итоги урока

Вы научились использовать автоматические вычисления, настраивать доступ к полям на форме, сценарии и условные переходы в процессе.

В [следующем уроке][tutorial_hr_lesson_6] вы научитесь настраивать систему управления доступом для участников процесса найма персонала.

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
