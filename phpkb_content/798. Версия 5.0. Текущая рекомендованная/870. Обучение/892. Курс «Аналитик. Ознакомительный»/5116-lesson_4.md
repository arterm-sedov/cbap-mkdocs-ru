---
title: Урок 4. Связи и коллекции записей, документооборот
kbId: 5116
---

# Урок 4. Связи и коллекции записей, документооборот

## Введение

В ходе этого урока вы научитесь расширять модель данных для процесса найма персонала: создавать связь «один ко многим» между шаблонами, использовать атрибут типа «**Документ**», настраивать представление таблицы для связанных записей и добавлять записи «на лету».

**Предусловия:** пройден *[урок 3 «Мой первый бизнес-процесс»][tutorial_hr_lesson_3]*.

**Расчётная продолжительность:** 55 мин.

Бизнес-логика

В рамках процесса найма персонала для каждого кандидата необходимо хранить и обрабатывать связанные документы (например, резюме, паспорт, тестовое задание).

Для этого расширим модель данных с использованием связей между шаблонами записей: кандидат может предоставить несколько документов, и каждый документ имеет определённый тип.

*HR-менеджер* должен иметь возможность:

- добавлять и просматривать документы, связанные с кандидатом;
- указывать тип документа из справочника;
- создавать новые типы документов и вакансии в текущей форме, то есть не покидая карточку кандидата.

Такая организация данных обеспечит прозрачность документооборота, ускорит работу с кандидатами и позволит гибко настраивать бизнес-процесс под реальные потребности компании.

Примечание

В данном уроке представлен продукт **{{ productName }}** версии 5.0, внешний вид страниц и меню в других версиях продукта может отличаться.

## Темы, навыки и задания урока

**Темы**

- Связи «один ко многим» (коллекции записей)
- Использование справочников для классификации данных
- Обработка файлов
- Атрибут типа «**Документ**»
- Создание записей «на лету»
- Настройка табличного представления для связанных записей
- Настройка областей кнопок
- Настройка требования обязательного ввода данных
- Организация документооборота

**Навыки**

- Устанавливать связи между шаблонами
- Настраивать обработку файлов
- Создавать и использовать атрибуты типа «**Документ**»
- Добавлять записи в связанные шаблоны «на лету»
- Настраивать контроль ввода данных пользователем
- Настраивать области кнопок

**Задания**

- Организовать хранение и обработку документов кандидатов в рамках процесса найма.
- Настроить связи между данными для обеспечения документооборота.
- Настроить таблицу на форме с записями из связанного шаблона.
- Реализовать возможность добавления и просмотра связанных документов непосредственно с формы кандидата.
- Обеспечить гибкость бизнес-процесса за счёт создания новых типов документов и вакансий «на лету».
- Настроить формы и представления для эффективной работы HR-менеджера с документами и кандидатами.

## Определения

- **Атрибут типа «Документ»** — поле для хранения файлов (резюме, результаты тестирования и др.).
- **Атрибут типа «Запись»** — поле для связи с другим шаблоном записи (например, Документы кандидата).
- **Связь «один ко многим»** — один объект (кандидат) связан с несколькими объектами (документами).
- **Взаимная связь** — двусторонняя связь между шаблонами записей.
- **Создание записей «на лету»** — добавление новых связанных записей прямо из формы.

## Настройка справочика типов документов

Чтобы *HR-менеджер* мог указать тип документов в записи кандидата, добавим справочник типов документов.

Для этого создадим **шаблон записи** *«Типы документов»*, настроим форму типа документа, список типов документов и заполним справочник данными.

### Создание шаблона записи «Типы документов»

1. Перейдите в раздел «**Шаблоны**» приложения *«Управление персоналом»*.
2. Создайте **шаблон записи** *«Типы документов»*.
3. Откройте шаблон и перейдите на вкладку «**Атрибуты**».
4. Создайте текстовый атрибут *«Тип документа»*.
5. В свойствах атрибута установите флажок «**Использовать как заголовок записей**».
6. Поместите атрибут *«Тип документа»* на форму *«Типы документов — Основная форма»*.
7. Сохраните форму.

_![Макет формы шаблона записи «Типы документов»](/platform/v5.0/tutorial_hr/img/lesson_4_document_type_form.png)_

### Заполнение справочника «Типы документов»

Чтобы указывать типы документов кандидатов в процессе найма, заполним справочник типов документов.

1. Откройте список записей шаблона *«Типы документов»*.
2. В списке нажмите кнопку «**Создать**».
3. Отобразится форма для заполнения типа документа.
4. В поле *«Тип документа»* укажите значение *«Резюме»*.
5. Сохраните запись.
6. Нажмите ссылку *«Типы документов»* над формой, чтобы вернуться к списку записей.
7. Аналогичным образом создайте ещё два типа документов — *«Паспорт»* и *«Тестовое задание»*.

## Создание шаблона записи «Документы кандидатов»

Для хранения документов кандидатов создадим отдельный реестр и свяжем его со справочником *«Типы документов»*.

1. Перейдите в раздел «**Шаблоны**» приложения *«Управление персоналом»*.
2. Создайте **шаблон записи** *«Документы кандидатов»*.
3. Откройте шаблон и перейдите на вкладку «**Атрибуты**».
4. Создайте атрибут типа «**Документ**» с названием *«Файл»*.
5. Создайте **текстовый** атрибут со следующими свойствами:

   - **Название:** *«Наименование»*
   - **Использовать как заголовок записей:** флажок установлен
6. Создайте атрибут типа «**Запись**» со следующими свойствами:

   - **Название:** *Тип*
   - **Связанный шаблон:** *Типы документов*

## Создание атрибута, связывающего два шаблона записей

!!! "Бизнес-логика"

```
Чтобы _HR-менеджер_ мог добавлять документы и сразу привязывать их к определённому кандидату, свяжем соответствующие шаблоны между собой.

```

Атрибут типа «Запись»

- Атрибут типа «**Запись**» используется для создания связи между шаблонами вида «один ко многим» (1:M), «один к одному» (1:1) или «многие ко многим» (N:M).
- При установлении связи «один ко многим» несколько записей одного шаблона могут ссылаться на одну запись другого шаблона.
- Такой шаблон называется **связанным**.
- **Связанный шаблон** всегда указывается при создании атрибута типа «**Запись**».

1. Откройте шаблон записи *«Кандидаты»*.
2. Перейдите на вкладку **Атрибуты**.
3. Создайте атрибут типа «**Запись**» со следующими свойствами:

   - **Название:** *«Документы»*
   - **Связанный шаблон:** *«Документы кандидатов»*
   - **Хранить несколько значений:** флажок установлен

   ![Свойства атрибута «Документы»](/platform/v5.0/tutorial_hr/img/lesson_4_attribute_multiple.png)

   Свойства атрибута «Документы»

## Настройка таблицы на форме для отображения документов кандидата

Настроим отображение связанных с кандидатом документов в таблице на форме.

Таблица на форме

На форме атрибут типа «**Запись**» с несколькими значениями может отображаться в виде таблицы, в столбцах которой отображаются атрибуты **связанного шаблона**.

Для таблицы на форме можно настроить набор столбцов, режим доступа, отображение дочерних записей, фильтр записей и кнопки.

1. Перейдите на вкладку «**Формы**» шаблона записи *«Кандидаты»*.
2. Откройте форму *«Кандидаты — Основная форма»*.
3. Перетащите атрибут *«Документы»* на основную форму кандидата.
4. Для поля *«Документы»* выберите **представление** «**Таблица**» с помощью панели свойств.
5. Раскройте атрибут *«Документы»* на панели элементов.
6. Перетащите в таблицу на форме атрибуты *«Наименование»*, *«Тип»* и *«Файл»*.
7. Атрибуты будут добавлены в качестве столбцов таблицы.

   ![Настройка атрибута «Документы» на форме](/platform/v5.0/tutorial_hr/img/lesson_4_form_table.png)

   Настройка атрибута «Документы» на форме
8. Выберите область кнопок таблицы.
9. В панели элементов отобразятся кнопки, доступные для таблицы.
10. Перетащите на область кнопок таблицы кнопки «**Создать**», «**Сохранить**» и «**Удалить**». Эти кнопки позволят добавлять и удалять документы, связанные с кандидатом.
11. Сохраните форму.

_![Настройка области кнопок атрибута «Документы» на форме](/platform/v5.0/tutorial_hr/img/lesson_4_form_button_area.png)_

## Настройка добавления вакансий на форме кандидата

Добавим возможность создания новых вакансий «на лету».

1. Перейдите на вкладку «**Формы**» шаблона записи *«Кандидаты»*.
2. Откройте форму *«Кандидаты — Основная форма»*.
3. Выберите поле атрибута *«Вакансия»*.
4. С помощью панели свойств поля установите флажок «**Создание записей**».

   Примечание

   Установив флажок «**Создание записей**» в свойствах раскрывающегося списка, мы даём пользователю возможность создавать записи с помощью формы связанного шаблона.
5. В свойстве «**Форма**» выберите *«Вакансии — Основная форма»*.
6. Сохраните форму.

_![Настройка атрибута «Вакансия» на форме](/platform/v5.0/tutorial_hr/img/lesson_4_form_create_new_record.png)_

## Тестирование

Перед тестированием усовершенствованного приложения, убедитесь, что все необходимые атрибуты и связи между шаблонами настроены согласно инструкциям в уроке.

Теперь проверим, как работает добавление и отображение связанных документов кандидата, а также создание новых вакансий непосредственно с формы кандидата.

1. Откройте шаблон записи *«Кандидаты»*.
2. Нажмите кнопку «**Перейти к экземплярам**».
3. Откройте запись или создайте новую.
4. Нажмите кнопку «**Создать**» в области рядом с таблицей *«Документы»*.
5. Введите наглядное название документа в ячейку *«Наименование»*.
6. Выберите тип документа.
7. Прикрепите файл в ячейке *«Файл»*.
8. Нажмите кнопку «**Сохранить**».
9. Разверните список поля *«Вакансия»*.
10. Нажмите кнопку «**Создать**».
11. Введите название вакансии и нажмите кнопку «**ОК**».
12. Сохраните запись.

Факультативное задание

Попробуйте расширить модель документооборота: добавьте новый тип документа (например, "Медицинская справка") и настройте для него отдельные правила отображения или обязательности на форме кандидата.

Поэкспериментируйте с настройкой фильтров или сортировки в таблице документов кандидата — например, чтобы сначала отображались наиболее важные или недавно добавленные документы.

## Итоги урока

В ходе этого урока вы научились устанавливать между шаблонами записей связи типа «один ко многим», создавать справочники, использовать атрибут типа «**Документ**», настраивать таблицы на форме для со связанными записями, настраивать области кнопок таблиц, добавлять записи «на лету» и настраивать формы задач для бизнес-процесса найма персонала.

В [следующем уроке][tutorial_hr_lesson_5] вы познакомитесь с вычисляемыми атрибутами, и автоматизацией расчётов в системе, условным управлением потоками процесса и контролем ввода данных.

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
