<h1>Копирование объекта</h1><p>Для того чтобы скопировать запись, создайте в текущем шаблоне записи кнопку с операцией C#-скрипт и введите следующее выражение:</p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code"> 
<p>using System;  <br/>using System.Collections.Generic; <br/>using System.Linq; <br/>using Comindware.Data.Entity; <br/>using Comindware.TeamNetwork.Api.Data.UserCommands; <br/>using Comindware.TeamNetwork.Api.Data;</p>
<p>class Script <br/>{ <br/>    public static UserCommandResult Main(UserCommandContext userCommandContext, Comindware.Entities entities) <br/>    {  <br/> foreach (var objectId in userCommandContext.ObjectIds) <br/>        {</p>
<p>            Api.TeamNetwork.ObjectService.Clone(objectId,null, true); <br/>        } <br/>var result = new UserCommandResult <br/>        { <br/>            Success = true, <br/>            Commited = true, <br/>            ResultType = UserCommandResultType.DataChange, <br/>            Messages = new[] <br/>            { <br/>                new UserCommandMessage <br/>                { <br/>                    Severity = SeverityLevel.Normal, <br/>                    Text = "Запись скопирована" <br/>                } <br/>            } <br/>        };</p>
<p>        return result; <br/>    } <br/>}</p>
</td>
</tr>
</tbody>
</table>
</div>