---
title: Литералы и функции в формулах. Справочник, описания, примеры
kbId: 4993
---

# Литералы и функции в формулах. Справочник, описания, примеры

## Введение

Здесь представлены синтаксис и примеры использования функций в формулах **Comindware**.

## Функции для объявления литералов

| `BOOL()` | |
| --- | --- |
| **Описание** | Преобразует строку в логическое значение `True` или `False`. |
| **Синтаксис** | ``` BOOL(string)   ``` |
| **Аргументы** | `string` — строка `True` или `False` (без учёта регистра).  При некорректном значении аргумента (`0`, `1`, `истина`, `ложь` и т. п.) функция возвращает пустое значение. |
| **Результат** | Логическое значение |
| **Пример** | ``` BOOL('TRUE')   ```  Результат: `True` |

| `CREATEDATE()` | |
| --- | --- |
| **Описание** | Преобразует числовые аргументы (год, месяц, день, часы, минуты, секунды) в значение типа «**Дата и время**». |
| **Синтаксис** | ``` CREATEDATE(year, month, day)   ```  **или**  ``` CREATEDATE(year, month, day, hour, minute, second)   ``` |
| **Аргументы** | `year, month, day, hour, minute, second`: числа. |
| **Результат** | Дата и время |
| **Пример** | ``` CREATEDATE(2025, 5, 5, 15, 45, 15)   ```  Результат: `05.05.2025 15:45:15` |

| `CREATEDATEUTC()` | |
| --- | --- |
| **Описание** | Преобразует числовые аргументы (год, месяц, день, часы, минуты, секунды) в значение типа «**Дата и время**» в часовом поясе `UTC+00:00`. |
| **Синтаксис** | ``` CREATEDATEUTC(year, month, day)   ```  **или**  ``` CREATEDATEUTC(year, month, day, hour, minute, second)   ``` |
| **Аргументы** | `year, month, day, hour, minute, second`: числа. |
| **Результат** | Дата и время |
| **Пример** | ``` CREATEDATEUTC(2025, 5, 5, 15, 45, 15)   ```  Результат: `05.05.2025 15:45:15` |

| `DATE()` | |
| --- | --- |
| **Описание** | Преобразует в строку в формате ISO 8601 в значение даты и времени.  Функция возвращает значение в часовом поясе, заданном на сервере **{{ productName }}**.  См. также *«[Форматирование значений в шаблонах экспорта и формулах][export_template_file_formula_format_values]»*. |
| **Синтаксис** | ``` DATE(string)   ``` |
| **Аргументы** | - `string`: строка в формате `YYYY-MM-DDThh:mm:ss±hh:mm`   - `YYYY-MM-DD` — год, месяц, число;   - `T` — разделитель даты и времени;   - `hh:mm:ss` — часы, минуты, секунды;   - `±hh:mm` — часовой пояс. |
| **Результат** | Дата и время |
| **Примеры** | - `DATE("2025-08-15")` — 15 августа 2025 г. - `DATE("13:45:15")` — 13 часов 45 минут 15 секунд текущего дня. - `DATE("2025-08-15T13:45:15")` — 13 часов 45 минут 15 секунд 15 августа 2025 г. в часовом поясе, заданном на сервере. - `DATE("2025-08-15T13:45:15+08:00")` — 08 часов 45 минут 15 секунд 15 августа 2025 г., если на сервере задан часовой пояс `UTC+03` (`13-8+3=8`). |

| `DECIMAL()` | |
| --- | --- |
| **Описание** | Преобразует строку в десятичное число. |
| **Синтаксис** | ``` DECIMAL(string)   ``` |
| **Аргументы** | `string` — строка с числовым значением.  Значение интерпретируется в соответствии с языком текущего аккаунта текущего пользователя, например:   - `10000`, `10,5` для русского языка; - `10000`, `10.5` для английского языка.   При неподходящих значениях аргумента (`1 р.`, `$50`, `10 000` и т. п.) функция возвращает пустое значение. |
| **Результат** | Число |
| **Пример** | ``` IF (USER()->language=='ru',      DECIMAL(REPLACE("10000.5", ".", ",")),      DECIMAL(REPLACE("10000,5", ",", ".")))   ```  Результат: `10000,5` для пользователей с любым языком аккаунта. |

| `DURATION()` | |
| --- | --- |
| **Описание** | Преобразует строку в формате ISO 8601 в значение длительности.  См. также *«[Форматирование значений в шаблонах экспорта и формулах][export_template_file_formula_format_values]»*. |
| **Синтаксис** | ``` DURATION(string)   ``` |
| **Аргументы** | - `string`: строка в формате `P<n>Y<n>M<n>DT<n>H<n>M<n>S`   - `<n>` — число;   - `P` — префикс периода, обязательный;   - `Y` — годы;   - `M` — месяцы;   - `W` — недели;   - `D` — дни;   - `T` — префикс времени, используется только для указания времени;   - `H` — часы;   - `M` — минуты;   - `S` — секунды. |
| **Результат** | Длительность |
| **Примеры** | - `DURATION("P3Y6M4DT12H30M5S")` — 3 года 6 месяцев 4 дня 12 часов 30 минут 5 секунд. - `DURATION("PT3H15M")` — 3 часа 15 минут. - `DURATION("P3D")` — 3 дня. |

| `ID()` | |
| --- | --- |
| **Описание** | Преобразует строку в идентификатор объекта. |
| **Синтаксис** | ``` ID(string)   ``` |
| **Аргументы** | - `string`: строка с идентификатором объекта. |
| **Результат** | Идентификатор объекта |
| **Примеры** | - `ID("136")` — идентификатор записи `136`. - `ID("account.2")` — идентификатор аккаунта `account.2`. |

## Математические функции

| `ADD()` | |
| --- | --- |
| **Описание** | Суммирует два значения типа «**Число**», «**Дата и время**» или «**Длительность**». |
| **Синтаксис** | ``` ADD(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`: число, `argument2`: число. - `argument1`: длительность, `argument2`: длительность. - `argument1`: дата и время, `argument2`: длительность. |
| **Результат** | - Число - Длительность - Дата и время |
| **Пример** | ``` ADD(DATE('2024-01-01T01:01:01'), DURATION('P3Y6M4DT12H30M5S'))   ```  Результат: `03.07.2027 13:31:06` |

| `CEILING()` | |
| --- | --- |
| **Описание** | Округляет аргумент до ближайшего бо́льшего целого. |
| **Синтаксис** | ``` CEILING(number)   ``` |
| **Аргументы** | `number` — число, которое требуется округлить. |
| **Результат** | Число |
| **Пример** | ``` CEILING(4.1)   ```  Результат: `5` |

| `DIVIDE()` | |
| --- | --- |
| **Описание** | Возвращает результат деления двух числовых аргументов. |
| **Синтаксис** | ``` DIVIDE(dividend, divisor)   ``` |
| **Аргументы** | - `dividend`: число, делимое - `divisor`: число, делитель |
| **Результат** | Число |
| **Пример** | ``` DIVIDE (125, 25)   ```  Результат: `5` |

| `FLOOR()` | |
| --- | --- |
| **Описание** | Округляет число до ближайшего меньшего целого. |
| **Синтаксис** | ``` FLOOR(number)   ``` |
| **Аргументы** | `number`: число. |
| **Результат** | Число |
| **Пример** | ``` FLOOR(5.9)   ```  Результат: `5` |

| `POW()` | |
| --- | --- |
| **Описание** | Возводит первый аргумент в степень, указанную во втором аргументе, и возвращает результат. |
| **Синтаксис** | ``` POW(base, degree)   ``` |
| **Аргументы** | - `base`: число. - `degree`: число. |
| **Результат** | Число |
| **Пример** | ``` POW(2, 8)   ```  Результат: `256` |

| `PRODUCT()` | |
| --- | --- |
| **Описание** | Перемножает два числовых аргумента. |
| **Синтаксис** | ``` PRODUCT(number1, number2)   ``` |
| **Аргументы** | - `number1`: число. - `number2`: число. |
| **Результат** | Число |
| **Пример** | ``` PRODUCT(3, 4)   ```  Результат: `12` |

| `QUOTIENT()` | |
| --- | --- |
| **Описание** | Возвращает целую часть результата деления первого аргумента на второй. |
| **Синтаксис** | ``` QUOTIENT(dividend, divisor)   ``` |
| **Аргументы** | - `dividend`: число, делимое. - `divisor`: число, делитель. |
| **Результат** | Число |
| **Пример** | ``` QUOTIENT(5, 2)   ```  Результат: `2` |

| `REMAINDER()` | |
| --- | --- |
| **Описание** | Возвращает остаток от деления первого аргумента на второй. |
| **Синтаксис** | ``` REMAINDER(dividend, divisor)   ``` |
| **Аргументы** | `dividend`: число, делимое. `divisor`: число, делитель. |
| **Результат** | Число |
| **Пример** | ``` REMAINDER(5, 2)   ```  Результат: `1` |

| `ROUND()` | |
| --- | --- |
| **Описание** | Округляет число до ближайшего целого. |
| **Синтаксис** | ``` ROUND(number)   ``` |
| **Аргументы** | `number`: число. |
| **Результат** | Число |
| **Пример** | ``` ROUND(3.5)   ```  Результат: `4`  ``` ROUND(3.4)   ```  Результат: `3` |

| `SQRT()` | |
| --- | --- |
| **Описание** | Вычисляет квадратный корень аргумента. |
| **Синтаксис** | ``` SQRT(number)   ``` |
| **Аргументы** | `number`: число. |
| **Результат** | Число |
| **Пример** | ``` SQRT(25)   ```  Результат: `5` |

| `SUBTRACT()` | |
| --- | --- |
| **Описание** | Вычисляет разность двух аргументов типа «**Число**», «**Длительность**» или «**Дата и время**». |
| **Синтаксис** | ``` SUBTRACT(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`: число; `argument2`: число. - `argument1`: длительность; `argument2`: длительность. - `argument1`: дата и время; `argument2`: длительность. - `argument1`: дата и время; `argument2`: дата и время. |
| **Результат** | Число, длительность или дата и время. |
| **Пример** | ``` SUBTRACT(17, 10)   ```  Результат: `7` |

## Функции для сравнения

| `EQUALS()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента и возвращает `True`, если они равны, в противном случае возвращает `False`. |
| **Синтаксис** | ``` EQUALS(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: логическия значения, дата и время, длительность, числа, или строки. |
| **Результат** | Логическое значение |
| **Пример** | ``` EQUALS("string", 2)   ```  Результат: `False` |

| `GREATER()` | |
| --- | --- |
| **Описание** | Возвращает логическое значение `True`, если первый аргумент больше второго, в противном случае возвращает `False`. |
| **Синтаксис** | ``` GREATER(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: числа, строки, длительность или дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` GREATER(1, 0)   ```  Результат: `True` |

| `GREATEREQ()` | |
| --- | --- |
| **Описание** | Возвращает логическое значение `True`, если первый аргумент больше или равен второму, в противном случае возвращает `False`. |
| **Синтаксис** | ``` GREATEREQ(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: числа, строки, длительность или дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` GREATEREQ("Строка", "Сорока")   ```  Результат: `True` |

| `LESS()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента, возвращает логическое значение `True`, если первый аргумент меньше второго, в противном случае возвращает `False`.  Строки сравниваются лексикографически — по алфавиту. |
| **Синтаксис** | ``` LESS(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: число, строка, длительность или дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` LESS(0.1, 1)   ```  Результат: `True`  ``` LESS("0,1", "0.1")   ```  Результат: `True` |

| `LESSEQ()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента, возвращает логическое значение `True`, если первый аргумент меньше или равено второму, в противном случае возвращает `False`.  Строки сравниваются лексикографически — по алфавиту. |
| **Синтаксис** | ``` LESSEQ(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: число, строка, длительность или дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` LESSEQ(1.0, 1)   ```  Результат: `True`  ``` LESSEQ("1.0", "1")   ```  Результат: `False` |

| `NOTEQUALS()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента одинакового типа и возвращает логическое значение `True`, если первый аргумент не равен второму, в противном случае возвращает `False`. |
| **Синтаксис** | ``` NOTEQUALS(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: строка, логическое значение, дата и время, число или длительность. |
| **Результат** | Логическое значение |
| **Пример** | ``` NOTEQUALS("Строка", "Сорока")   ```  Результат: `True` |

## Логические функции

| `ALL()` | |
| --- | --- |
| **Описание** | Принимает список логических значений и возвращает `True`, если все они имеют значение `True`. |
| **Синтаксис** | ``` ALL(listBool)   ``` |
| **Аргументы** | `listBool`: список логических значений или выражений, возвращающих логические значения. |
| **Результат** | Логическое значение |
| **Пример** | ``` ALL(LIST(BOOL("True"), BOOL("True"), BOOL("False")))   ```  Результат: `False` |

| `AND()` | |
| --- | --- |
| **Описание** | Принимает два логических аргумента и возвращает результат их логического умножения (конъюнкции). |
| **Синтаксис** | ``` AND(bool1, bool2)   ``` |
| **Аргументы** | `bool1`, `bool2`: логические значения или выражения, возвращающие логическое значение. |
| **Результат** | Логическое значение |
| **Пример** | ``` AND(BOOL("True"), BOOL("True"))   ```  Результат: `True` |

| `ANY()` | |
| --- | --- |
| **Описание** | Проверка на непустую последовательность.  Проверяет список или набор данных на наличие значений. Возвращает `True`, если аргумент содержит хотя бы одно значение. |
| **Синтаксис** | ``` ANY(dataset)   ``` |
| **Аргументы** | `dataset`: список значений или набор данных (например сформированный с помощью запроса вида `from ... where ... select`). |
| **Результат** | Логическое значение |
| **Пример** | ``` ANY(from in db->Tickets where i->product == "Data Monsoon" select i->name)   ```  Результат: `True`, если запрос вернёт хотя бы один элемент. |

| `ANY()` | |
| --- | --- |
| **Описание** | Проверка предиката.  Формирует набор данных и возвращает `True`, если в наборе данных есть хотя бы один элемент с истинным значением заданного предиката. |
| **Синтаксис** | ``` ANY([(query), queryVar, boolEval])   ``` |
| **Аргументы** | - `query`: запрос, возвращающий набор данных, вида `from ... where ... select`. - `queryVar`: локальная переменная, используемая в запросе. - `boolEval`: выражение с элементом набора данных, возвращающее логическое значение. |
| **Результат** | Логическое значение |
| **Пример** | ``` ANY([      (from i in db->Tickets where i->product=='Data Monsoon' select i),      i,      i->NeedsQAHelp      ])   ```  Результат: `True`, если запрос вернёт хотя бы одну запись, в которой значение атрибута `NeedsQAHelp` равно `True`. |

| `IF()` | |
| --- | --- |
| **Описание** | Выполняет тренарную операцию.  Принимает три аргумента. Если первый аргумент равен `True`, возвращает второй аргумент в противном случае возвращает третий аргумент. |
| **Синтаксис** | ``` IF(condition, resultTrue, resultFalse)   ``` |
| **Аргументы** | - `condition`: логическое значение или выражение, возвращающее логическое значение. - `resultTrue`: значение любого типа, возвращаемое, когда `condition` равно `True`. - `resultFalse`: значение любого типа, возвращаемое, когда `condition` не равно `True`. |
| **Результат** | Тип возвращаемого значения совпадает с типом аргамента `resultTrue` или `resultFalse`. |
| **Пример** | ``` IF(1==2, "Верно", "Не верно")   ```  Результат: `Не верно` |

| `NOT()` | |
| --- | --- |
| **Описание** | Принимает логический аргумент и выполняет над ним операцию отрицания: возвращает логическое значение `True`, если аргумент имеет значение `False` и наоборот. |
| **Синтаксис** | ``` NOT(boolean)   ``` |
| **Аргументы** | `boolean`: логическое значение. |
| **Результат** | Логическое значение |
| **Пример** | ``` NOT(EMPTY(NOW()))   ```  Результат: `True` |

| `OR()` | |
| --- | --- |
| **Описание** | Принимает два логических аргумента и возвращает результат их логического сложения (дизъюнкции). |
| **Синтаксис** | ``` OR(boolean1, boolean2)   ``` |
| **Аргументы** | `boolean1`, `boolean2`: логическоие значения. |
| **Результат** | Логическое значение |
| **Пример** | ``` OR(BOOL("True"), BOOL("False"))   ```  Результат: `True` |

## Агрегатные функции

| `ASCENDING()` | |
| --- | --- |
| **Описание** | Сортирует элементы списка в порядке возрастания. |
| **Синтаксис** | ``` ASCENDING(list)   ``` |
| **Аргументы** | `list`: список чисел или строк |
| **Результат** | Список |
| **Пример** | ``` ASCENDING('в', 'а', 'б')   ```  Результат: `а`, `б`, `в` |

| `AVERAGE()` | |
| --- | --- |
| **Описание** | Возвращает среднее арифметическое значение аргументов. |
| **Синтаксис** | ``` AVERAGE(argument1, ... argumentN)   ``` |
| **Аргументы** | `argument1`, `argumentN`: числа |
| **Результат** | Число |
| **Пример** | ``` AVERAGE(1, 3, 4, 7, 10)   ```  Результат: `5` |

| `COUNT()` | |
| --- | --- |
| **Описание** | Возвращает количество элементов в списке. |
| **Синтаксис** | ``` COUNT(list)   ``` |
| **Аргументы** | `list`: список элементов |
| **Результат** | Число |
| **Пример** | ``` COUNT(LIST("a", 2, "c", "d", 5))   ```  Результат: `5` |

| `DESCENDING()` | |
| --- | --- |
| **Описание** | Сортирует элементы списка в порядке возрастания. |
| **Синтаксис** | ``` DESCENDING(list)   ``` |
| **Аргументы** | `list`: список чисел или строк |
| **Результат** | Отсортированный список значений |
| **Пример** | ``` DESCENDING('а', 'б', 'в')   ```  Результат: `в`, `б`, `а` |

| `DISTINCT()` | |
| --- | --- |
| **Описание** | Удаляет дубликаты элементов из списка. |
| **Синтаксис** | ``` DISTINCT(list)   ``` |
| **Аргументы** | `list`: список чисел или строк |
| **Результат** | Список уникальных значений |
| **Пример** | ``` DISTINCT(LIST('а', 'а', 'в', 'б', 'Б', 'в'))   ```  Результат: `а`, `б`, `Б`, `в` |

| `FIRST()` | |
| --- | --- |
| **Описание** | Возвращает первый элемент списка. При отсутствии элементов возвращает пустое значение. |
| **Синтаксис** | ``` FIRST(list)   ``` |
| **Аргументы** | `list`: список значений. |
| **Результат** | Тип возвращаемого значения совпадает с типом элементов списка. |
| **Пример** | ``` FIRST((from i in db->music where i->album == 'Whale Meditation' select i->song))   ```  Результат: название первой песни из альбома `Whale Meditation`. |

| `LAST()` | |
| --- | --- |
| **Описание** | Возвращает последний элемент списка. При отсутствии элементов возвращает пустое значение. |
| **Синтаксис** | ``` LAST(list)   ``` |
| **Аргументы** | `list`: список значений. |
| **Результат** | Тип возвращаемого значения совпадает с типом элементов списка. |
| **Пример** | ``` LAST((from i in db->music where i->album == 'Whale Meditation' select i->song))   ```  Результат: название последней песни из альбома `Whale Meditation`. |

| `LIST()` | |
| --- | --- |
| **Описание** | Принимает любое количество аргументов любых типов, разделённых запятыми, и возвращает список. |
| **Синтаксис** | ``` LIST(argument1, …, argumentN)   ``` |
| **Аргументы** | `argument1`, …, `argumentN`: значения любых типов. |
| **Результат** | Cписок значений таких же типов, как аргументы |
| **Пример** | ``` LIST(1, 2, "a", "b")   ```  Результат: `[1, 2, "a", "b"]`. |

| `LISTEQUALS()` | |
| --- | --- |
| **Описание** | Сравнивает два списка значений. Если они совпадают, возвращает логическое значение `True`, в противном случае возвращает `False`. |
| **Синтаксис** | ``` LISTEQUALS(list1, list2)   ``` |
| **Аргументы** | `list1`, `list2`: списки значений. |
| **Результат** | Логическое значение |
| **Пример** | ``` LISTEQUALS(LIST(1, 2), LIST("1", "2"))   ```  Результат: `False` |

| `MAX()` | |
| --- | --- |
| **Описание** | Принимает список значений и возвращает максимальное из значений его элементов.  Все элементы списка должны быть одинакового типа: «**Число**», «**Дата и время**» или «**Длительность**». |
| **Синтаксис** | ``` MAX(list)   ``` |
| **Аргументы** | `list`: список значений типа «**Число**», «**Дата и время**» или «**Длительность**» |
| **Результат** | Тип возвращаемого значения совпадает с типом элементов списка |
| **Пример** | ``` MAX(DURATION('P2DT1H0M0S'), DURATION('P3DT1H0M0S'))   ```  Результат: `3.01:00:00` |

| `MIN()` | |
| --- | --- |
| **Описание** | Принимает список значений и возвращает минимальное из значений его элементов.  Все элементы списка должны быть одинакового типа: «**Число**», «**Дата и время**» или «**Длительность**». |
| **Синтаксис** | ``` MIN(list)   ``` |
| **Аргументы** | `list`: список значений типа «**Число**», «**Дата и время**» или «**Длительность**» |
| **Результат** | Тип возвращаемого значения совпадает с типом элементов списка |
| **Пример** | ``` MIN(DURATION('P2DT1H0M0S'), DURATION('P3DT1H0M0S'))   ```  Результат: `2.01:00:00` |

| `SUM()` | |
| --- | --- |
| **Описание** | Принимает любое количество аргументов типа «**Число**» или «**Длительность**», перечисленных через запятую, и возвращает их сумму. |
| **Синтаксис** | ``` SUM(argument1, ..., argumentN)   ``` |
| **Аргументы** | `argument1, ..., argumentN`: числа или длительность. |
| **Результат** | Тип возвращаемого значения совпадает с типом аргументов |
| **Пример** | ``` SUM(1, 2, 3, 4)   ```  Результат: `10` |

| `UNION()` | |
| --- | --- |
| **Описание** | Объединяет в один список два объекта или два списка объектов (ID записей или экземпляров процесса). |
| **Синтаксис** | ``` UNION(object1, object2)   ``` |
| **Аргументы** | `object1`, `object2`: объекты или списки объектов. |
| **Результат** | Список записей |
| **Пример** | ``` UNION(      from i in db->music where i->album == 'Whale Meditation' select i->id,       from i in db->music where i->album == 'Bird Song' select i->id)   ```  Результат: список ID песен из альбомов `Whale Meditation` и `Bird Song`. |

## Системные функции

| `EMPTY()` | |
| --- | --- |
| **Описание** | Проверяет, является ли пустым значение аргумента. Возвращает логическое значение `True`, если значение пустое, в противном случае возвращает `False`. |
| **Синтаксис** | ``` EMPTY(argument)   ``` |
| **Аргументы** | `argument`: атрибут или выражение. |
| **Результат** | Логическое значение |
| **Пример** | ``` EMPTY(DIVIDE(3, 3))   ```  Результат: `False` |

| `ENUMVALUE()` | |
| --- | --- |
| **Описание** | Принимает системное имя атрибута атрибута типа «**Список значений**» и системное имя его значения и вовзрращает ID этого значения. |
| **Синтаксис** | ``` ENUMVALUE("enumAttributeSystemName", "enumValueSystemName")   ``` |
| **Аргументы** | - `enumAttributeSystemName`: строка, системное имя атрибута типа «**Список значений**». - `enumValueSystemName`: строка, системное имя одного из значений атрибута типа «**Список значений**». |
| **Результат** | Строку с ID искомого значения атрибута. |
| **Пример** | ``` EQUALS($Status, ID(ENUMVALUE("Status", "Resolved")))   ```  Результат: `True`, если атрибут `Status` имеет значение `Resolved`. |

| `OBJECT()` | |
| --- | --- |
| **Описание** | Принимает четыре строковых аргумента: системные имена приложения, шаблона и атрибута, а также значение атрибута типа «**Текст**». Возвращает список ID записей из указанного шаблона, в которых указанный атрибут имеет заданное значение. |
| **Синтаксис** | ``` OBJECT("businessApp", "template", "attribute", "attributeValue")   ``` |
| **Аргументы** | - `businessApp`: строка, системное имя приложения. - `template`: строка, системное имя шаблона. - `attribute`: строка, системное имя атрибута. - `attributeValue`: строка, искомое значение атрибута. |
| **Результат** | Список |
| **Пример** | ``` OBJECT("Fleetmanagement", "Requests", "Status", "Завершено")   ```  Результат: список ID записей шаблона *«Заявки»* (системное имя — `Requests`) приложения *«Управление автопарком»* (системное имя — `Fleetmanagement`), у которых значение атрибута *«Статус»* (системное имя — `Status`) равно `Завершено`. |

| `USER()` | |
| --- | --- |
| **Описание** | Возвращает идентификатор аккаунта текущего пользователя. |
| **Синтаксис** | ``` USER()   ``` |
| **Аргументы** | Не требуются. |
| **Результат** | Идентификатор аккаунта |
| **Пример** | ``` USER()   ```  Результат: `account.XX` — ID аккаунта, который просматривает запись. |

| `VALUE()` | |
| --- | --- |
| **Описание** | Принимает два аргумента: проверяемое выражение и значение по умолчанию. Возвращает значение первого аргумента, если оно не пустое и не равно `NULL`, в противном случае возвращает значение второго аргумента, если он есть. |
| **Синтаксис** | ``` VALUE(argument, defaultValue)   ``` |
| **Аргументы** | - `argument`: проверяемое выражение, возвращающее значение любого типа. - `defaultValue`: значение по умолчанию любого типа (необязательный аргумент). |
| **Результат** | Тип возвращаемого значения совпадает с типом первого или второго аргумента. |
| **Пример** | ``` VALUE($Amount, "Не заполнено поле Amount")   ```  Результат: значение атрибута *Amount*, если оно не пустое. В противном случае — текст *«Не заполнено поле Amount»*. |

## Функции для обработки строк

| `CONCAT()` | |
| --- | --- |
| **Описание** | Объединяет строки из списка в одну строку. |
| **Синтаксис** | ``` CONCAT(list)   ``` |
| **Аргументы** | `list` — список строк, которые требуется объединить. |
| **Результат** | Строка |
| **Пример** | ``` CONCAT(LIST("Сумма доходов равна: ", "100000"))   ```  Результат: `Сумма доходов равна: 100000` |

| `CONTAINS()` | |
| --- | --- |
| **Описание** | Ищет подстроку в строке. Если первая строка содержит вторую, возвращает логическое значение `True`. |
| **Синтаксис** | ``` CONTAINS(string, substring)   ``` |
| **Аргументы** | - `string` — строка, в которой происходит поиск подстроки. - `substring` — подстрока, которую требуется найти. |
| **Результат** | Логическое значение |
| **Пример** | ``` CONTAINS("Это срочная заявка.", "срочн")   ```  Результат: `True` |

| `ENDSWITH()` | |
| --- | --- |
| **Описание** | Сравнивает две строки и возвращает значение `True`, если первая строка оканчивается на вторую, в противном случае возвращает `False`. |
| **Синтаксис** | ``` ENDSWITH(string, endString)   ``` |
| **Аргументы** | `string`, `endString`: строка. |
| **Результат** | Логическое значение |
| **Пример** | ``` ENDSWITH("Строка", "ка")   ```  Результат: `True` |

| `FIRSTCAPITAL()` | |
| --- | --- |
| **Описание** | Преобразует первую букву строки в прописную (заглавную). |
| **Синтаксис** | ``` FIRSTCAPITAL(string)   ``` |
| **Аргументы** | `string`: строка. |
| **Результат** | Строка. |
| **Пример** | ``` FIRSTCAPITAL("строка")   ```  Результат: `Строка` |

| `FORMAT()` | |
| --- | --- |
| **Описание** | Принимает строку с заполнителями вида `{0}`…`{N}` и список значений. Подставляет значения из списка в соответствующие заполнители, форматирует их по заданному шаблону и возвращает результирующую строку.  См. также *«[Форматирование значений в шаблонах экспорта и формулах][export_template_file_formula_format_values]»*. |
| **Синтаксис** | ``` FORMAT("stringToFormat {0} {1} ... {N}", LIST(argument0, argument1, ..., valueN))   ``` |
| **Аргументы** | - `"stringToFormat {0} {1} ... {N}"`: строка с заменителями. - `LIST(argument0, argument1, ..., argumentN)`: список значений любых типов. |
| **Результат** | Строка |
| **Пример** | ``` FORMAT(      "Название: {0}, исполнитель: {1}, дата релиза: {2:dd MMMM yyyy 'г.'}",      LIST("Yesterday","Beatles", DATE("1965-06-14"))      )   ```  Результат: `Название: Yesterday, исполнитель: Beatles, дата релиза: 14 июня 1965 г.` |

| `INDEXOF()` | |
| --- | --- |
| **Описание** | Ищет подстроку в строке. Возвращает номер позиции (по умолчанию поиск отсчёт идёт от `0`) искомой строки в исходной строке. Также можно указать номер начальной позиции для поиска. |
| **Синтаксис** | ``` INDEXOF(sourceString, stringToFind, startIndex)   ``` |
| **Аргументы** | - `sourceString`: исходная строка. - `stringToFind`: искомая строка. - `startIndex`: номер начальной позиции для поиска (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` INDEXOF("У ёлки иголки колки.", "лки", 4)   ```  Результат: `10`  ``` INDEXOF("У ёлки иголки колки.", "лки")   ```  Результат: `3` |

| `JOIN()` | |
| --- | --- |
| **Описание** | Объединяет строки с использованием заданного разделителя. |
| **Синтаксис** | ``` JOIN(separator, stringList)   ``` |
| **Аргументы** | `separator`: строка, разделитель объединяемых строк. `stringList`: список строк, которые требуется объединить. |
| **Результат** | Строка |
| **Пример** | ``` JOIN(", ", LIST("Аналитик", "Архитектор", "Администратор"))   ```  Результат: `Аналитик, Архитектор, Администратор` |

| `LENGTH()` | |
| --- | --- |
| **Описание** | Возвращает количество символов в строке. |
| **Синтаксис** | ``` LENGTH(string)   ``` |
| **Аргументы** | `string`: строка |
| **Результат** | Число |
| **Пример** | ``` LENGTH("В этой строке 26 символов.")   ```  Результат: `26` |

| `MATCHES()` | |
| --- | --- |
| **Описание** | Принимает строку и регулярное выражение. Возвращает логическое значение `True`, если часть строки или вся строка соответствует регулярному выражению. В противном случае возвращает `False`.  Для изучения и отладки регулярных выражений можно воспользоваться следующим инструментом: <https://regex101.com> |
| **Синтаксис** | ``` MATCHES(string, regex)   ``` |
| **Аргументы** | `string`: строка. `regex`: строка с регулярным выражением. |
| **Результат** | Логическое значение |
| **Пример** | ``` MATCHES("Требуется решить проблему срочно!", "[Cс]рочн.+?")   ```  Результат: `True` |

| `NORMALIZE()` | |
| --- | --- |
| **Описание** | Убирает лишние пробелы из строкового аргумента. |
| **Синтаксис** | ``` NORMALIZE(string)   ``` |
| **Аргументы** | `string`: строка. |
| **Результат** | Строка |
| **Пример** | ``` NORMALIZE("В этой   строке  были    лишние  пробелы, но теперь   их    нет.")   ```  Результат: `В этой строке были лишние пробелы, но теперь их нет.` |

| `NOTMATCHES()` | |
| --- | --- |
| **Описание** | Принимает строку и регулярное выражение. Возвращает логическое значение `True`, если часть строки или вся строка не соответствует регулярному выражению. В противном случае возвращает `False`.  Для изучения и отладки регулярных выражений можно воспользоваться следующим инструментом: <https://regex101.com> |
| **Синтаксис** | ``` NOTMATCHES(string, regex)   ``` |
| **Аргументы** | - `string`: строка. - `regex`: строка, задающая регулярное выражение. |
| **Результат** | Логическое значение |
| **Пример** | ``` NOTMATCHES("Требуется решить проблему срочно!", "[Cс]рочн.+?")   ```  Результат: `False` |

| `REGEXREPLACE()` | |
| --- | --- |
| Описание | Принимает три строковых аргумента: исходную строку, регулярное выражение, замещающую строку. Находит в исходной строке подстроки по регулярному выражению, заменяет найденные подстроки замещающей строкой и возвращает результирующую строку.  Для изучения и отладки регулярных выражений можно воспользоваться следующим инструментом: <https://regex101.com> |
| **Синтаксис** | ``` REGEXREPLACE(sourceString, regEx, replacementString)   ``` |
| **Аргументы** | - `sourceString`: исходная строка. - `regEx`: строка с регулярным выражением. - `replacementString`: замещающая строка. |
| **Результат** | Строка |
| **Пример** | ``` REGEXREPLACE("Фамилия Имя Отчество","(.+) (.+) (.+)","$2")   ```  Результат: `Имя`  ``` REGEXREPLACE("Рассмотрите заявку [#12345]",".*\\[#([0-9]+)\\].*","$1")   ```  Результат: `12345`  ``` REGEXREPLACE($HTML,"&lt;p class=""title"">(.+)&lt;\\/p>","&lt;h1>$1&lt;h1>")   ```  Результат: заменяет в HTML-коде параграфы класса `title` на заголовки уровня 1. |

| `REPLACE()` | |
| --- | --- |
| **Описание** | Принимает три строки: исходную, искомую и замещающую. Заменяет все вхождения искомой строки в исходной строке на замещающую строку. |
| **Синтаксис** | ``` REPLACE(string, subString, replacementString)   ``` |
| **Аргументы** | `string`, `subString`, `replacementString`: строки |
| **Результат** | Строка |
| **Пример** | ``` REPLACE("Заявка утверждена.", "утверждена", "одобрена")   ```  Результат: `Заявка одобрена.` |

| `TOLOWER()` | |
| --- | --- |
| **Описание** | Приводит все буквы в строке к нижнему регистру (строчным буквам). |
| **Синтаксис** | ``` TOLOWER(string)   ``` |
| **Аргументы** | `string`: строка. |
| **Результат** | Строка |
| **Пример** | ``` TOLOWER("Все Буквы В ЭТОЙ Строке Стали Строчными.")   ```  Результат: `все буквы в этой строке стали строчными.` |

| `TOUPPER()` | |
| --- | --- |
| **Описание** | Приводит все буквы в строке к верхнему регистру (прописным буквам). |
| **Синтаксис** | ``` TOUPPER(string)   ``` |
| **Аргументы** | `string`: строка. |
| **Результат** | Строка |
| **Пример** | ``` TOUPPER("Все Буквы В Этой Строке Стали прописными.")   ```  Результат: `ВСЕ БУКВЫ В ЭТОЙ СТРОКЕ СТАЛИ ПРОПИСНЫМИ.` |

| `TRIM()` | |
| --- | --- |
| **Описание** | Удаляет пробелы в начале и конце строки. |
| **Синтаксис** | ``` TRIM(string)   ``` |
| **Аргументы** | `string`: строка. |
| **Результат** | Строка |
| **Пример** | ``` TRIM("   В этой строке были лишние пробелы.   ")   ```  Результат: `В этой строке были лишние пробелы.` |

| `STARTSWITH()` | |
| --- | --- |
| **Описание** | Сравнивает две строки и возвращает значение `True`, если первая строка начинается на вторую, в противном случае возвращает `False`. |
| **Синтаксис** | ``` STARTSWITH(string, startString)   ``` |
| **Аргументы** | `string`, `startString`: строка. |
| **Результат** | Логическое значение |
| **Пример** | ``` STARTSWITH("Строка", "Стр")   ```  Результат: `True` |

| `SUBSTRING()` | |
| --- | --- |
| **Описание** | Принимает три аргумента: строку и два числа. Извлекает из исходной строки подстроку начиная с заданной позиции до конца исходной строки либо до указанной длины подстроки. |
| **Синтаксис** | ``` SUBSTRING(sourceString, startIndex, numberOfChars)   ``` |
| **Аргументы** | - `sourceString`: строка. - `startIndex`: номер позиции начала подстроки, отсчитывается от `0`. - `numberOfChars`: количество символов в подстроке (необязательный аргумент). |
| **Результат** | Строка |
| **Пример** | ``` SUBSTRING("Раньше эта строка начиналась с другого слова.", 7, 31)   ```  Результат: `эта строка начиналась с другого` |

## Функции для обработки дат, времени и длительности

| `ADDDAYS()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество дней к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDDAYS(dateTime, numberOfDays)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfDays`: количество дней, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDDAYS(DATE('2024-01-01T01:01:01'), 3)   ```  Результат: `04.01.2024 1:01:01` |

| `ADDDAYSUTC()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество дней к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDDAYSUTC(dateTime, numberOfDays)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfDays`: количество дней, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDDAYSUTC(DATE('2024-01-01T01:01:01+00:00'), 3)   ```  Результат при `UTC+03:00` на сервере: `04.01.2024 04:01:01` |

| `ADDDUR()` | |
| --- | --- |
| **Описание** | Суммирует два значения типа «**Длительность**». |
| **Синтаксис** | ``` ADDDUR(duration1, duration2)   ``` |
| **Аргументы** | `duration1`, `duration2`: длительность. |
| **Результат** | Длительность |
| **Пример** | ``` ADDDUR(DURATION('P1DT12H30M5S'), DURATION('P1DT12H30M5S'))   ```  Результат: `3 д 1 ч 10 с` |

| `ADDHOURS()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество часов к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDHOURS(dateTime, numberOfHours)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfHours`: количество часов, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDHOURS(DATE('2024-01-01T01:01:01'), 3)   ```  Результат: `01.01.2024 4:01:01` |

| `ADDHOURSUTC()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество часов к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDHOURSUTC(dateTime, numberOfHours)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfHours`: количество часов, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDHOURSUTC(DATE('2024-01-01T01:01:01+00:00'), 3)   ```  Результат при `UTC+03:00` на сервере: `01.01.2024 07:01:01`. |

| `ADDLOC()` | |
| --- | --- |
| **Описание** | Прибавляет значение типа «**Длительность**» к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDLOC(dateTime, duration)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `duration`: длительность, которую требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDLOC(DATE('2024-01-01T01:01:01'), DURATION('P1DT12H30M5S'))   ```  Результат: `02.01.2024 13:31:06` |

| `ADDMINUTES()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество минут к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDMINUTES(dateTime, numberOfMinutes)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfMinutes`: количество минут, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDMINUTES(DATE('2024-01-01T01:01:01'), 3)   ```  Результат: `01.01.2024 01:04:01` |

| `ADDMINUTESUTC()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество минут к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDMINUTESUTC(dateTime, numberOfMinutes)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfMinutes`: количество минут, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDMINUTESUTC(DATE('2024-01-01T01:01:01+00:00'), 3)   ```  Результат при `UTC+03:00` на сервере: `01.01.2024 04:04:01`. |

| `ADDMONTHS()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество месяцев к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDMONTHS(dateTime, numberOfMonths)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfMonths`: количество месяцев, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDMONTHS(DATE('2024-01-01T01:01:01'), 3)   ```  Результат: `01.04.2024 1:01:01` |

| `ADDMONTHSUTC()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество месяцев к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDMONTHSUTC(dateTime, numberOfMonths)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfMonths`: количество месяцев, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDMONTHSUTC(DATE('2024-01-01T01:01:01+00:00'), 3)   ```  Результат при `UTC+03:00` на сервере: `01.04.2024 04:01:01`. |

| `ADDSECONDS()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество секунд к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDSECONDS(dateTime, numberOfSeconds)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfSeconds`: количество секунд, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDSECONDS(DATE('2024-01-01T01:01:01'), 3)   ```  Результат: `01.01.2024 1:01:04` |

| `ADDSECONDSUTC()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество секунд к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDSECONDSUTC(dateTime, numberOfSeconds)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfSeconds`: количество секунд, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDSECONDSUTC(DATE('2024-01-01T01:01:01+00:00'), 3)   ```  Результат при `UTC+03:00` на сервере: `01.01.2024 4:01:04`. |

| `ADDUTC()` | |
| --- | --- |
| **Описание** | Прибавляет значение типа «**Длительность**» к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDUTC(dateTime, duration)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `duration`: длительность, которую требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDUTC(DATE('2024-01-01T01:01:01+00:00'), DURATION('P1DT12H30M5S'))   ```  Результат при `UTC+03:00` на сервере: `02.01.2024 16:31:06`. |

| `ADDYEARS()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество лет к значению типа «**Дата и время**». |
| **Синтаксис** | ``` ADDYEARS(dateTime, numberOfYears)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfYears`: количество лет, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDYEARS(DATE('2024-01-01T01:01:01'), 3)   ```  Результат: `01.01.2027 1:01:01` |

| `ADDYEARSUTC()` | |
| --- | --- |
| **Описание** | Прибавляет указанное количество лет к значению типа «**Дата и время**» и переводит результат в часовой пояс `UTC+00:00`. |
| **Синтаксис** | ``` ADDYEARSUTC(dateTime, numberOfYears)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `numberOfYears`: количество лет, которое требуется прибавить. |
| **Результат** | Дата и время |
| **Пример** | ``` ADDYEARSUTC(DATE('2024-01-01T01:01:01+00:00'), 3)   ```  Результат при `UTC+03:00` на сервере: `01.01.2027 4:01:01` |

| `BETWEEN()` | |
| --- | --- |
| **Описание** | Возвращает `True`, если значение типа «**Дата и время**» или «**Длительность**» входит в заданный диапазон. |
| **Синтаксис** | ``` BETWEEN(value, min, max)   ``` |
| **Аргументы** | - `value` — дата и время или длительность для проверки. - `min` — начальное значение диапазона. - `max` — конечное значение диапазона. |
| **Результат** | Логическое значение |
| **Пример** | ``` BETWEEN(DURATION("PT3H15M"), DURATION("PT3H1M"), DURATION("PT3H25M"))   ```  Результат: `True` |

| `BETWEENUTC()` | |
| --- | --- |
| **Описание** | Возвращает `True`, если значение типа «**Дата и время**» или «**Длительность**» входит в заданный диапазон. Приводит значения типа «**Дата и время**» к часовому поясу `UTC+00:00`. |
| **Синтаксис** | ``` BETWEENUTC(value, min, max)   ``` |
| **Аргументы** | - `value` — дата и время или длительность для проверки. - `min` — начальное значение диапазона. - `max` — конечное значение диапазона. |
| **Результат** | Логическое значение |
| **Пример** | ``` BETWEENUTC(      DATE("2025-01-15+00:00"),      DATE("2024-02-15+01:00"),      DATE("2024-08-15-01:00")  )   ```  Результат: `False` |

| `CENTURY()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает число, соответствующее веку аргумента. |
| **Синтаксис** | ``` CENTURY(dateTime)   ``` |
| **Аргументы** | `dateTime` — дата, для которой требуется определить век. |
| **Результат** | Число |
| **Пример** | ``` CENTURY(DATE("2000-01-01T05:45:15"))   ```  Результат: `21` |

| `CENTURYUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает номер века, на который приходится результирующая дата. |
| **Синтаксис** | ``` CENTURYUTC(dateTime)   ``` |
| **Аргументы** | `dateTime` — дата, для которой требуется определить век. |
| **Результат** | Число |
| **Пример** | ``` CENTURYUTC(DATE("2000-01-01T05:45:15+10:00"))   ```  Результат: `20` |

| `COMPARE()` | |
| --- | --- |
| **Описание** | Сравнивает два значения типа «**Длительность**» и возвращает целое число:   - `1`, если первый аргумент больше второго; - `0`, если аргументы равны; - `-1`, если первый аргумент меньше второго. |
| **Синтаксис** | ``` COMPARE(duration1, duration2)   ``` |
| **Аргументы** | `duration1`, `duration2`: длительность. |
| **Результат** | Число |
| **Пример** | ``` COMPARE(DURATION("PT3H15M"), DURATION("PT3H16M"))   ```  Возвращает `-1` |

| `CONVERTTIMEZONE()` | |
| --- | --- |
| **Описание** | Переводит значение типа «**Дата и время**» в заданный часовой пояс в формате IANA. |
| **Синтаксис** | ``` CONVERTTIMEZONE(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime` — дата и время. - `timeZone` — строка, задающая часовой пояс в формате IANA. |
| **Результат** | Дата и время |
| **Пример** | ``` CONVERTTIMEZONE(DATE("2025-05-05T13:45:15+00:00"), "Europe/London")   ```  Результат при `UTC+03:00` на сервере: `05.05.2025 14:45:15`. |

| `CONVERTTIMEZONEUTC()` | |
| --- | --- |
| **Описание** | Переводит значение типа «**Дата и время**» в часовой пояс `UTC+00:00`, а затем в заданный часовой пояс в формате IANA. |
| **Синтаксис** | ``` CONVERTTIMEZONEUTC(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime` — дата и время. - `timeZone` — строка, задающая часовой пояс в формате IANA. |
| **Результат** | Дата и время |
| **Пример** | ``` CONVERTTIMEZONEUTC(DATE("2025-05-05T13:45:15+00:00"), "Europe/Moscow")   ```  Результат: `05.05.2025 16:45:15` |

| `DAY()` | |
| --- | --- |
| **Описание** | Принимает значение типа «**Дата и время**» и строку с часовым поясом в формате IANA. Возвращает число месяца, на которое приходится указанная дата с учётом часового пояса. |
| **Синтаксис** | ``` DAY(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `timeZone`: строка, задающая часовой пояс в формате IANA (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` DAY(DATE("2025-05-05T23:45:15+00:00"), "Europe/Moscow")   ```  Результат: `6` |

| `DAYOFWEEK()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает название соответствующего дня недели. |
| **Синтаксис** | ``` DAYOFWEEK(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` DAYOFWEEK(DATE("2025-05-05T23:45:15"))   ```  Результат: `понедельник` |

| `DAYOFWEEKUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» переводит его в часовой пояс `UTC+00:00` и возвращает название дня недели, на который приходится результирующая дата. |
| **Синтаксис** | ``` DAYOFWEEKUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` DAYOFWEEKUTC(DATE("2025-05-05T20:45:15-01:00"))   ```  Результат: `понедельник` |

| `DAYOFYEAR()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает номер дня соответствующего года. |
| **Синтаксис** | ``` DAYOFYEAR(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` DAYOFYEAR(DATE("2025-05-05T23:45:15"))   ```  Результат: `125` |

| `DAYOFYEARUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает номер дня года, на который приходится результирующая дата. |
| **Синтаксис** | ``` DAYOFYEARUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` DAYOFYEARUTC(DATE("2025-05-05T23:45:15+00:00"))   ```  Результат: `125` |

| `DAYS()` | |
| --- | --- |
| **Описание** | Преобразует значение типа «**Длительность**» в десятичное число, представляющее количество дней. |
| **Синтаксис** | ``` DAYS(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` DAYS(DURATION('P12DT64H75M1360S'))   ```  Результат: `14,7344907407407` |

| `DAYSINMONTH()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» или два аргумента типа «**Число**» — год и месяц. Возвращает количество дней в соответствующем месяце. |
| **Синтаксис** | ``` DAYSINMONTH(dateTime)   ```  **или**  ``` DAYSINMONTH(year, month)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `year, month`: числа. |
| **Результат** | Число |
| **Пример** | ``` DAYSINMONTH(2024, 02)   ```  Результат: `29`  ``` DAYSINMONTH(DATE("2025-02-05T23:45:15"))   ```  Результат: `28` |

| `DAYSINMONTHUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» или два аргумента типа «**Число**» — год и месяц. Преобразует дату и время в часовой пояс `UTC+00:00`. Возвращает количество дней в результирующем месяце. |
| **Синтаксис** | ``` DAYSINMONTHUTC(dateTime)   ```  **или**  ``` DAYSINMONTHUTC(year, month)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `year, month`: числа. |
| **Результат** | Число |
| **Пример** | ``` DAYSINMONTHUTC(2025, 02)   ```  Результат: `28`  ``` DAYSINMONTHUTC(DATE("2025-02-28T23:45:15-02:00"))   ```  Результат: `31` |

| `DAYUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает число месяца, на который приходится результирующая дата. |
| **Синтаксис** | ``` DAYUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` DAYUTC(DATE("2025-04-30T23:45:15-02:00"))   ```  Результат: `1` |

| `ENDOFDAY()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время окончания соответствующего дня. |
| **Синтаксис** | ``` ENDOFDAY(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFDAY(DATE('2025-05-05T01:01:01'))   ```  Результат: `05.05.2025 23:59:59` |

| `ENDOFDAYUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время окончания результирующего дня. |
| **Синтаксис** | ``` ENDOFDAYUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFDAYUTC(DATE('2025-05-05T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `05.05.2025 02:59:59` |

| `ENDOFMONTH()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время окончания соответствующего месяца. |
| **Синтаксис** | ``` ENDOFMONTH(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFMONTH(DATE('2025-05-05T01:01:01'))   ```  Результат: `31.05.2025 23:59:59` |

| `ENDOFMONTHUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время окончания месяца, на который приходится результирующая дата. |
| **Синтаксис** | ``` ENDOFMONTHUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFMONTHUTC(DATE('2025-05-01T01:01:01+03:00'))   ```  Результат для `UTC+03:00` на сервере: `01.05.2025 02:59:59` |

| `ENDOFQUARTER()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время окончания соответствующего квартала. |
| **Синтаксис** | ``` ENDOFQUARTER(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFQUARTER(DATE('2025-04-01T01:01:01'))   ```  Результат: `30.06.2025 23:59:59` |

| `ENDOFQUARTERUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время окончания квартала, на который приходится результирующая дата. |
| **Синтаксис** | ``` ENDOFQUARTERUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFQUARTERUTC(DATE('2025-04-01T01:01:01+03:00'))   ```  Результат для `UTC+03:00` на сервере: `01.04.2025 02:59:59` |

| `ENDOFWEEK()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», и возвращает дату и время окончания соответствующей недели. |
| **Синтаксис** | ``` ENDOFWEEK(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFWEEK(DATE('2025-05-05T01:01:01'))   ```  Результат: `11.05.2025 23:59:59` |

| `ENDOFWEEKUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время окончания недели, на которую приходится результирующая дата. |
| **Синтаксис** | ``` ENDOFWEEKUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFWEEKUTC(DATE('2025-05-05T01:01:01+03:00'))   ```  Результат для `UTC+03:00` на сервере: `05.05.2025 02:59:59` |

| `ENDOFYEAR()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время окончания соответствующего года. |
| **Синтаксис** | ``` ENDOFYEAR(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFYEAR(DATE('2025-01-01T01:01:01'))   ```  Результат: `31.12.2025 23:59:59` |

| `ENDOFYEARUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время окончания года, на который приходится результирующая дата. |
| **Синтаксис** | ``` ENDOFYEARUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время |
| **Результат** | Дата и время |
| **Пример** | ``` ENDOFYEARUTC(DATE('2025-01-01T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `31.12.2024 23:59:59` |

| `EQ()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента типа «**Дата и время**» или «**Длительность**» и возвращает значение `True`, если они равны, в противном случае возвращает `False`. |
| **Синтаксис** | ``` EQ(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`, `argument2`: дата и время. - `argument1`, `argument2`: длительность. |
| **Результат** | Логическое значение |
| **Пример** | ``` EQ(DURATION('P2DT1H30M30S'), DURATION('P1DT25H30M30S'))   ```  Результат: `True` |

| `EQUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**», преобразует их в часовой пояс `UTC+00:00`. Сравнивает результирующие значения и возвращает значение `True`, если они равны, в противном случае возвращает `False`. |
| **Синтаксис** | ``` EQUTC(dateTime1, dateTime2)   ``` |
| **Аргументы** | `dateTime1`, `dateTime2`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` EQUTC(DATE('2025-01-01T01:01:01+03:00'), DATE('2025-01-01T00:01:01+02:00'))   ```  Результат: `True` |

| `FORMATDUR()` | |
| --- | --- |
| **Описание** | Преобразует значение типа «**Длительность**» в строку формата ISO 8601. |
| **Синтаксис** | ``` FORMATDUR(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Строка |
| **Пример** | ``` FORMATDUR(INSECONDS(5000000))   ```  Результат: `P57DT20H53M20S`, где:   - `P` — префикс периода; - `Y` — годы; - `M` — месяцы; - `W` — недели; - `D` — дни; - `T` — префикс времени; - `H` — часы; - `M` — минуты; - `S` — секунды. |

| `FORMATLOC()` | |
| --- | --- |
| **Описание** | Преобразует значение типа «**Дата и время**» в строку формата ISO 8601.  См. также *«[Форматирование значений в шаблонах экспорта и формулах][export_template_file_formula_format_values]»*. |
| **Синтаксис** | ``` FORMATLOC(dateTime, formatString)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `formatString`: строка, задающая формат ISO 8601. |
| **Результат** | Строка |
| **Пример** | ``` FORMATLOC(DATE('2025-05-05T05:05:25'), "dd MMMM yyyy г. hh:mm:ss")   ```  Результат: `05 мая 2025 г. 05:05:25` |

| `FORMATUTC()` | |
| --- | --- |
| **Описание** | Преобразует значение типа «**Дата и время**» в строку формата ISO 8601 в часовом поясе `UTC+00:00`.  См. также *«[Форматирование значений в шаблонах экспорта и формулах][export_template_file_formula_format_values]»*. |
| **Синтаксис** | ``` FORMATUTC(dateTime, formatString)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `formatString`: строка. |
| **Результат** | Строка |
| **Пример** | ``` FORMATUTC(DATE('2025-05-05T05:05:25+03:00'), "dd MMMM yyyy года hh:mm:ss")   ```  Результат: `05 мая 2025 г. 02:05:25` |

| `GE()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента типа «**Дата и время**» или «**Длительность**». Возвращает логическое значение `True`, если первый аргумент больше или равен второму, в противном случае возвращает `False`. |
| **Синтаксис** | ``` GE(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`, `argument2`: дата и время. - `argument1`, `argument2`: длительность. |
| **Результат** | Логическое значение |
| **Пример** | ``` GE(DURATION('P1DT1H30M30S'), DURATION('P2DT1H30M30S'))   ```  Результат: `False` |

| `GETSPAN()` | |
| --- | --- |
| **Описание** | Вычисляет длительность между значениями двух аргументов типа «**Дата и время**». |
| **Синтаксис** | ``` GETSPAN(dateTime1, dateTime2)   ``` |
| **Аргументы** | `dateTime1`, `dateTime2`: дата и время. |
| **Результат** | Длительность |
| **Пример** | ``` GETSPAN(DATE('2025-05-05T05:05:25'), DATE('2025-05-05T10:10:50'))   ```  Результат: `-05:05:25` |

| `GETSPANUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**», переводит их значения в часовой пояс `UTC+00:00` и вычисляет длительность между результирующими значениями. |
| **Синтаксис** | ``` GETSPANUTC(dateTime1, dateTime2)   ``` |
| **Аргументы** | `dateTime1`, `dateTime2`: дата и время. |
| **Результат** | Длительность |
| **Пример** | ``` GETSPANUTC(DATE('2025-05-05T05:05:25+00:00'), DATE('2025-05-05T05:05:25+05:00'))   ```  Результат: `05:00:00` |

| `GEUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**», переводит их значения в часовой пояс `UTC+00:00`. Сравнивает результирующие значения и возвращает логическое значение `True`, если первое значение больше или равно второму, в противном случае возвращает `False`. |
| **Синтаксис** | ``` GEUTC(dateTime1, dateTime2)   ``` |
| **Аргументы** | `dateTime1`, `dateTime2`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` GEUTC(DATE('2025-05-05T05:05:25+00:00'), DATE('2025-05-05T05:05:25+05:00'))   ```  Результат: `True` |

| `GT()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**» или «**Длительность**». Возвращает логическое значение `True`, если первый аргумент больше второго, в противном случае возвращает `False`. |
| **Синтаксис** | ``` GT(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`, `argument2`: длительность - `argument1`, `argument2`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` GT(DATE('2025-05-05T05:05:25'), DATE('2025-05-05T05:05:25'))   ```  Результат: `False` |

| `GTUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**» и переводит их значения в часовой пояс `UTC+00:00`. Возвращает логическое значение `True`, если первое значение больше второго, в противном случае возвращает `False`. |
| **Синтаксис** | ``` GTUTC(argument1, argument2)   ``` |
| **Аргументы** | `argument1`, `argument2`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` GTUTC(DATE('2025-05-05T05:05:25+00:00'), DATE('2025-05-05T05:05:25+05:00'))   ```  Результат: `True` |

| `HOUR()` | |
| --- | --- |
| **Описание** | Принимает значение типа «**Дата и время**» и строку с часовым поясом в формате IANA. Возвращает час результирующего времени с учётом часового пояса. |
| **Синтаксис** | ``` HOUR(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `timeZone`: строка, задающая часовой пояс в формате IANA (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` HOUR(DATE('2025-05-05T05:05:25+00:00'), "Europe/Moscow")   ```  Результат: `8` |

| `HOURS()` | |
| --- | --- |
| **Описание** | Преобразует аргумент типа «**Длительность**» в количество часов в десятичном формате. |
| **Синтаксис** | ``` HOURS(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` HOURS(DURATION('P2DT1H30M0S'))   ```  Результат: `49,5` |

| `HOURUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает число, соответствующее часу результирующего времени. |
| **Синтаксис** | ``` HOURUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` HOURUTC(DATE('2025-05-05T05:05:25+03:00'))   ```  Результат: `2` |

| `INSECONDS()` | |
| --- | --- |
| **Описание** | - Преобразует аргумент типа «**Дата и время**» или «**Длительность**» в количество секунд. - Преобразует количество секунд в аргументе типа «**Число**» в значение типа «**Длительность**». |
| **Синтаксис** | ``` INSECONDS(argument)   ``` |
| **Аргументы** | `argument`: дата и время, длительность или число. |
| **Результат** | - Количество секунд для аргумента типа «**Дата и время**» или «**Длительность**». - Длительность для аргумента типа «**Число**». |
| **Пример** | ``` INSECONDS(5)   ```  Результат: `00:00:05` |

| `INSECONDSUTC()` | |
| --- | --- |
| **Описание** | - Переводит аргумент типа «**Дата и время**» в часовой пояс `UTC+00:00` и возвращает количество секунд в результирующем значении. - Преобразует аргумент типа «**Длительность**» в количество секунд. - Преобразует количество секунд в аргументе типа «**Число**» в значение типа «**Длительность**». |
| **Синтаксис** | ``` INSECONDSUTC(argument)   ``` |
| **Аргументы** | `argument`: дата и время, длительность или число. |
| **Результат** | - Количество секунд для аргумента типа «**Дата и время**» или «**Длительность**». - Длительность для аргумента типа «**Число**». |
| **Пример** | ``` INSECONDSUTC(DATE('2025-05-05T05:05:25'))   ```  Результат: `63882018325` |

| `ISLEAPYEAR()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает логическое значение `True`, если год указанной даты является високосным, в противном случае возвращает `False`. |
| **Синтаксис** | ``` ISLEAPYEAR(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISLEAPYEAR(DATE('2025-01-01T01:01:01'))   ```  Результат: `False` |

| `ISLEAPYEARUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает логическое значение `True`, если год результирующей даты является високосным, в противном случае возвращает `False`. |
| **Синтаксис** | ``` ISLEAPYEARUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISLEAPYEARUTC(DATE('2025-01-01T01:01:01+03:00'))   ```  Результат: `True` |

| `ISOFORMAT()` | |
| --- | --- |
| **Описание** | Преобразует значение типа «**Дата и время**» в строку формата ISO 8601. |
| **Синтаксис** | ``` ISOFORMAT(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Строка |
| **Пример** | ``` ISOFORMAT(NOW())   ```  Результат: `2025-05-28T09:07:52.362149+03:00` |

| `ISOFORMATUTC()` | |
| --- | --- |
| **Описание** | Принимает значение типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и преобразует в строку формата ISO 8601. |
| **Синтаксис** | ``` ISOFORMATUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Строка |
| **Пример** | ``` ISOFORMATUTC(NOW())   ```  Результат: `2025-05-28T06:10:39.357235Z`. |

| `ISTODAY()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает логическое значение `True`, если значение аргумента приходится на текущую дату, в противном случае возвращает `False`. |
| **Синтаксис** | ``` ISTODAY(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISTODAY(NOW())   ```  Результат: `True`, так как `NOW()` возвращает текущую дату. |

| `ISTODAYUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00`и возвращает логическое значение `True`, если результирующее значение приходится на текущую дату, в противном случае возвращает `False`. |
| **Синтаксис** | ``` ISTODAYUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISTODAYUTC(NOW())   ```  Результат: `True`, если дата в часовом поясе `UTC+00:00` совпадает с текущей датой. |

| `ISWEEKEND()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает логическое значение `True`, если значение аргумента приходится на выходной день, в противном случае возвращает результат `False`. |
| **Синтаксис** | ``` ISWEEKEND(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISWEEKEND(DATE('2025-05-05T01:01:01'))   ```  Результат: `False` |

| `ISWEEKENDUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает логическое значение `True`, если результирующее значение приходится на выходной день, в противном случае возвращает результат `False`. |
| **Синтаксис** | ``` ISWEEKENDUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISWEEKENDUTC(DATE('2025-05-05T01:01:01+03:00'))   ```  Результат: `True` |

| `ISWORKDAY()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает логическое значение `True`, если значение аргумента приходится на рабочий день, в противном случае возвращает результат `False`. |
| **Синтаксис** | ``` ISWORKDAY(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISWORKDAY(DATE('2025-05-05T01:01:01'))   ```  Результат: `True` |

| `ISWORKDAYUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает логическое значение `True`, если результирующее значение приходится на рабочий день, в противном случае возвращает результат `False`. |
| **Синтаксис** | ``` ISWORKDAYUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` ISWORKDAYUTC(DATE('2025-05-05T01:01:01+03:00'))   ```  Результат: `False` |

| `LE()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента типа «**Дата и время**» или «**Длительность**». Если первый аргумент меньше или равен второму, возвращает логическое значение `True`, в противном случае возвращает `False`. |
| **Синтаксис** | ``` LE(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`, `argument2`: дата и время. - `argument1`, `argument2`: длительность. |
| **Результат** | Логическое значение |
| **Пример** | ``` LE(DURATION('P2DT1H0M0S'), DURATION('P3DT1H0M0S'))   ```  Результат: `True` |

| `LT()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента типа «**Дата и время**» или «**Длительность**» и возвращает логическое значение `True`, если первый аргумент меньше второго, в противном случае возвращает `False`. |
| **Синтаксис** | ``` LT(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`, `argument2`: дата и время. - `argument1`, `argument2`: длительность. |
| **Результат** | Логическое значение |
| **Пример** | ``` LT(DURATION('P2DT1H0M0S'), DURATION('P3DT1H0M0S'))   ```  Результат: `True` |

| `LTUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**», переводит их значения в часовой пояс `UTC+00:00` и возвращает логическое значение `True`, если первое значение меньше второго, в противном случае возвращает `False`. |
| **Синтаксис** | ``` LTUTC(dateTime1, dateTime2)   ``` |
| **Аргументы** | `dateTime1`, `dateTime2`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` LTUTC(DATE('2025-05-05T01:01:01+03:00'), DATE('2025-05-05T01:01:01+04:00'))   ```  Результат: `False` |

| `MINUTE()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и строку с часовым поясом в формате IANA.  Приводит аргумент к заданному часовому поясу и возвращает минуты результирующего времени. |
| **Синтаксис** | ``` MINUTE(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `timeZone`: строка, задающая часовой пояс в формате IANA (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` MINUTE(DATE('2025-05-05T01:01:01'))   ```  Результат: `1` |

| `MINUTES()` | |
| --- | --- |
| **Описание** | Преобразует аргумент типа «**Длительность**» в количество минут в десятичном формате. |
| **Синтаксис** | ``` MINUTES(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` MINUTES(DURATION('P1DT1H30M30S'))   ```  Результат: `1530,5` |

| `MINUTEUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его значение в часовой пояс `UTC+00:00` и возвращает число, соответствующее минутам результирующего времени. |
| **Синтаксис** | ``` MINUTEUTC(dateTime)   ``` |
| **Аргументы** | - `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` MINUTEUTC(DATE('2025-05-05T01:01:01+03:30'))   ```  Результат: `31` |

| `MONTH()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и строку с часовым поясом в формате IANA.  Приводит аргумент к заданному часовому поясу и возвращает месяц результирующей даты. |
| **Синтаксис** | ``` MONTH(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `timeZone`: строка, задающая часовой пояс в формате IANA (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` MONTH(DATE('2025-05-01T01:01:01+03:00'), "Europe/London")   ```  Результат: `4`  ``` MONTH(DATE('2025-05-01T01:01:01+03:00'), "Europe/Moscow")   ```  Результат: `5` |

| `MONTHS()` | |
| --- | --- |
| **Описание** | Преобразует аргумент типа «**Длительность**» в количество месяцев в десятичном формате. |
| **Синтаксис** | ``` MONTHS(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` MONTHS(DURATION('P45D'))   ```  Результат: `1,5` |

| `MONTHUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает число, соответствующее месяцу указанной даты для часового пояса `UTC+00:00`. |
| **Синтаксис** | ``` MONTHUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` MONTHUTC(DATE('2025-05-01T01:01:01+03:00'))   ```  Результат: `4` |

| `NE()` | |
| --- | --- |
| **Описание** | Сравнивает два аргумента типа «**Дата и время**» или «**Длительность**» и возвращает логическое значение `True`, если они не равны, в противном случае возврашает `False`. |
| **Синтаксис** | ``` NE(argument1, argument2)   ``` |
| **Аргументы** | - `argument1`, `argument2`: дата и время. - `argument1`, `argument2`: длительность. |
| **Результат** | Логическое значение |
| **Пример** | ``` NE(DURATION('P0DT25H30M0S'), DURATION('P1DT1H30M0S'))   ```  Результат: `False` |

| `NEUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента типа «**Дата и время**», переводит их значения в часовой пояс `UTC+00:00` и возвращает логическое значение `True`, если результирующие значения не равны, в противном случае возврашает `False`. |
| **Синтаксис** | ``` NEUTC(dateTime1, dateTime2)   ``` |
| **Аргументы** | `dateTime1`, `dateTime2`: дата и время. |
| **Результат** | Логическое значение |
| **Пример** | ``` NEUTC(DATE('2025-05-01T01:01:01+03:00'), DATE('2025-05-01T01:01:01+02:00'))   ```  Результат: `True` |

| `NOW()` | |
| --- | --- |
| **Описание** | Возвращает текущие дату и время. |
| **Синтаксис** | ``` NOW()   ``` |
| **Аргументы** | Не требуются. |
| **Результат** | Дата и время |
| **Пример** | ``` NOW()   ```  Результат: `28.05.2025 12:01:53` |

| `PARSEDATE()` | |
| --- | --- |
| **Описание** | Преобразует строку в значение типа «**Дата и время**» согласно заданной маске в формате ISO 8601. |
| **Синтаксис** | ``` PARSEDATE(string, stringFormat)   ``` |
| **Аргументы** | - `string`: строка. - `stringFormat`: строка, задающая формат даты по стандарту ISO 8601. |
| **Результат** | Дата и время |
| **Пример** | ``` PARSEDATE("050525", "MMddyy")   ```  Результат: `05.05.2025 0:00:00` |

| `PARSEDATEUTC()` | |
| --- | --- |
| **Описание** | Преобразует строку в значение типа «**Дата и время**» в часовом поясе `UTC+00:00` согласно заданной маске в формате ISO 8601. |
| **Синтаксис** | ``` PARSEDATEUTC(string, stringFormat)   ``` |
| **Аргументы** | - `string`: строка. - `stringFormat`: строка, задающая формат даты по стандарту ISO 8601. |
| **Результат** | Дата и время |
| **Пример** | ``` PARSEDATEUTC("0505250001", "MMddyyhhmm")   ```  Результат: `05.05.2025 0:01:00` |

| `QUARTERS()` | |
| --- | --- |
| **Описание** | Преобразует аргумент типа «**Длительность**» в количество кварталов в десятичном формате. |
| **Синтаксис** | ``` QUARTERS(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` QUARTERS(DURATION('P229D'))   ```  Результат: `2,5` |

| `SECOND()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и строку с часовым поясом в формате IANA.  Приводит аргумент к заданному часовому поясу и возвращает секунды результирующего времени. |
| **Синтаксис** | ``` SECOND(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `timeZone`: строка, задающая часовой пояс в формате IANA (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` SECOND(DATE('2025-05-05T01:01:01'), "Europe/London")   ```  Результат: `1` |

| `SECONDS()` | |
| --- | --- |
| **Описание** | Преобразует аргумент типа «**Длительность**» в количество секунд. |
| **Синтаксис** | ``` SECONDS(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` SECONDS(DURATION('P1DT1H30M0S'))   ```  Результат: `91800` |

| `SECONDUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает число, соответствующее секундам резуьтирующего времени. |
| **Синтаксис** | ``` SECONDUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` SECONDUTC(DATE('2025-05-05T01:01:01+01:00'))   ```  Результат: `1` |

| `STARTOFDAY()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время начала соответствующего дня. |
| **Синтаксис** | ``` STARTOFDAY(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFDAY(DATE('2025-05-05T01:01:01'))   ```  Результат: `05.05.2025 0:00:00` |

| `STARTOFDAYUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время начала результирующего дня. |
| **Синтаксис** | ``` STARTOFDAYUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFDAYUTC(DATE('2025-05-05T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `04.05.2025 03:00:00` |

| `STARTOFMONTH()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время начала соответствующего месяца. |
| **Синтаксис** | ``` STARTOFMONTH(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFMONTH(DATE('2025-05-01T01:01:01'))   ```  Результат: `01.05.2025 0:00:00` |

| `STARTOFMONTHUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время начала месяца, на который приходится результирующая дата. |
| **Синтаксис** | ``` STARTOFMONTHUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFMONTHUTC(DATE('2025-05-01T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `01.04.2025 03:00:00` |

| `STARTOFQUARTER()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время начала соответствующего квартала. |
| **Синтаксис** | ``` STARTOFQUARTER(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFQUARTER(DATE('2025-04-01T01:01:01'))   ```  Результат: `01.04.2025 0:00:00` |

| `STARTOFQUARTERUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время начала квартала, на который приходится результирующая дата. |
| **Синтаксис** | ``` STARTOFQUARTERUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFQUARTERUTC(DATE('2025-04-01T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `01.01.2025 03:00:00` |

| `STARTOFWEEK()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время начала соответствующей недели. |
| **Синтаксис** | ``` STARTOFWEEK(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFWEEK(DATE('2025-05-05T01:01:01'))   ```  Результат: `05.05.2025 0:00:00` |

| `STARTOFWEEKUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время начала недели, на которую приходится результирующая дата. |
| **Синтаксис** | ``` STARTOFWEEKUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFWEEKUTC(DATE('2025-05-05T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `28.04.2025 03:00:00` |

| `STARTOFYEAR()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает дату и время начала соответствующего года. |
| **Синтаксис** | ``` STARTOFYEAR(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFYEAR(DATE('2025-01-01T01:01:01'))   ```  Результат: `01.01.2025 0:00:00` |

| `STARTOFYEARUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает дату и время начала года, на который приходится результирующая дата. |
| **Синтаксис** | ``` STARTOFYEARUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Дата и время |
| **Пример** | ``` STARTOFYEARUTC(DATE('2025-01-01T01:01:01+03:00'))   ```  Результат для `UTC+03:00`: `01.01.2024 03:00:00` |

| `SUB()` | |
| --- | --- |
| **Описание** | Вычитает из значения аргумента типа «**Дата и время**» или «**Длительность**» значение типа «**Длительность**». |
| **Синтаксис** | ``` SUB(dateTime, duration)   ```  **или**  ``` SUB(duration, duration)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `duration`: длительность. |
| **Результат** | Дата и время |
| **Пример** | ``` SUB(DATE('2025-01-01T01:01:01'), DURATION('P1DT1H30M0S'))   ```  Результат: `30.12.2024 23:31:01` |

| `SUBUTC()` | |
| --- | --- |
| **Описание** | Вычитает из значения типа «**Дата и время**» значение типа «**Длительность**». Возвращает значение типа «**Дата и время**» для часового пояса `UTC+00:00`. |
| **Синтаксис** | ``` SUBUTC(dateTime, duration)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `duration`: длительность. |
| **Результат** | Дата и время |
| **Пример** | ``` SUBUTC(DATE('2025-01-01T01:01:01+00:00'), DURATION('P1DT1H30M0S'))   ```  Результат при `UTC+03:00` на сервере: `31.12.2024 02:31:01`. |

| `TODURATION()` | |
| --- | --- |
| **Описание** | Преобразует количество секунд в значение типа «**Длительность**». |
| **Синтаксис** | ``` TODURATION(number)   ``` |
| **Аргументы** | `number`: число. |
| **Результат** | Длительность |
| **Пример** | ``` TODURATION(12345)   ```  Результат: `03:25:45` |

| `WEEKOFYEAR()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и возвращает номер недели соответствующего года. |
| **Синтаксис** | ``` WEEKOFYEAR(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` WEEKOFYEAR(DATE('2025-05-06T01:01:01'))   ```  Результат: `18` |

| `WEEKOFYEARUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает номер недели года, на которую приходится результирующая дата. |
| **Синтаксис** | ``` WEEKOFYEARUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` WEEKOFYEARUTC(DATE('2025-05-06T01:01:01+03:00'))   ```  Результат при `UTC+03:00` на сервере: `17` |

| `WORKDAYS()` | |
| --- | --- |
| **Описание** | Принимает три аргумента: дату, количество рабочих дней и список исключаемых дат.  Прибавляет к исходной дате количество рабочих дней с учётом выходных дней и списка исключений и возвращает результирующую дату.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим.  Если рабочий часовой пояс отличается от часового пояса сервера **{{ productName }}**, используйте функцию [WORKDAYSTZ()](#workdaystz). |
| **Синтаксис** | ``` WORKDAYS(      startDateTime, workingDays,      LIST(excludedDate1, …, excludedDateN)  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `workingDays`: количество рабочих дней. - `LIST(excludedDate1, …, excludedDateN)` (необязательный аргумент): список исключаемых дат. |
| **Результат** | Дата и время |
| **Пример** | ``` WORKDAYS(      DATE('2025-05-01'), 10,      LIST(          DATE('2025-05-01'),           DATE('2025-05-02'),          DATE('2025-05-08'),          DATE('2025-05-09')      )  )   ```  Результат: `21.05.2025 0:00:00` |

| `WORKDAYSDURATION()` | |
| --- | --- |
| **Описание** | Принимает три аргумента: начальные дату и время, конечные дату и время и список исключаемых дат.  Возвращает длительность между начальной и конечной датой с учётом выходных дней и списка исключений.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим.  Если рабочий часовой пояс отличается от часового пояса сервера **{{ productName }}**, используйте функцию [WORKDAYSDURATIONTZ()](#workdaysdurationtz). |
| **Синтаксис** | ``` WORKDAYSDURATION(      startDateTime, endDateTime,      LIST(excludedDate1, …, excludedDateN)  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `endDateTime`: дата и время. - `LIST(excludedDate1, …, excludedDateN)`: (необязательный аргумент): список исключаемых дат. |
| **Результат** | Длительность |
| **Пример** | ``` WORKDAYSDURATION(      DATE('2025-05-01'), DATE('2025-05-12'),      LIST(          DATE('2025-05-01'),          DATE('2025-05-02'),          DATE('2025-05-08'),          DATE('2025-05-09')      )  )   ```  Результат: `3.00:00:00` |

| `WORKDAYSDURATIONTZ()` | |
| --- | --- |
| **Описание** | Принимает три аргумента: начальные дату и время, конечные дату и время, список исключаемых дат и часовой пояс.  Возвращает длительность между начальной и конечной датой с учётом выходных дней, списка исключений и часового пояса.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим. |
| **Синтаксис** | ``` WORKDAYSDURATIONTZ(      startDateTime, endDateTime,      LIST(excludedDate1, …, excludedDateN),      timeZone  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `endDateTime`: дата и время. - `LIST(excludedDate1, …, excludedDateN)`: (необязательный аргумент): список исключаемых дат. - `timeZone`: строка, задающая часовой пояс в формате IANA. |
| **Результат** | Длительность |
| **Пример** | ``` WORKDAYSDURATIONTZ(      DATE('2025-05-01'), DATE('2025-05-12'),       LIST(          DATE('2025-05-01'),          DATE('2025-05-02'),          DATE('2025-05-08'),          DATE('2025-05-09')      ),      "Asia/Tokyo"  )   ```  Результат: `3.06:00:00` |

| `WORKDAYSDURATIONUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента: начальные и конечные дату и время.  Переводит даты и время в часовой пояс `UTC+00:00` и возвращает длительность между ними за вычетом выходных дней. |
| **Синтаксис** | ``` WORKDAYSDURATIONUTC(startDateTime, endDateTime)   ``` |
| **Аргументы** | `startDateTime`, `endDateTime`: дата и время. |
| **Результат** | Длительность |
| **Пример** | ``` WORKDAYSDURATIONUTC(      DATE('2025-05-01+03:00'), DATE('2025-05-12+00:00')  )   ```  Результат: `9`  ``` WORKDAYSDURATIONUTC(      DATE('2025-05-01-12:00'), DATE('2025-05-12+00:00')  )   ```  Результат: `8` |

| `WORKDAYSTZ()` | |
| --- | --- |
| **Описание** | Принимает три аргумента: дату, количество рабочих дней, список исключаемых дат и часовой пояс.  Прибавляет к исходной дате количество рабочих дней с учётом выходных дней, списка исключений и часового пояса и возвращает результирующую дату.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим. |
| **Синтаксис** | ``` WORKDAYSTZ(      startDay, workingDays,      LIST(excludedDate1, …, excludedDateN),      timeZone  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `workingDays`: число, количество рабочих дней. - `LIST(excludedDate1, …, excludedDateN)`: (необязательный аргумент): список исключаемых дат. - `timeZone`: строка, задающая часовой пояс в формате IANA. |
| **Результат** | Дата и время |
| **Пример** | ``` WORKDAYSTZ(      DATE('2025-05-01+03:00'), 10,       LIST(          DATE('2025-05-01'),           DATE('2025-05-02'),           DATE('2025-05-08'),           DATE('2025-05-09')      ),      "America/Anchorage"  )   ```  Результат: `20.05.2025 0:00:00` |

| `WORKDAYSUTC()` | |
| --- | --- |
| **Описание** | Принимает два аргумента: дату и количество рабочих дней.  Приводит дату к часовому поясу `UTC+00:00`, прибавляет количество рабочих дней за вычетом выходных дней и возвращает результирующую дату. |
| **Синтаксис** | ``` WORKDAYSUTC(startDay, workingDays)   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `workingDays`: число, количество рабочих дней. |
| **Результат** | Дата и время |
| **Пример** | ``` WORKDAYSUTC(DATE('2025-05-01+03:00'), 3)   ```  Результат: `06.05.2025 0:00:00` |

| `WORKHOURS()` | |
| --- | --- |
| **Описание** | Принимает пять аргументов: дату начала работы, количество рабочих часов, отведённых на работу, время начала рабочего дня, продолжительность рабочего дня и список исключаемых дат.  Прибавляет к начальной дате количество рабочих часов с учётом времени начала и продолжительности рабочего дня, выходных дней и списка исключений и возвращает дату и время завершения работы.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим.  Если рабочий часовой пояс отличается от часового пояса сервера **{{ productName }}**, используйте функцию [`WORKHOURSTZ()`](#workhourstz). |
| **Синтаксис** | ``` WORKHOURS(      startDateTime, workingHours,       workingDayStart, workingDayDuration,      LIST(excludedDate1, ..., excludedDateN)      )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `workingHours`: число, количество рабочих часов. - `workingDayStart`: длительность, время начала рабочего дня от 00:00. - `workingDayDuration`: длительность рабочего дня (должна быть меньше разницы между полуночью и временем начала рабочего дня). - `LIST(excludedDate1, ..., excludedDateN)`: (необязательный аргумент): список исключаемых дат. |
| **Результат** | Дата и время |
| **Пример** | ``` WORKHOURS(      DATE('2025-05-01'), 5,      DURATION('PT9H'), DURATION('PT4H'),      LIST(          DATE('2025-05-01'),          DATE('2025-05-02'),          DATE('2025-05-08'),          DATE('2025-05-09')      )  )   ```  Результат: `06.05.2025 10:00:00` |

| `WORKHOURSDURATION()` | |
| --- | --- |
| **Описание** | Принимает пять аргументов: начальные дату и время, конечные дату и время, время начала рабочего дня, продолжительность рабочего дня и список исключаемых дат.  Возвращает длительность рабочего времени между начальной и конечной датами с учётом времени начала и продолжительности рабочего дня, выходных дней и списка исключений.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим.  Если рабочий часовой пояс отличается от часового пояса сервера **Comindware**, используйте функцию [`WORKHOURSDURATIONTZ()`](#workhoursdurationtz). |
| **Синтаксис** | ``` WORKHOURSDURATION(      startDateTime, endDateTime,       workingDayStart, workingDayDuration,      LIST(excludedDate1, ..., excludedDateN)  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `endDateTime`: дата и время. - `workingDayStart`: длительность, время начала рабочего дня от 00:00. - `workingDayEnd`: длительность рабочего дня (должна быть меньше разницы между полуночью и временем начала рабочего дня). - `LIST(excludedDate1, ..., excludedDateN)` (необязательный аргумент): список исключаемых дат. |
| **Результат** | Длительность |
| **Пример** | ``` WORKHOURSDURATION(      DATE('2025-05-01'), DATE('2025-05-07'),       DURATION('PT8H'), DURATION('PT15H'),      LIST(          DATE('2025-05-01'),           DATE('2025-05-02'),           DATE('2025-05-08'),           DATE('2025-05-09')      )  )   ```  Результат: `22:00:00` |

| `WORKHOURSDURATIONTZ()` | |
| --- | --- |
| **Описание** | Принимает шесть аргументов: начальные дату и время, конечные дату и время, время начала рабочего дня, продолжительность рабочего дня, список исключаемых дат и часовой пояс.  Возвращает длительность рабочего времени между начальной и конечной датами с учётом времени начала и продолжительности рабочего дня, выходных дней, списка исключений и часового пояса.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим. |
| **Синтаксис** | ``` WORKHOURSDURATIONTZ(      startDateTime, endDateTime,       workingDayStart, workingDayDuration,      LIST(holiday1, ..., holidayN),      timeZone  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `endDateTime`: дата и время. - `workingDayStart`: длительность, время начала рабочего дня. - `workingDayDuration`: длительность рабочего дня (должна быть меньше разницы между полуночью и временем начала рабочего дня). - `LIST(holiday1, ..., holidayN)` (необязательный аргумент): список исключаемых дат. - `timeZone`: строка, задающая часовой пояс в формате IANA. |
| **Результат** | Длительность |
| **Пример** | ``` WORKHOURSDURATIONTZ(      DATE('2025-05-01'), DATE('2025-05-07'),      DURATION('PT8H'), DURATION('PT15H'),      LIST(          DATE('2025-05-01'),           DATE('2025-05-02'),           DATE('2025-05-08'),          DATE ('2025-05-09')      ),      "Asia/Tokyo"  )   ```  Результат: `1.04:00:00` |

| `WORKHOURSTZ()` | |
| --- | --- |
| **Описание** | Принимает пять аргументов: дату начала работы, количество часов, отведённых на работу, время начала рабочего дня, продолжительность рабочего дня, список исключаемых дат и часовой пояс.  Прибавляет к начальной дате количество рабочих часов с учётом времени начала и продолжительности рабочего дня, выходных дней, списка исключений и часового пояса и возвращает дату и время завершения работы.  Если в списке исключений указан рабочий день, он считается выходным, а если если указан выходной день, он считается рабочим. |
| **Синтаксис** | ``` WORKHOURSTZ(      startDateTime, workingHours,       workingDayStart, workingDayDuration,      LIST(excludedDate1, ..., excludedDateN),      timeZone  )   ``` |
| **Аргументы** | - `startDateTime`: дата и время. - `workingHours`: число, количество рабочих часов. - `workingDayStart`: длительность, время начала рабочего дня от 00:00. - `workingDayDuration`: длительность рабочего дня (должна быть меньше разницы между полуночью и временем начала рабочего дня), - `LIST(excludedDate1, ..., excludedDateN)` (необязательный аргумент): список исключаемых дат. - `timeZone`: строка, задающая часовой пояс в формате IANA. |
| **Результат** | Дата и время |
| **Пример** | ``` WORKHOURSTZ(      DATE('2025-05-01'), 5,       DURATION('PT9H'), DURATION('PT4H'),       LIST(          DATE('2025-05-01'),           DATE('2025-05-02'),           DATE('2025-05-08'),           DATE('2025-05-09')      ),      "America/Anchorage"  )   ```  Результат: `05.05.2025 10:00:00` |

| `YEAR()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**» и строку с часовым поясом в формате IANA.  Приводит аргумент к заданному часовому поясу и возвращает год результирующей даты. |
| **Синтаксис** | ``` YEAR(dateTime, timeZone)   ``` |
| **Аргументы** | - `dateTime`: дата и время. - `timeZone`: строка, задающая часовой пояс в формате IANA (необязательный аргумент). |
| **Результат** | Число |
| **Пример** | ``` YEAR(DATE('2025-01-01'), "America/Anchorage")   ```  Результат: `2024` |

| `YEARS()` | |
| --- | --- |
| **Описание** | Преобразует аргумента типа «**Длительность**» в количество лет. |
| **Синтаксис** | ``` YEARS(duration)   ``` |
| **Аргументы** | `duration`: длительность. |
| **Результат** | Число |
| **Пример** | ``` YEARS(DURATION('P183D'))   ```  Результат: `0,5` |

| `YEARUTC()` | |
| --- | --- |
| **Описание** | Принимает аргумент типа «**Дата и время**», переводит его в часовой пояс `UTC+00:00` и возвращает год результирующей даты. |
| **Синтаксис** | ``` YEARUTC(dateTime)   ``` |
| **Аргументы** | `dateTime`: дата и время. |
| **Результат** | Число |
| **Пример** | ``` YEARUTC(DATE('2025-01-01+03:00'))   ```  Результат: `2024` |

--8<-- "related_topics_heading.md"

- [Редактор выражений][expression_editor]
- [Введение в язык формул Comindware](https://kb.comindware.ru/category.php?id=880)
- [Форматирование значений в шаблонах экспорта и формулах][export_template_file_formula_format_values]
- [Глобальная конфигурация][global_configuration]

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
