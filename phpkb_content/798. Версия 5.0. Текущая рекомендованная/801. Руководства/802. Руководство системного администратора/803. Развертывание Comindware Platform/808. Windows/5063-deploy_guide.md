---
title: Установка, запуск, инициализация и остановка ПО в Windows
kbId: 5063
---

# Установка, запуск, инициализация и остановка ПО в Windows

## Введение

Для быстрого развёртывания **{{ productName }}** в Windows компания **Comindware** предоставляет дистрибутив с установщиком, настраивающим необходимое программное обеспечение.

Здесь представлены инструкции по развёртыванию и инициализации **{{ productName }}** из дистрибутива в ОС Windows.

## Порядок установки ПО

1. Подготовьте сервер и окружение к установке ПО.
2. Установите и настройте необходимое вспомогательное ПО.
3. Установите ПО **{{ productName }}**.
4. Создайте экземпляр ПО.
5. Запустите экземпляр ПО.
6. Инициализируйте экземпляр ПО.

## Требования к серверу и окружению

Для работы **{{ productName }}** требуются:

- операционная система;
- веб-сервер;
- сервер журналирования транзакций;
- сервер очереди сообщений.

Ниже представлены инструкции по установке и настройке необходимого ПО.

### Требования к Windows-серверу

Перед установкой **{{ productName }}** убедитесь, что выполняются следующие требования:

- сервер работает под управлением операционной системы *Windows Server*;
- настройку сервера выполняет пользователь с правами администратора;
- установлена и настроена служба *IIS (Internet Information Services)*. См. *«[Подготовка IIS к установке {{ productName }}](#deploy_guide_windows_server_prepare)»*.
- установлено следующее вспомогательное ПО:

  - [.NET 8.0 SDK версии 8.0.408 или выше](https://dotnet.microsoft.com/en-us/download/dotnet/8.0)
  - [ASP.NET Core 8.0 Runtime - Windows Hosting Bundle Installer](https://dotnet.microsoft.com/ru-ru/download/dotnet/thank-you/runtime-aspnetcore-8.0.15-windows-hosting-bundle-installer)
  - [Microsoft Build of OpenJDK версии 17 или выше](https://learn.microsoft.com/en-us/java/openjdk/download#openjdk-17)

  Скачайте это ПО по приведённым выше ссылкам и установите его самостоятельно либо установите его из нашего дистрибутива, следуя инструкциям в параграфе *«[Установка вспомогательного ПО](#deploy_guide_windows_install_prerequisites)»*.

Также могут потребоваться:

- [7-Zip](https://www.7-zip.org/)
- [VSCode](https://code.visualstudio.com/Download)

### Требования к внешним службам

Для работы **{{ productName }}** необходимо развернуть следующие внешние службы:

- сервер журналирования транзакций OpenSearch (Elasticsearch);
- сервер брокера сообщений Apache Kafka.

Установите и настройте это ПО согласно следующим инструкциям:

- *[Elasticsearch. Установка в Windows][elasticsearch_deploy_windows]*
- *[Elasticsearch. Установка в Linux][elasticsearch_deploy_Linux]*
- *[Apache Kafka. Установка в Windows][kafka_deploy_windows]*
- *[Apache Kafka. Установка в Linux][kafka_deploy_linux]*

## Примечания по установке

Пути к файлам и директориям

Используемые по умолчанию пути к файлам ПО **{{ productName }}** см. в статье *«[Пути и содержимое директорий экземпляра ПО][paths]»*.

В вашей конфигурации могут использоваться другие пути, поэтому внимательно подставляйте фактические пути в команды при выполнении инструкций.

Вызов справки для скриптов

Ключ `-h` позволяет просмотреть справку по ключам и назначению любого скрипта для развёртывания **{{ productName }}**.

Используйте его без других ключей, например:

```
.\\version_install.ps1 -h

```

Обязательные ключи для скриптов

Если не указать обязательный ключ, скрипт запросит его после запуска.

Условные обозначения

Значения, которые вы должны подставить согласно своей конфигурации, заключены в угловые скобки:

- `<instanceName>` — имя экземпляра ПО;
- `<portNumber>` — номер порта;
- `<versionNumber>` — номер версии ПО вида `X.X.XXXX.X` (например: `5.0.1234.0`);
- `<prerequisitesDistPath>` — путь к распакованному дистрибутиву вспомогательного ПО;
- `<distPath>` — путь к распакованному дистрибутиву ПО **{{ productName }}**.

Политика выполнения PowerShell

В зависимости от конфигурации вашей системы для выполнения скриптов из дистрибутива **{{ productName }}** может потребоваться установить неограниченную политику выполнения *PowerShell*. Для этого может выполните указанные ниже действия.

1. Запустите *PowerShell*.
2. Определите текущую политику выполнения *PowerShell*:

   ```
   Get-ExecutionPolicy

   ```
3. Если политика отличается от `Unrestricted`, установите неограниченную политику выполнения *PowerShell*:

   ```
   Set-ExecutionPolicy Unrestricted

   ```
4. В запросе на изменение политики выберите вариант «**Да для всех**», введя букву `A`.

Внимание!

По окончании работы с дистрибутивом **{{ productName }}** верните исходную политику выполнения *PowerShell*.

## Подготовка IIS к установке {{ productName }}

1. Откройте **Диспетчер серверов**.
2. Добавьте в список серверов компьютер, на котором будет установлено ПО **{{ productName }}**.
3. Запустите **Мастер добавления ролей и компонентов**, выбрав пункт «**Добавить роли и компоненты**» для данного сервера.
4. На шаге «**Тип установки**» выберите пункт «**Установка ролей или компонентов**».
5. На шаге «**Выбор сервера**» укажите сервер, на котором будет установлено ПО.
6. На шаге «**Роли сервера**» установите следующие флажки

   - **Web Server (IIS)**
     - **Web Server**
       - **Common HTTP Features**
         - Default Document
         - HTTP Errors
         - Static Content
         - HTTP Redirection
         - WebDAV Publishing
       - **Health and Diagnostics**
         - HTTP Logging
         - Custom Logging
         - Request Monitor
       - **Performance**
         - Static Content Compression
         - Dynamic Content Compression
       - **Security**
         - Request Filtering
         - Basic Authentication
         - Centralized SSL
         - IP and Domain Restrictions
         - Windows Authentication
       - **Application Development**
         - ASP.NET 4.8 (или новее)
         - Application Initialization
         - WebSocket Protocol
         - .NET Extensibility 4.8 (или новее)
         - ISAPI Extensions
         - ISAPI Filters
       - **Management Tools**
         - IIS Management Console
         - IIS Management Scripts and Tools
7. На шаге «**Компоненты**» установите следующие флажки:

   - **.NET Framework 4.8 Features** (или новее)
     - .Net Framework 4.8
     - ASP.NET 4.8
     - **WCF Services**
       - HTTP Activation
       - TCP Port Sharing
   - **Windows Process Activation Service**
     - Process Model
     - Configuration API
8. Сверьтесь со следующим примером корректной конфигурации IIS:

   ![Пример корректно настроенных ролей и компонентов веб-сервера IIS](/platform/v5.0/administration/deploy/windows/img/deploy_guide_windows_iis_components.png)

   Пример корректно настроенных ролей и компонентов веб-сервера IIS
9. На шаге «**Подтверждение**» нажмите кнопку «**Установить**» и дождитесь завершения процесса.

## Установка вспомогательного ПО

1. Скачайте и распакуйте архив с дистрибутивом вспомогательного ПО для **{{ productName }}**.
2. Запустите *PowerShell* от имени администратора.
3. При необходимости установите неограниченную политику выполнения *PowerShell*. См. *«[Политика выполнения PowerShell](#powershell_execution_policy)»*.
4. Перейдите в папку со скриптами для развёртывания вспомогательного ПО:

   ```
   cd "<prerequisitesDistPath>\\CMW_Windows<versionNumber>\\scripts"

   ```

   Здесь `<prerequisitesDistPath>` — путь к распакованному дистрибутиву вспомогательного ПО (например, `X:\\<distPath>\\X.X-release-ru-<versionNumber>.prerequisites.windows`).
5. Разблокируйте доступ к скачанным из интернета установочным файлам:

   ```
   .\\files_unblock.ps1

   ```
6. Установите необходимое вспомогательное ПО:

   ```
   .\\prerequisites_install.ps1

   ```
7. Перезагрузите машину.
8. Запустите *PowerShell* от имени администратора.
9. Перейдите в папку со скриптами для развёртывания вспомогательного ПО:

   ```
   cd "<prerequisitesDistPath>\\CMW_Windows<versionNumber>\\scripts"

   ```
10. Проверьте, что вспомогательное ПО установлено:

    ```
    .\\prerequisites_list.ps1

    ```

    Если какое-либо вспомогательное ПО не было установлено, повторите шаги 6–10.

## Установка {{ productName }}

1. Скачайте и распакуйте архив с дистрибутивом **{{ productName }}**.
2. Запустите *PowerShell* от имени администратора.
3. При необходимости установите неограниченную политику выполнения *PowerShell*. См. *«[Политика выполнения PowerShell](#powershell_execution_policy)»*.
4. Перейдите в папку со скриптами для развёртывания ПО **{{ productName }}**:

   ```
   cd "<distPath>\\CMW_Windows<versionNumber>\\scripts"

   ```

   Здесь `<distPath>` — путь к распакованному дистрибутиву ПО **{{ productName }}** (например, `X:\\<distPath>\\X.X-release-ru-<versionNumber>.windows`).
5. Разблокируйте доступ к скачанным из интернета установочным файлам:

   ```
   .\\files_unblock.ps1

   ```
6. Установите версию ПО:

   ```
   .\\version_install.ps1

   ```

   Пример результата выполнения скрипта:

   ```
   Operation complete.

   ###############################################
   Installer folder    : C:\\install\\CMW_Windows_5.0.13334.0
   Version file path   : C:\\install\\CMW_Windows_5.0.13334.0\\core\\bin\\Comindware.Platform.Core.dll
   Version             : 5.0.13334.0
   Source bin folder   : C:\\install\\CMW_Windows_5.0.13334.0\\core\\*
   Target bin path     : C:\\Program Files\\Comindware\\CBAP\\5.0.13334.0
   Command executed.
   Complete script version_install.ps1.
   ###############################################
   Status: Completed

   ```
7. Удостоверьтесь, что ПО установлено, вызывав список установленных версий ПО:

   ```
   .\\version_list.ps1

   ```

   Пример списка установленных версий ПО:

   ```
   Running script version_list.ps1.
   ====================================================================
   Source folder: C:\\Program Files\\Comindware\\CBAP
   ====================================================================
   Version
   ====================================================================
   5.0.13286.0
   5.0.13334.0

   ####################################################################
   Command executed.
   Complete script version_list.ps1.
   ####################################################################
   Status: Completed

   ```

## Создание экземпляра ПО

1. Перейдите в папку со скриптами для развёртывания ПО **{{ productName }}**:

   ```
   cd "<distPath>\\CMW_Windows<versionNumber>\\scripts"

   ```
2. Разверните экземпляр ПО:

   ```
   .\\instance_create.ps1 -name <instanceName> -version <versionNumber>

   ```

   Ключи:

   - `-name` — имя экземпляра;
   - `-version` — номер версии ПО;
   - `-port` (необязательно) — порт для экземпляра ПО (по умолчанию: 80).

## Запуск экземпляра ПО

1. Перейдите в папку со скриптами для развёртывания ПО **{{ productName }}**:

   ```
   cd "<distPath>\\CMW_Windows<versionNumber>\\scripts"

   ```
2. Запустите экземпляр ПО:

   ```
   .\\instance_start.ps1 -name <instanceName>

   ```

   Ключ:

   - `-name` — имя экземпляра.

## Остановка экземпляра ПО

1. Перейдите в папку со скриптами для развёртывания ПО **{{ productName }}**:

   ```
   cd "X:\\<distPath>\\X.X-release-ru-<versionNumber>.windows\\CMW_Windows<versionNumber>\\scripts"

   ```
2. Остановите экземпляр ПО:

   ```
   .\\instance_stop.ps1 -name <instanceName>

   ```

   Ключ:

   - `-name` — имя экземпляра.

## Инициализация {{ productName }}

1. Запустите веб-браузер и в адресной строке введите URL-адрес, на котором был развёрнут экземпляр ПО:

   ```
   http://<instanceHost>:<portNumber>

   ```
2. Дождитесь запуска и отображения веб-сайта **{{ productName }}**, что может занять примерно 5 минут.
3. Откроется страница создания аккаунта администратора **{{ productName }}**.

   ![Страница создания аккаунта администратора](/platform/v5.0/administration/deploy/windows/../linux/img/deploy_guide_admin_account_create.png)

   Страница создания аккаунта администратора
4. Введите учётные данные аккаунта администратора и нажмите кнопку «**Создать аккаунт**».

   Внимание!

   - В **{{ productName }}** всегда должен оставаться хотя бы один аккаунт администратора. Он может потребоваться для восстановления системы.
   - Аккаунт администратора, созданный при инициализации экземпляра ПО, не следует удалять, даже если впоследствии аккаунты будут синхронизироваться с Active Directory.
5. При необходимости откроется страница активации ПО. Выполните **онлайновую** или **ручную активацию** либо нажмите кнопку «**Пропустить**» для первоначального ознакомления с ПО без активации.
6. При необходимости откроется страница настройки подключения к службе OpenSearch (Elasticsearch).

   - В поле «**URI**» введите адрес сервера OpenSearch (Elasticsearch), например: `http://<openSearchHost>:<opeSearchPort>`.
   - При необходимости введите **имя пользователя** и **пароль** OpenSearch (Elasticsearch).
   - Установите уникальный **префикс индекса**, например `mycompanyprefix`.
   - Экземпляр ПО будет взаимодействовать с OpenSearch (Elasticsearch) под указанным пользователем и создавать, наполнять и читать индексы с заданным префиксом.
   - Нажмите кнопку «**Далее**».
7. При необходимости откроется страница инициализации данных в OpenSearch (Elasticsearch).

   ![Страница инициализации данных в OpenSearch (Elasticsearch)](/platform/v5.0/administration/deploy/windows/../linux/img/deploy_guide_elasticsearch_initialize.png)

   Страница инициализации данных в OpenSearch (Elasticsearch)
8. Нажмите кнопку «**Обновить**».
9. Дождитесь открытия начальной страницы **{{ productName }}**.
10. На этом этапе развертывание экземпляра **{{ productName }}** завершено.
11. Подготовьте экземпляр к разработке приложений.

## Подготовка экземпляра ПО к разработке приложений

Прежде чем вносить какие-либо изменения, создавать и использовать приложения, настройте резервное копирование и возможность восстановления паролей. Это позволит обеспечить работоспособность **{{ productName }}** в долгосрочной перспективе.

1. Создайте резервную копию созданного экземпляра **{{ productName }}**:

   - Создайте конфигурацию резервного копирования по расписанию.
   - Запустите резервное копирование вручную, чтобы создать первую резервную копию чистого экземпляра ПО.

   См. *«[Резервное копирование. Настройка, запуск и просмотр журнала сеансов][backup_configure]»*.
2. Настройте подключение к почтовому серверу для отправки писем для сброса пароля и двухфакторной аутентификации:

   - Создайте подключение типа «**Отправка эл. почты из процесса**».
   - Установите в свойствах подключения флажок «**Использовать по умолчанию**».
   - **Отправьте тестовое сообщение**, чтобы удостовериться в работоспособности подключения.
   - Не настраивайте путь передачи данных и процесс. Это не требуется для отправки уведомлений.

   См. *«[Отправка почты из процесса. Настройка подключения][process_sending_connection]»*.
3. Снова запустите резервное копирование вручную, чтобы создать резервную копию работоспособного экземпляра ПО.
4. Теперь можно приступать к созданию приложений на основе **{{ productName }}**.

## Удаление экземпляра ПО

1. Перейдите в папку со скриптами для развёртывания ПО **{{ productName }}**:

   ```
   cd "<distPath>\\CMW_Windows<versionNumber>\\scripts"

   ```
2. Удалите экземпляр ПО:

   ```
   .\\instance_delete.ps1 -name <instanceName>

   ```

   Ключи:

   - `-name` — имя экземпляра.

     Если не указать другие ключи, будет удалена только служба `comindware<instanceName>`.
   - `-deleteData` (необязательно) — удалить следующие объекты:

     - базу данных из папки вида `C:\\ProgramData\\Comindware\\Instances\\<instanceName>\\Data`;
     - пользовательские файлы экземпляра ПО из папки вида `C:\\ProgramData\\Comindware\\Instances\\<instanceName>\\Streams`.

     Без указания этого ключа или ключа `-clear` база данных экземпляра ПО не будет удалена.
   - `-clear` (необязательно) — удалить следующие объекты:

     - все файлы, папки, базу данных и пользовательские файлы экземпляра ПО;
     - папку экземпляра ПО вида `C:\\ProgramData\\Comindware\\Instances\\<instanceName>`;
     - все службы экземпляра ПО;
     - сайт и пул приложения из IIS.

## Удаление версии ПО

1. Перейдите в папку со скриптами для развёртывания ПО **{{ productName }}**:

   ```
   cd "<distPath>\\CMW_Windows<versionNumber>\\scripts"

   ```
2. Просмотрите список установленных экземпляров ПО:

   ```
   .\\instance_list.ps1

   ```
3. Удалите все экземпляры с версией ПО, которую требуется удалить, или обновите их до другой версии.

   Примечание

   Удалить версию ПО, которая используется в каких-либо экземплярах, не удастся.

   Сначала удалите экземпляр по, см. *«[Удаление экземпляра ПО](#deploy_guide_windows_instance_delete)»*.
4. Удалите версию ПО:

   ```
   .\\version_delete.ps1 -version <versionNumber>

   ```

   Ключ:

   - `-version` — номер версии ПО (например: `5.0.1234.0`).

--8<-- "related_topics_heading.md"

- [Пути и содержимое директорий экземпляра ПО][paths]
- [Обновление версии экземпляра ПО в Windows](upgrade_version.html#upgrade_version_windows)
- [Резервное копирование. Настройка, запуск и просмотр журнала сеансов][backup_configure]
- [Отправка почты из процесса. Настройка подключения][process_sending_connection]
- [Elasticsearch. Установка в Windows][elasticsearch_deploy_windows]
- [Elasticsearch. Установка в Linux][elasticsearch_deploy_Linux]
- [Apache Kafka. Установка в Windows][kafka_deploy_windows]
- [Apache Kafka. Установка в Linux][kafka_deploy_linux]

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
