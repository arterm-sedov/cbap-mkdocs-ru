---
title: Шаблон экспорта. Выгрузка нескольких коллекций и изображений с помощью C#
kbId: 4792
---

# Шаблон экспорта. Выгрузка нескольких коллекций и изображений с помощью C#

Данная статья ориентирована на разработчиков С# скриптов. См. также: [Шаблон экспорта, Настройка с использованием C#][export_template_csharp_configure].

Рассмотрим выгрузку записи в формате PDF. Будут выгружены две коллекции (в виде таблиц) и атрибут с типом данных «Изображение», содержащий изображение (изображения).

**1.** Сформируйте шаблон экспорта по примеру (приведённый образец шаблона можно найти во вложении к статье):

_![Пример настроенного шаблона экспорта C#](https://kb.comindware.ru/assets/ctemplate.PNG)_

В шаблоне поле под картинку помещено внутрь таблицы на случай, если в атрибуте будет содержаться несколько изображений.

**2.** Настройте модель данных в скрипте по примеру:

| public class IMG {     public byte[] Image\_data { get; set; } } public class TBL\_1 {     public string Faktor { get; set; }     public string Parametr { get; set; }     public string Value { get; set; } } public class TBL\_2 {     public string Destination { get; set; }     public string Order { get; set; }     public string Date { get; set; }     public string Responsible { get; set; } } public class RESULT {     public List<IMG> Photo\_1 { get; set; }     public List<TBL\_1> Table\_1 { get; set; }     public List<TBL\_2> Table\_2 { get; set; } } |
| --- |

Обратите внимание, что под каждую таблицу должен быть определён свой уникальный класс. 

**3.** Напишите весь скрипт (пример скрипта во вложении).

Комментарии к скрипту:

- Для получения данных используется API-функция GetPropertyValues, которая позволяет запрашивать из базы данных значения только необходимых атрибутов, что ускоряет работу скрипта при большом количестве данных (строки 17-23).
- В строках 38-39 приведены примеры получения данных из ссылочных атрибутов.
- В строках 54, 65 приведён пример получения ФИО из атрибута с типом данных «Аккаунт».
- В строках 172, 184 реализована проверка на формат изображения (можете задать свои параметры).
{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
