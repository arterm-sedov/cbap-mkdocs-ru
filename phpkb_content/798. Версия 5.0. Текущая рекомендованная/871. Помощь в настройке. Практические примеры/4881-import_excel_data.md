---
title: Импорт связанных данных из таблицы Excel
kbId: 4881
---

# Импорт связанных данных из таблицы Excel

Импорт данных — это стандартная операция в рамках **{{ productName }}**. Можно импортировать данные в любой из существующих шаблонов записи и даже устанавливать связи между записями из разных шаблонов. В данной статье мы рассмотрим как раз импорт связанных данных, а именно, заполнение таблицы в записи из excel файла.

Таблица на форме записи — это, по сути, отфильтрованная таблица из связанного шаблона записи. Каждая строка таблицы, то есть, запись в шаблоне записи, ссылается на основной объект, где отображается таблица. Поэтому, для того чтобы данные из таблицы Excel перенеслись в таблицу на форме, нужно импортировать таблицу Excel в шаблон записи, на который ссылается таблица, и в отдельном столбце указать значение ссылки на главный объект (либо в виде ИД, либо значения в отображаемом атрибуте, который указан в системе). Таким образом, импортированные записи будут сразу привязаны к основному объекту, и таблица в нём заполнится автоматически, без лишних настроек.

 

**Пример**

В качестве примера, импортируем Excel таблицу заявок к каждому клиенту. Для этого в системе созданы шаблон записи «*Клиенты*» и шаблон записи «*Заказы*». В «*Заказах*» есть ссылка на «*Клиенты*», а в «*Клиентах*» — связанная ссылка с отмеченным флагом «***Несколько значений***» — «*Заказы клиента*».

Excel таблица для импорта выглядит примерно так:

_![Пример Excel таблицы](https://kb.comindware.ru/assets/excel_table_import.png)_

В столбце «*Клиент*» в данном случае указаны названия клиентов, заведенных в системе.

В разделе ***«Импорт»*** шаблона записи «*Заказы*» загружаем данную таблицу Excel и настраиваем соответствие столбцов таблицы с атрибутами шаблона записи. Указываем формат ***name*** напротив «*Клиента*», соответствующий отображаемому атрибуту в данном шаблоне записи. Указываем напротив поля «*Сумма*» формат «***Валюта***».

_![Настройка импорта таблицы Excel](https://kb.comindware.ru/assets/2021-12-30_13h46_19.png)_

В шаблоне записи «*Заказы*» появились новые записи, с проставленной связью к определенному клиенту.

_![Таблица в шаблоне записи "Заявки"](https://kb.comindware.ru/assets/2021-12-30_13h48_11.png)_

В свою очередь, таблица «*Заявки клиента*» в «*Клиентах*» выглядит следующим образом:

_![Таблица заказов клиента](https://kb.comindware.ru/assets/2021-12-30_13h49_38.png)_

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
