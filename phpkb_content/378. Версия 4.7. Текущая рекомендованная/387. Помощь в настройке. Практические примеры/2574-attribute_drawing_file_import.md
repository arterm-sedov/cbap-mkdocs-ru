---
title: Чертёж. Подготовка и импорт файла DWG
kbId: 2574
---

# Чертёж. Подготовка и импорт файла DWG

## Введение

На форме можно разместить чертёж с планом помещений, на котором будут отображаться данные из шаблонов записей с привязкой к объектам на чертеже.

Для использования чертежа в **{{ productName }}** потребуется [подготовить файл DWG](#mcetoc_1hlspkjds0), создать несколько шаблонов и атрибутов определённых типов, поместить поле атрибута типа «**Чертёж**» на форму и привязать его к шаблонам записей. Конечный пользователь, в свою очередь, должен импортировать файл чертежа в формате DWG и привязать слои полигонов и маркеров к атрибутам, заданным при настройке поля.

См. также статью *«[Чертёж. Настройка шаблонов, атрибутов, форм и полей][attribute_drawing]».*

## Подготовка чертежа

### Обязательные требования к чертежу

Перед импортом в систему чертеж необходимо подготовить согласно следующим требованиям, в противном случае процедура импорта будет неудачной либо чертеж будет отображаться некорректно:

- Контур каждого объекта должен быть построен в одним единым замкнутым полигоном (например, одно помещение — один полигон).
- Полигоны должны быть построены инструментом «Полилиния» и должны состоять из прямых отрезков. Кривые не поддерживаются, поэтому для построения криволинейных полигонов следует использовать несколько прямых отрезков.
- Внутри каждого полигона должно находиться его текстовое наименование (например, ID помещения), соответствующее значению текстового атрибута записи в **{{ productName }}**.
- Полигоны не должны пересекаться ни одной своей частью с другим замкнутым полигоном.
- Полигоны должны находится на отдельном слое, на котором кроме замкнутых полигонов не должно быть никаких других объектов.
- Вложенные полигоны должны находиться на разных слоях.
- Текстовые блоки с наименованиями полигонов должны находится на отдельном слое, на котором кроме текстов с наименованиями полигонов не должно быть никаких других объектов.
- Текстовые блоки должны быть однострочными, типа ТЕКСТ.
- Текстовый блок с наименованием полигона должен находиться внутри соответствующего замкнутого полигона.
- На каждый слой полигонов должен быть отдельный слой с текстовыми наименованиями.
- Полигоны и текстовые наименования должны находиться на любом слое, кроме *Слоя 0*.
- *Слой 0* должен быть пустым.

_![Пример чертежа в AutoCAD](https://kb.comindware.ru/assets/img_65c6415e30a02.png)_

Примечание

Определения инструментов и сущностей, такие как *«полилиния»*,  *«слой»*, взяты из программе AutoCAD и относятся к данной программе.

 

### Подготовка чертежа в AutoCAD

1. Откройте Диспетчер слоев и создайте новый слой.

_![Диспетчер слоев AutoCAD](https://kb.comindware.ru/assets/img_65c64171d5529.png)_
2. Назовите новый слой, например, cmw\_room.
3. Задайте для линий, например, синий цвет и вес 0,3 мм.

_![Диспетчер слоев AutoCAD](https://kb.comindware.ru/assets/img_65c6418a2a3a4.png)_
4. Также создадим отдельный слой для точек с текстом наименований полигонов аналогичным способом, в нашем примере это «cmw\_room\_attribute». Приступим к отрисовке полигонов для объектов.

Примечание

    - Каждый объект должен быть отрисован в AutoCAD одним единым замкнутым *полигоном из прямых полилиний* (например, одно помещение = один полигон).
    - На каждый полигон должен быть выведен текст с наименованием полигона (например, ID помещения) в соответствии с загруженным реестром.
    - Текст с наименованием полигона должен находится внутри замкнутого полигона.
    - На каждый слой полигонов иметься отдельный слой с текстовыми наименованиями.
    - Полигоны и точки с текстовыми наименованиями должны находиться на любом слое, кроме *Слоя 0.*
5. Полигон можно создать инструментом «Полилиния»  ![](https://kb.comindware.ru/assets/img_65c63bc4cb8aa.png)  на активном слое с полигонами, в нашем примере это *cmw\_room*.

_![Создание контура помещения AutoCAD](https://kb.comindware.ru/assets/img_65c63baf8d99c.png)_
6. Прорисовку следует выполнять по контуру объекта чертежа.

Примечание

Полилиния замыкается командой «Замкнуть» по щелчку правой кнопкой мыши.
7. После создания всех полигонов необходимо перейти к созданию точек с текстом наименований полигонов. Сначала выберем активный слой, на который будут наноситься точки, в нашем случае это *cmw\_room\_attribute*, и используем инструмент «Текст» с вкладки ленточного меню «Главная».

_![Создание точки с текстом](https://kb.comindware.ru/assets/img_65c63c07f16dd.png)_
8. Если необходимо импортировать несколько уровней полигонов, для каждого из уровней необходимо выполнить вышеуказанные действия, возможно создание максимум трех уровней. В нашем примере были созданы:
    - слой полигонов *cmw\_room*, на котором находятся полигоны помещений;
    - слой точек с наименованиями полигонов *cmw\_room\_attribute*, на котором находятся наименования помещений;
    - слой полигонов *cmw\_workspace*, на котором находятся полигоны рабочих мест;
    - слой точек с наименованиями полигонов *cmw\_workspace\_attribute*, на котором находятся наименования рабочих мест.
9. По окончании подготовки чертежа можно переходить к импорту подготовленного DWG-файла в **{{ productName }}** для установления связей объектов чертежа с объектами системы.

## Импорт чертежа

Предусловие: должны быть созданы экземпляры шаблонов записей, которые необходимо связать с полигонами на чертеже, должен быть создан и вынесен на форму атрибут «Чертеж». 

Примечание: для каждого уровня связи должен быть создан отдельный ШЗ.

1. В поле атрибута типа *«***Чертёж***»* на форме нажмите кнопку «**Загрузка файла**».
2. На шаге 1 «**Загрузка файла**» в мастере «**Настройка плана**» выберите подготовленный DWG-файл.

_![](https://kb.comindware.ru/assets/img_65c640abd145d.png)_Шаг 1. Загрузка файла
3. В случае ошибочной загрузки файла его можно удалить и загрузить другой DWG-файл.
4. Нажмите кнопку «**Далее**» для перехода к следующему шагу.
5. На шаге 2 «**Настройка связей**» установите связи слоев DWG-файла с записями в приложении. Первыми привязывайте слои наружных полигонов — следуйте от больших областей к меньшим (вложенным).

    - В поле «**Слой полигонов**» выберите слой с полигонами.
    - В поле «**Слой наименований**» выберите слой, на котором находятся текстовые наименования полигонов.
    - В поле «**Шаблон записи**» будет указан шаблон записи, заданный для уровня связи в свойствах поля атрибута «**Чертёж**». В этом шаблоне будут храниться записи, связанные с полигонами на чертеже.
    - В поле «**Атрибут**» будет указан ключевой атрибут имен объектов, заданный для уровня связи в свойствах поля атрибута «**Чертёж**». Этот атрибут будет использоваться для привязки полигонов по их наименованиям к записям в указанном шаблоне.
    
    
    
    ![Шаг 2. Привязка слоёв чертежа к шаблонам и атрибутам](https://kb.comindware.ru/assets/img_65c640914bb78.png)
    
    
    
    
    Шаг 2. Привязка слоёв чертежа к шаблонам и атрибутам

--8<-- "related_topics_heading.md"

**[Чертёж. Настройка шаблонов, атрибутов, форм и полей][attribute_drawing]**

**[Чертёж. Настройка поля на форме][form_dynamic_elements]**



{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
