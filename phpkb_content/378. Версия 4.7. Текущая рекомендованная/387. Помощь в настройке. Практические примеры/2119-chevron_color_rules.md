---
title: Шевроны. Правила окрашивания. Пример настройки
kbId: 2119
---

# Шевроны. Правила окрашивания. Пример настройки

## Введение

В этой статье представлен пример настройки правил окраски шевронов в зависимости от статуса их выполнения.

Определения

- **Шевроны** служат для визуального отображения этапов.
- Шевроны являются представлением атрибута типа «**Запись**», хранящего несколько значений.
- Шевроны отображаются как последовательность цветных плашек с заголовками записей связанного шаблона.
- Цвет шеврона можно задать двумя способами:
    - с помощью системного атрибута «**Цвет**» связанной записи;
    - с помощью **правил окраски** шевронов.
- Если не настроены правила окраски шевронов или не сработает ни одно правило, они будут окрашиваться цветом, указанным в системном атрибуте «[**Цвет**][form_dynamic_elements]» в соответствующих записях. Если при этом для записи атрибут «**Цвет**» не задан, то шеврон будет окрашен в зелёный цвет.
- Если для одной записи одновременно сработают несколько правил, возвращающих разные цвета, то шеврон будет окрашен в цвет, заданный последним сработавшим правилом.
- Правил окраски шевронов может быть неограниченное количество, но для оптимальной работы платформы рекомендуется задавать не более 8 условий.
- При составлении правил окраски рекомендуется использовать атрибуты из связанного шаблона, хранящего данные этапов, а не атрибуты шаблона, на форме которого настраиваются шевроны.
- Подробные сведения о настройке шевронов см. в параграфе *«[Динамические элементы формы. Настройка шевронов][form_dynamic_elements]»*.

## Прикладная задача

Имеется приложение оформления заявок. Требуется окрашивать шевроны в соответствии со статусом этапов выполнения заявки:

- оранжевый #efbb3a — этап начался, если указана дата начала, но не указана дата завершения;
- зеленый #338320 — этап завершился, если указаны даты начала и завершения;
- серый #a8a8a8 — этап не начался, если не указаны ни дата начала, ни дата завершения.

## Исходные данные

Создайте приложение *«Управление заявками»* и настройте в нём перечисленные ниже шаблоны.

### Шаблон записи «Этапы заявок»

1. Создайте **шаблон записи** *«Этапы»*.
2. Создайте следующие атрибуты в этом шаблоне:

| Название атрибута | Свойства |
| --- | --- |
| *Номер этапа* | **Тип данных: число** **Количество знаков после запятой: 0** |
| *Название этапа* | **Тип данных: текст** **Формат отображения:** **обычный текст** **Использовать как заголовок записей:** флажок установлен |
| *Дата начала* | **Тип данных: дата и время** |
| *Дата завершения* | **Тип данных: дата и время** |

### Шаблон записи «Заявки»

1. Создайте ним **шаблон записи***«Заявки»*.
2. В шаблоне записи *«Заявки»* создайте следующие атрибуты:

| Название атрибута | Свойства |
| --- | --- |
| *Этапы* | **Тип данных: запись** **Связанный шаблон:** *Этапы заявок* **Хранить несколько значений:** флажок установлен **Взаимная связь с атрибутом:**  **с новым** **Свойства нового атрибута:**     - **Название**: *Заявка*     - **Хранить несколько значений******:****  флажок снят |
3. Откройте конструктор основной формы шаблона *«Заявки».*
4. Вынесите на форму атрибут *«Название заявки».*
5. Вынесите на форму атрибут *«Этапы»*
6. На панели «**Свойства поля**» выберите **представление** «**Таблица**».
7. В поле «**Сортировка**» на панели «**Свойства таблицы**» выберите атрибут *«Номер этапа»*.
8. Поместите в таблицу *«Этапы»* атрибуты из шаблона *«Этапы»* в качестве столбцов*:*
    - *Номер этапа*
    - *Название этапа*
    - *Дата начала*
    - *Дата завершения*
9. Добавьте на область кнопок таблицы *«Этапы»* кнопку **«Создать»**.
10. Снова вынесите на форму шаблона *«Заявки»* атрибут *«Этапы»*.
11. В панели «**Свойства поля**» выберите **представление** «**Шевроны**».
12. Настройте свойства шевронов:
    - **Упорядочивание: *ID***
    - **Правила окраски записей:** нажимайте **«Создать»**  и настройте следующие правила:
    
    
    | Цвет | Условие: формула |
    | --- | --- |
    | Оранжевый #efbb3a | ``` AND(NOT(EMPTY($Datanachala)),EMPTY($Datazaversheniya)) ``` |
    | Зелёный  #338320 | ``` AND(NOT(EMPTY($Datazaversheniya)),NOT(EMPTY($Datanachala)))                ``` |
    | Серый  #a8a8a8 | ``` AND(EMPTY($Datanachala),EMPTY($Datazaversheniya))                 ``` |
    
    
    Примечание
    
    
    Следует помнить, что условие окрашивания шеврона вычисляется в контексте шаблона, связанного с текущим шаблоном посредством с атрибута типа «**Запись**». Поэтому обратиться к атрибутам текущего шаблона, на форме которого размещены шевроны, можно только посредством обратной ссылки. Например, к атрибуту **ID** заявки можно обратиться посредством атрибута *«Заявка»* из связанного шаблона, который ссылается на текущий шаблон*:* `$Zayavka->id`.
13. Сохраните форму.

## Проверка работы приложения

1. Откройте шаблон процесса *«Заявки»*.
2. Нажмите кнопку «**Перейти к экземплярам**».
3. Отобразится таблица «**Все записи**» со списком заявок.
4. Создайте и заполните несколько строк в таблице *«Этапы»* на форме заявки:
    - введите *название этапа;*
    - у некоторых этапов введите только *дату начала* или только *дату завершения*;
    - у некоторых этапов не указывайте ни одну из дат.
5. После заполнения каждой строки в таблице *«Этапы»* сохраняйте запись, чтобы применить изменения.
6. Для каждой строки в таблице *«Этапы»* должен появляться шеврон с *названием этапа*.
7. Цвета шевронов должны меняться в зависимости от значений в столбцах *«Дата начала»* и *«Дата завершения»* таблицы *«Этапы».*

_![Прогресс выполнения заявки в виде шевронов](https://kb.comindware.ru/assets/img_660a9e23f3b6c.png)_

--8<-- "related_topics_heading.md"

**[Шевроны. Визуализация этапов процесса. Пример настройки][chevron_stage_render]**

**[Динамические элементы формы. Настройка шевронов][form_dynamic_elements]**



{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
