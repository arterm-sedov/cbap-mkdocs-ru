<h1>Формирование текста письма по шаблону</h1><p>В ряде случаев может потребоваться необходимость формирования текста письма по определённому шаблону с возможностью автоматического добавления переменных в некоторых местах. Это может понадобиться, например, для настройки отправки уведомления пользователям о результатах выполнения работы или информировании клиентов об изменениях сроков.</p>
<p>Ниже описана последовательность действий для настройки текста уведомления сотрудника в рамках процесса оформления отпуска. Данную последовательность можно применять и для настройки вашего сценария, видоизменив определенные переменные.</p>
<p><strong>1.</strong> В текущем шаблоне записи (в данном примере — «Отпуска») создайте текстовый атрибут «Шаблон письма» (системное имя «template»), в котором будет содержаться текст шаблона с переменными, а также при необходимости с включенными в него дополнительными данными (графические изображения и т.д.).</p>
<p>Пример шаблона:</p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code">
<p><em>Уважаемый [Сотрудник], </em></p>
<p><em>Просим вас явиться в кабинет директора по персоналу [Срок] для подписания документов на отпуск.</em></p>
<p><em>С уважением, специалист отдела кадров [ФИО специалиста]</em></p>
</td>
</tr>
</tbody>
</table>
</div>
<p>В этом примере текст в квадратных скобках является переменной, вместо него будут подставлены данные с формы при заполнении: ФИО сотрудника, дата подписания, ФИО сотрудника кадрового отдела.</p>
<div class="blue_note"><strong>Примечание :</strong> Содержание шаблона может быть предварительно заполнено правилами для данных на форме или событием в процессе.</div>
<p><strong>2.</strong> В текущем шаблоне записи (в данном примере — «Отпуска») создайте текстовый атрибут «ФИО сотрудника» (системное имя «fiosotrudnika»).</p>
<p><strong>3.</strong> В текущем шаблоне записи (в данном примере — «Отпуска») создайте атрибут Дата / Время «Дата подписания» (системное имя «date»).</p>
<p><strong>4.</strong> В текущем шаблоне записи (в данном примере — «Отпуска») создайте текстовый атрибут «ФИО специалиста» (системное имя «managerfio»).</p>
<p><strong>5.</strong> В текущем шаблоне записи (в данном примере — «Отпуска») создайте текстовый атрибут «Текст письма», в котором будет содержаться итоговый текст для отправки. Сделайте этот атрибут вычисляемым и напишите выражение с помощью функции REPLACE:</p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code">
<p>REPLACE(</p>
<p>REPLACE(</p>
<p>REPLACE($template,"[<em>Срок</em>]", $date)",</p>
<p>"[<em>Сотрудник</em>]", $fiosotrudnika),</p>
<p>[<em>ФИО специалиста</em>]", $managerfio)</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Полученный результат можно использовать для отправки на почту сотруднику в рамках процесса оформления отпуска.</p>