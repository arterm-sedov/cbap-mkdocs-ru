---
title: Импорт данных в шаблон
kbId: 2555
---

# Импорт данных в шаблон

## Введение

Функция импорта данных предусмотрена для шаблонов записей, шаблонов аккаунтов, шаблонов оргединиц и шаблонов ролей.

Поддерживается импорт данных из файлов Excel и CSV.

## Порядок импорта данных

1. Откройте шаблон записи и выберите вкладку «**Импорт**».
2. Прикрепите файл XLSX или CSV в поле «**Файл с данными**».
3. Откроется форма настройки импорта данных.
4. Настройте параметры импорта данных.
    - **Кодировка** — выберите кодировку импортируемого файла.
    - **Разделитель столбцов**— выберите разделитель, используемый в импортируемом файле. Это поле отображается файлов формата CSV.
    - **Часовой пояс** — выберите часовой пояс загружаемых дат.
    - **Игнорировать ошибки парсинга** — установите этот флажок, чтобы загружать данные, даже если в процессе импорта возникли ошибки.
    - **Обновить существующие записи данными из файла**— установите этот флажок, чтобы обновить имеющиеся записи данными из соответствующих строк импортируемого файла и создать отсутствующие записи. Если этот флажок не установлен, для каждой строки в импортируемом файле будет создана новая запись.
        - **Столбец** — выберите ключевой столбец импортируемой таблицы. Ячейки в этом столбце должны содержать уникальные **текстовые** значения, совпадающие (с учётом регистра) со значениями ключевого атрибута в имеющихся записях. Имеющиеся записи будут обновлены импортированными данными из соответствующих строк. Для остальных строк будут созданы новые записи с импортированными данными.
        - **Ключевой атрибут** — выберите атрибут, по значениям которого импортируемые строки будут сопоставляться с имеющимися записями в шаблоне.
    - **Сопоставление данных** — настройте соответствие столбцов импортируемого файла атрибутам шаблона.
        - **Столбец** — заголовок столбца импортируемой таблицы.
        - **Атрибут** — выберите атрибут, в который требуется импортировать значения из столбца. Если оставить это поле пустым, то соответствующий столбец не будет импортирован.
        - **Формат** — выберите формат импортируемой ячейки в соответствии с типом атрибута. См. [требования к импортируемому файлу](#mcetoc_1hnnhtvne1).
            - Для атрибута типа «**Дата и время**» выберите пункт «**Не задано**» (автоматическое преобразование данных) или формат, соответствующий представлению данных в импортируемом файле.
            - Для атрибута типа «**Число**» или «**Длительность**» выберите формат, соответствующий представлению данных в импортируемом файле.
            - Для атрибута типа «**Запись**», «**Роль**» или «**Организационная единица**» выберите атрибут связанного шаблона **ID** или атрибут **Name** — это [атрибут-заголовок записей][attribute_displayed] связанного шаблона. Выбранный атрибут будет использоваться в качестве ключевого для привязки импортированных записей к связанному шаблону.
            - Для атрибута типа «**Аккаунт**» выберите атрибут шаблона аккаунта: **ID**, **Адрес эл. почты**, **Имя пользователя** или **Ф. И. О.** Выбранный атрибут будет использоваться в качестве ключевого для привязки импортированных записей к аккаунтам.
            - Для атрибутов остальных типов формат данных выбирать не требуется, данные будут преобразованы автоматически.
5. Нажмите кнопку «**Загрузить**».
6. В случае успешного импорта отобразится сообщение «**Данные импортированы**».

_![Настройка импорта данных из файла CSV](https://kb.comindware.ru/assets/img_65de03c80f5d9.png)_

## Подготовка импортируемого файла

Для корректного импорта данных в шаблон файл в формате XLSX следует подготовить, как указано ниже.

- Все импортируемые данные должны находиться на первом листе. Остальные листы при импорте будут пропущены.
- Первая строка листа должна содержать текстовые заголовки для всех столбцов.
- По возможности удалите столбцы, которые не требуется импортировать.
- Для импорта значений атрибута типа «**Число**» задайте формат ячеек «**Числовой**».
- Для импорта значений атрибута типа «**Дата и время**» задайте формат ячеек  «**Дата**» или «**Время**».
- Для импорта значений атрибута типа «**Длительность**» задайте формат ячеек «**Время**».
- Для импорта значений атрибута типа «**Логический**» задайте формат ячеек «**Общий**» или «**Текстовый**».
    - Ячейки должны содержать значения `ИСТИНА` или ЛОЖЬ (либо `TRUE` или `FALSE`). Пустое значение в ячейке будет преобразовано в значение `ложь`.
- Для импорта значений атрибута типа «**Запись**», «**Аккаунт**», «**Роль**» или «**Организационная единица**» задайте формат ячеек «**Общий**» или «**Текстовый**».
    - Эти ячейки должны содержать уникальные значения, совпадающие (с учётом регистра) со значениями ключевого атрибута в имеющихся записях из связанного шаблона.
    - По совпадающим значениям будет сформирована связь между импортируемыми записями и имеющимися записями в связанном шаблоне.
    - Для остальных импортированных строк в данном атрибуте будет установлено пустое значение.
    - Для привязки нескольких записей импортируемые ячейки должны содержать ключевые значения, разделённые точками с запятыми без пробелов.
- Для остальных ячеек задайте формат «**Общий**» или «**Текстовый**».

Примечание

Если в ячейке Excel находится формула, то будет импортировано результирующее значение, вычисленное по формуле, с учётом формата ячейки.

## Практический пример

Рассмотрим пример импорта заявлений на отпуск и решений по ним из файлов формата XLSX в два связанных между собой шаблона: *Заявления на отпуск* и *Решения по заявлениям на отпуск*. В примере воспользуемся функциями обновления имеющихся записей и установления связей между записями по ключевым атрибутам.

### Подготовка исходных данных

1. Создайте [аккаунты][accounts] с перечисленными ниже **Ф. И. О.**: *Иванов И. И., Кулагина А. Н., Филиппов К. В., Журавлёва Т. С., Игнатьев А. Б.*Остальные свойства аккаунтов заполните произвольными сведениями.
2. Создайте шаблон записи *«Заявления на отпуск»* с указанными ниже атрибутами.

| Название атрибута | Тип данных | Свойства атрибута |
| --- | --- | --- |
| *№ заявления* | Текст | **Использовать как заголовок записей:** флажок установлен **Контролировать уникальность значений:** флажок установлен |
| *Заявитель* | Аккаунт |  |
| *Дата начала* | Дата и время |  |
| *Длительность отпуска* | Число | **Количество знаков после запятой:** **0** |
3. Вынесите созданные атрибуты на *основную форму* и в таблицу «*Все записи*» шаблона *«Заявления на отпуск».*
4. Создайте шаблон записи *«Решения по заявлениям на отпуск»*   с указанными ниже атрибутами.

| Название атрибута | Тип данных | Свойства атрибута |
| --- | --- | --- |
| *Заявления* | Запись | **Связанный шаблон:** *Заявления на отпуск* **Хранить несколько значений:**флажок установлен |
| *Руководитель* | Аккаунт |  |
| *Решение* | Логический |  |
5. Вынесите созданные атрибуты на *основную форму* и в таблицу «*Все записи*» шаблона *«Решения по заявлениям на отпуск».*
6. Создайте файл `Заявления_на_отпуск.XLSX` и заполните его приведёнными ниже данными (можно скопировать и вставить таблицу).

| № заявления | Ф. И. О. заявителя | Дата заявления | Длительность |
| --- | --- | --- | --- |
| *1* | *Иванов И. И.* | 16.02.2024 | *5* |
| *2* | *Кулагина А. Н.* | 25.03.2024 | *20* |
| *3* | *Филиппов К. В.* | 01.08.2024 | *15* |
| *4* | *Журавлёва Т. С.* | 15.05.2024 | *30* |
7. Задайте формат ячеек в файле `Заявления_на_отпуск.XLSX`, как указано ниже.

| Столбец | Формат ячеек |
| --- | --- |
| № заявления | **Общий** |
| Ф. И. О. заявителя | **Текстовый** |
| Дата начала | **Дата** |
| Длительность | **ЧисловойЧисло десятичных знаков: 0** |
8. Создайте файл `Решения_по_заявлениям_на_отпуск.XLSX` и заполните его приведёнными ниже данными (можно скопировать и вставить таблицу).

| № заявления | Руководитель | Решение |
| --- | --- | --- |
| *1;2* | *Игнатьев А. Б.* | *ЛОЖЬ* |
| *3;4* | *Игнатьев А. Б.* | *TRUE* |
9. Задайте формат ячеек в файле `Решения_по_заявлениям_на_отпуск.XLSX`, как указано ниже.

| Столбец | Формат ячеек |
| --- | --- |
| № заявления | **Общий** |
| Руководитель | **Текстовый** |
| Решение | **Общий** |
10. Создайте в шаблоне записи *«Заявления на отпуск»* одну запись и заполните её поля следующими данными:

| Поле | Значение |
| --- | --- |
| № заявления | *1* |
| Заявитель | *Филиппов К. В.* |
| Дата начала | *25.03.2024* |
| Длительность отпуска | *30* |

### Импорт данных в шаблоны

1. Откройте шаблон *«Заявления на отпуск»* и выберите вкладку «**Импорт**».
2. В поле «**Файл с данными**» выберите файл *Заявления\_на\_отпуск.XLSX.*
3. Установите флажок «**Обновить существующие записи данными из файла**» и настройте обновление:
    - **Столбец:***№ заявления*
    - **Ключевой атрибут:***№ заявления*
4. Настройте **сопоставление данных** следующим образом:

| Столбец | Атрибут | Формат |
| --- | --- | --- |
| *№ заявления* | *№ заявления* |  |
| *Дата начала* | *Дата начала* | **Не задано** |
| *Длительность* | *Длительность отпуска* | **Целое число** |
| *Ф. И. О. заявителя* | *Заявитель* | **Ф. И. О.** |
5. Нажмите кнопку «**Загрузить**».

_![Настройка импорта данных в шаблон «Заявления на отпуск»](https://kb.comindware.ru/assets/img_65e048fd831f9.png)_
6. Перейдите на вкладку «**Свойства**» шаблона *«Заявления на отпуск»* и нажмите кнопку «**Перейти к экземплярам**»
7. Отобразится список всех заявлений на отпуск.
8. Заявление № 1 должно быть обновлено и должны появиться три новых заявления в соответствии с импортированными данными.

  _![](https://kb.comindware.ru/assets/img_65e04dee07c09.png)_ Импортированные заявления на отпуск
9. Откройте шаблон *«Решения по заявлениям на отпуск»* и выберите вкладку «**Импорт**».
10. В поле «**Файл с данными**» выберите файл *Заявления\_на\_отпуск.XLSX.*
11. Настройте **сопоставление данных** следующим образом:

| Столбец | Атрибут | Формат |
| --- | --- | --- |
| *№ заявления* | *Заявления* | **Name** |
| *Решение* | *Решение* |  |
| **Руководитель** | **Дата начала** | **Ф. И. О.** |
12. Нажмите кнопку «**Загрузить**».

_![Настройка импорта данных в шаблон «Решения по заявлениям на отпуск»](https://kb.comindware.ru/assets/img_65e053cb83ffd.png)_
13. Перейдите на вкладку «**Свойства**» шаблона *«Решения по заявлениям на отпуск»* и нажмите кнопку «**Перейти к экземплярам**»
14. Отобразится список всех решений по заявлениям.
15. В списке должно быть два решения, каждое по двум заявлениям на отпуск.
16. Перейдите на вкладку «Свойства» шаблона *«Заявления на отпуск»*   и нажмите кнопку «Перейти к экземплярам»
17. Отобразится два решения, каждое по двум заявлениям на отпуск.

_![](https://kb.comindware.ru/assets/img_65e050a379460.png)_Импортированные решения по заявлениям на отпуск

--8<-- "related_topics_heading.md"

**[Шаблоны. Определения, создание, настройка, перенос между приложениями, архивирование, очистка, удаление][templates]**

**[Атрибут-заголовок записей шаблона][attribute_displayed]**

**[Аккаунты. Создание, настройка, замещение, привязка к шаблону аккаунта, назначение лицензий, удаление][accounts]**



 

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
