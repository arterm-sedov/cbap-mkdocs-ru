---
title: Фильтр записей в коллекции по заданному параметру
kbId: 1907
---

# Фильтр записей в коллекции по заданному параметру

В этой статье будет описано как с помощью языка запросов N3 можно фильтровать данные в коллекции по какому-либо параметру, определённому в текущей записи.

Для начала рассмотрим модель данных:

- Шаблон записи (в нашем примере «Organizatsii»), хранящий мастер-данные, со следующими атрибутами:
    1. Атрибут (в нашем примере «Filtrpooblasti» с типом данных «Текст»), в котором будет определен параметр для поиска записей в коллекции;
    2. Атрибут с типом данных «Коллекция» (в нашем примере «Adresaofisov\_col»), коллекция, записи в которой будут фильтроваться.
- Шаблон записи (в нашем примере «Adresa»), хранящий записи в коллекции, со следующими атрибутами:
    1. Атрибут (в нашем примере «Oblast» с типом данных «Текст»), по которому будет осуществляться фильтрация.

Далее, на конструкторе формы кликните на коллекцию и вставьте следующее выражение в «Фильтры записей: Для отображения»:

| @prefix object: <http://comindware.com/ontology/object#>. {    ("Adresa" "Oblast") object:findProperty ?PropertyOblast.    ("Organizatsii" "Adresaofisov\_col") object:findProperty ?PropertyAdresaofisov\_col.    ("Organizatsii" "Filtrpooblasti") object:findProperty ?PropertyOblastFilter.      ?item ?PropertyOblastFilter ?filter.    ?item ?PropertyAdresaofisov\_col ?result\_A.    ?result\_A ?PropertyOblast ?filter.    ?result\_A -> ?value. } |
| --- |

Теперь разберём выражение на N3 построчно:

- ***@prefix object: <http://comindware.com/ontology/object#>*** — в первой строке подключаем библиотеку «object» для того, чтобы в последующем можно было использовать её свойство «findProperty».
- ***("Adresa" "Oblast") object:findProperty ?PropertyOblast.*** — в строках 3-5 определяем переменные-предикаты, через которые будем получать значения атрибутов. Сначала указываем системное имя шаблона записи, затем системное имя атрибута, значение которого хотим получить: (***"Adresa" "Oblast"***). Затем используем свойство библиотеки «object:findProperty», чтобы получить ID атрибута в какую-либо переменную, например, «PropertyOblast» (названия переменных задаются произвольно).
- ***?item ?PropertyOblastFilter ?filter.*** — в 7-ой строке происходит следующее: из текущей записи («item») по свойству «PropertyOblastFilter» получаем значение в переменную «filter» (название переменной также задаём произвольно).

**Примечание :** в языке запросов N3 присутствуют зарезервированные переменные: «item» и «value». «item» — содержит в себе ID записи, в рамках которой отрабатывает выражение (изначальный контекст). «value» — используется для вывода результата тройки.

- ***?item ?PropertyAdresaofisov\_col ?result\_A.*** — аналогичное действие происходит и в 8-ой строке: из текущей записи получаем значение атрибута «Adresaofisov\_col» в переменную «result\_A». Так как этот атрибут является коллекцией, то в «result\_A» у нас будет содержаться список записей в коллекции.
- ***?result\_A ?PropertyOblast ?filter.*** — в 9-ой строке для всего списка записей «result\_A» мы получаем значения по свойству «PropertyOblast». Справа у нас уже определено значение («filter»), поэтому в списке останутся только те записи, у которых значение атрибута «Oblast» совпадает со значением в атрибуте «Filtrpooblasti».
- ***?result\_A -> ?value.*** — в 10-ой строке выводим результат в «value», после чего можем наблюдать отфильтрованную коллекцию.

_![Пример фильтрации записей в коллекции](https://kb.comindware.ru/assets/N3_11.PNG)_

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
