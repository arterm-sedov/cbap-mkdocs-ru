<h1>Удаление связанного объекта при выполнении условия</h1><p><span style="color: #545764; font-family: 'Open Sans', sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">Для того, чтобы можно было в процессе удалять связанный объект/ы при определенном условии (в данной статье рассмотрено условие, если значение в атрибуте с типом данных «Число» в связанном объекте/ах равно нулю), введите следующее выражение:</span></p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code">
<p>using System; <br/>using System.Collections.Generic;<br/>using System.Linq;<br/>using Comindware.Data.Entity;<br/>using Comindware.TeamNetwork.Api.Data.UserCommands;<br/>using Comindware.TeamNetwork.Api.Data;</p>
<p>class Script<br/>{<br/>    public static void Main(Comindware.Process.Api.Data.ScriptContext context, Comindware.Entities entities)<br/>    { <br/>try<br/>{<br/>var id = context.BusinessObjectId;<br/>var data = Api.TeamNetwork.ObjectService.GetPropertyValues(new []{id}, new[]{"Link"});<br/>var deletearray = data[id]["Link"] as object[];</p>
<p>foreach(var i in deletearray)<br/>{<br/>try<br/>{<br/>var atr = Api.TeamNetwork.ObjectService.GetPropertyValues(new []{i.ToString()}, new[]{"Qty "});<br/>var val = atr[i.ToString()]["Qty "];</p>
<p>if(int.Parse(val.ToString()) == 0)<br/>{<br/>Api.TeamNetwork.ObjectService.Delete(i.ToString());<br/>} <br/>}<br/>catch{}<br/>}<br/>}<br/>catch<br/>{}<br/>    }<br/>}</p>
</td>
</tr>
</tbody>
</table>
</div>
<p><strong><span style="color: #545764; font-family: 'Open Sans', sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;">где:</span></strong></p>
<p><span style="color: #545764; font-family: 'Open Sans', sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;"><em><strong>Link</strong> </em>— системное имя атрибута с типом данных «Запись» в текущем шаблоне записи;</span></p>
<p><span style="color: #545764; font-family: 'Open Sans', sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;"><em><strong>Qty</strong> </em>— системное имя атрибута с типом данных «Число» в связанном шаблоне записи.</span></p>