<h1>Загрузка картинки из атрибута типа документ в HTML поле</h1><p>Для того, чтобы выгрузить картинку в HTML поле, введите следующее выражение:</p>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code"> 
<p>using System; <br/>using System.Collections.Generic; <br/>using System.Linq; <br/>using System.Text.RegularExpressions; <br/>using Comindware.Data.Entity; <br/>using Comindware.TeamNetwork.Api.Data.UserCommands; <br/>using Comindware.TeamNetwork.Api.Data;</p>
<p>class Script <br/>{ <br/>    public static UserCommandResult Main(UserCommandContext userCommandContext, Comindware.Entities entities) <br/>    { <br/>        var imagePropertyAlias = "Document"; <br/>        var currentObjectid = userCommandContext.ObjectIds[0]; <br/>        var response = Api.TeamNetwork.ObjectService.GetPropertyValues(new List&lt;string&gt; { currentObjectid }, new List&lt;string&gt; { imagePropertyAlias }); <br/>        Dictionary&lt;string, object&gt; currentObjectPropertyValues; <br/>        response.TryGetValue(currentObjectid, out currentObjectPropertyValues); <br/>        object multivalueDocument; <br/>        currentObjectPropertyValues.TryGetValue(imagePropertyAlias, out multivalueDocument); <br/>        var documentsList = (object[])multivalueDocument; <br/>        var documentId = documentsList.First(); <br/>        var content = (Api.TeamNetwork.DocumentService.GetContent((string)documentId)).Data;</p>
<p>        var docHTML = $"&lt;p&gt;&lt;span style=\"font-size:11pt;\"&gt;&lt;span&gt;&lt;span style=\"font-family:Calibri,sans-serif;\"&gt;&lt;img src=\"data:image/png;base64,{Convert.ToBase64String(content)}\" style=\"height:500px; width:1000px\" /&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;";</p>
<p>        var data = new Dictionary&lt;string, object&gt; <br/>        { <br/>          { "HTML", docHTML} <br/>        }; <br/>        Api.TeamNetwork.ObjectService.EditWithAlias("ExportImport", currentObjectid, data);</p>
<p>        var result = new UserCommandResult <br/>        { <br/>            Success = true, <br/>            Commited = true, <br/>            ResultType = UserCommandResultType.DataChange, <br/>            Messages = new[] <br/>            { <br/>                new UserCommandMessage <br/>                { <br/>                    Severity = SeverityLevel.Normal, <br/>                    Text = "Картинка загружена!" <br/>                } <br/>            } <br/>        }; <br/>        return result; <br/>    } <br/>}</p>
</td>
</tr>
</tbody>
</table>
<div>
<p style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: 100; margin-top: 0px; margin-bottom: 1rem; color: #333333; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: 100; text-decoration: underline; font-size: 12pt;"><strong style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: bolder;">где: </strong> </span></p>
<p style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: 100; margin-top: 0px; margin-bottom: 1rem; color: #333333; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: 100; font-size: 12pt;"> <strong> Document </strong>  = Атрибут типа документ, куда загружается картинка </span></p>
<p style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: 100; margin-top: 0px; margin-bottom: 1rem; color: #333333; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-style: initial; text-decoration-color: initial;"><span style="box-sizing: border-box; font-family: 'Open Sans', sans-serif; font-weight: 100; font-size: 12pt;"> <strong> HTML </strong> = Атрибут типа текст в HTML формате </span></p>
</div>