---
title: 'Пример настройки и использования шаблона экспорта авансового отчёта'
kbId: 4795
url: 'https://kb.comindware.ru/article.php?id=4795'
updated: '2024-10-16 17:40:01'
---

# Пример настройки и использования шаблона экспорта авансового отчёта

## Порядок настройки

1. Создайте три **[шаблона записи](https://kb.comindware.ru/article.php?id=4759)**:

   - *Заявки*
   - *Затраты*
   - *Тип затрат*
2. В шаблоне *«Заявки»* создайте атрибуты:

   - *Номер заявки*
     - **Системное имя**: `Nomerzayavki`
     - **Тип данных**: **текст**
   - *Время подачи*
     - **Системное имя**: `Datapodachi`
     - **Тип данных**: **дата и время**
   - *Затраты*
     - **Системное имя**: `Zatraty`
     - **Тип данных**: **запись**
     - **Связанный шаблон**: *Затраты*
     - **Хранить несколько значений**: флажок установлен
   - *Итоговая сумма затрат*
     - **Системное имя**: `Itogovayasummazatrat`
     - **Тип данных**: **число**
3. В шаблоне *«Затраты»* создайте атрибуты:

   - *Тип затрат*
     - **Системное имя**: `Tipzatrat`
     - **Тип данных**: **запись**
     - **Связанный шаблон**: *Тип затрат*
   - *Сумма*
     - **Системное имя**: `Summa`
     - **Тип данных**: **число**
4. В шаблоне *«Тип затрат»* создайте атрибуты:

   - *Название*
     - **Системное имя**: `Nazvanie`
     - **Тип данных**: **текст**
5. Вынесите созданные атрибуты на формы в шаблонах.
6. Создайте несколько наглядных записей:

   - справочник типов затрат;
   - затраты с указанием их типа;
   - заявки с указанием затрат.
7. Создайте файл шаблона экспорта `advance_report.xlsx`, показанный на иллюстрации:

   ![Файл шаблона экспорта «Авансовый отчёт»](https://kb.comindware.ru/assets/export_template_file_example_advance_report.png)

   Файл шаблона экспорта «Авансовый отчёт»
8. Создайте в шаблоне записи «*Заявки*» [шаблон экспорта](https://kb.comindware.ru/article.php?id=4797) «*Авансовый отчёт*» с файлом `advance_report.xslx`.
9. Вместе с шаблоном экспорта будет автоматически создана [кнопка экспорта записи](https://kb.comindware.ru/article.php?id=4798) «*Авансовый отчёт*».
10. Вынесите кнопку «*Авансовый отчёт*» на форму шаблона записи «*Заявки*».
11. Откройте любую запись шаблона «*Заявки*».
12. Нажмите кнопку «*Авансовый отчёт*».
13. Браузер скачает файл следующего вида (с именем, заданным в [свойствах шаблона экспорта](https://kb.comindware.ru/article.php?id=4797)):

    ![Файл, сформированный по шаблону экспорта](https://kb.comindware.ru/assets/export_template_file_result.png)

    Файл, сформированный по шаблону экспорта

## Связанные статьи

**[Настройка шаблона экспорта с использованием C#](https://kb.comindware.ru/article.php?id=4793)**

**[Настройка выгрузки нескольких коллекций и изображений](https://kb.comindware.ru/article.php?id=4792)**

**[Настройка шаблона экспорта](https://kb.comindware.ru/article.php?id=4797)**

**[Подготовка файла шаблона экспорта](https://kb.comindware.ru/article.php?id=4796)**

**[Настройка кнопки экспорта](https://kb.comindware.ru/article.php?id=4798)**