---
title: 'Сценарии. Определения, создание, настройка, использование'
kbId: 4717
url: 'https://kb.comindware.ru/article.php?id=4717'
updated: '2024-10-02 17:56:04'
---

# Сценарии. Определения, создание, настройка, использование

## Определения

**Сценарий** представляет собой алгоритм автоматизации операций, проверки, обработки и передачи данных, который запускается при наступлении заданного [**события**](https://kb.comindware.ru/article.php?id=4718#scenario_event) и выполняет настроенную последовательность [**действий**](https://kb.comindware.ru/article.php?id=4718#scenario_actions).

Помимо обработки данных внутри **Comindware Platform** сценарии позволяют обмениваться данными с внешними системами.

Сценарии дополняют бизнес-процессы, однако не являются их альтернативой, так как не позволяют реализовать логику BPMN. Сценарии можно использовать как таковые в тех случаях, когда не требуется создавать бизнес-процесс.

Сценарий составляется из блоков с помощью [визуального конструктора](#настройка-элемента-сценария).

См. [*«Событие и действия сценария. Определения, типы, свойства, настройка»*](https://kb.comindware.ru/article.php?id=4718) и [*«Использование переменных в сценарии»*](https://kb.comindware.ru/article.php?id=4719).

## Особенности работы сценариев

Сценарии являются инструментом автоматизации в приложениях.

Они имеют ряд особенностей:

- Сценарий выполняется один раз при каждом наступлении заданного события.
- Сценарий выполняется в контексте определённого шаблона записи. При этом [действия](https://kb.comindware.ru/article.php?id=4718#scenario_actions) «**Сменить контекст**», «**Создать запись**», «**Дублировать запись**» позволяют переключаться между шаблонами и манипулировать данными в них.
- При запуске для нескольких записей (например, выбранных в таблице) сценарий выполняется отдельно по каждой записи. То есть в контексте сценария доступна только одна запись, по которой он запущен.
- Если при выполнении действия сценария происходит ошибка и в [свойствах этого действия](https://kb.comindware.ru/article.php?id=4718#scenario_actions_common_properties) не установлен флажок «**Игнорировать все ошибки**», то его действия отменяются полностью, как если бы сценарий не запускался вообще. Если ошибка сценария произошла в процессе, то процесс будет остановлен.

## Примеры использования сценариев

Сценарии позволяют решать различные задачи, например:

- Изменение данных без учёта роли и разрешений текущего пользователя:
  - [Выполнение сценария от имени системы](#scenario_context)
- Использование электронной подписи и подготовка документов по образцу
  - *[Обработка документов с электронной подписью](https://kb.comindware.ru/article.php?id=4910)*
  - *[Экспорт документов по шаблонам](https://kb.comindware.ru/article.php?id=4797)*
- Настройка бизнес-процессов
  - *[Визуализация этапов процесса с помощью шевронов](https://kb.comindware.ru/article.php?id=4915)*
  - *[Настройка универсального процесса согласования](https://kb.comindware.ru/article.php?id=4904)*
- Обмен данными с внешними системами
  - *[Отправка SQL-запроса SELECT во внешнюю СУБД](https://kb.comindware.ru/article.php?id=4706)*
  - *[Получение данных по таймеру из внешней СУБД](https://kb.comindware.ru/article.php?id=4705)*
  - *[Получение сообщений через Kafka](https://kb.comindware.ru/article.php?id=4704)*
- Получение и отправка HTTP-запросов
  - *[Отправка уведомлений с помощью Telegram-бота](https://kb.comindware.ru/article.php?id=4926)*
  - *[Отправка HTTP-запросов типа GET и обработка запросов в формате JSON](https://kb.comindware.ru/article.php?id=4699)*
- Получение и отправка электронной почты
  - *[Отправка эл. почты из сценариев через SMTP и Exchange](https://kb.comindware.ru/article.php?id=4692)*
  - *[Получение эл. почты из сценариев через SMTP и Exchange](https://kb.comindware.ru/article.php?id=4693)*
  - *[Согласование заявлений по эл. почте](https://kb.comindware.ru/article.php?id=4691)*
- Принудительная остановка бизнес-процессов и запрет на внесение изменений в записи
  - *[Проверка результата выражения в сценарии](https://kb.comindware.ru/article.php?id=4718#scenario_actions_validate_expression)*
  - *[Проверка результата скрипта в сценарии](https://kb.comindware.ru/article.php?id=4718#scenario_actions_validate_csharp)*
- Создание, дублирование и изменение записей
  - *[Копирование записи вместе с прикреплённым документом](https://kb.comindware.ru/article.php?id=4883)*

## Использование списка сценариев и создание сценария

1. Откройте страницу [«**Администрирование**» — «**Сценарии**»](https://kb.comindware.ru/article.php?id=4661).
2. Отобразится список сценариев.
3. Выполните требуемые действия со сценариями:

   - **Создать** — чтобы [настроить свойства](#настройка-свойств-сценария) нового сценария и перейти к настройке [его события и действий](#настройка-события-и-действий-сценария), нажмите кнопку «**Создать**».
   - **Настроить свойства** — выберите сценарий с помощью флажка и нажмите кнопку «**Свойства**», чтобы [настроить его свойства](#настройка-свойств-сценария).
   - **Открыть** — дважды нажмите строку сценария, чтобы настроить [его событие и действия](#настройка-события-и-действий-сценария).
   - **Удалить** — установите флажки выбора для сценариев, нажмите кнопку «**Удалить**» и подтвердите удаление.

_![Список сценариев в приложении](https://kb.comindware.ru/assets/scenarios_list.png)_

## Настройка свойств сценария

1. Откройте список сценариев.
2. Нажмите кнопку «**Создать**». Либо выберите или откройте сценарий и нажмите кнопку «**Свойства**».
3. Настройте и сохраните свойства сценария:

   - **Название** — наглядное наименование сценария.
   - **Системное имя** — уникальное имя. Не должно начинаться с цифры. Рекомендуется использовать буквы латинского алфавита, цифры и символ «\_». Заполняется автоматически по названию.

   Примечание

   Для сценариев на входе и выходе из элементов диаграммы процесса название и системное имя сценария формируются автоматически.

   - **Контекст выполнения** — аккаунт, от имени которого должен выполняться сценарий:
     - **От имени системы** — сценарий будет выполняться с полными правами аккаунта «**Система**», без учёта роли и разрешений пользователя, инициировавшего событие, по которому запускается сценарий. То есть сценарий сможет выполнять *любые действия*.
     - **От инициатора** — сценарий будет выполняться при наличии необходимых разрешений у пользователя, инициировавшего событие, по которому выполняется сценарий. В случае отсутствия у пользователя разрешений система выдаст ошибку.
   - **Статус**:
     - **Активен** — сценарий будет выполняться при каждом наступлении заданного события.
     - **Приостановлен** — сценарий не будет выполняться при наступлении заданного события.
4. Если вы создали сценарий, откроется его конструктор. [Настройте событие и действия сценария](#настройка-события-и-действий-сценария).

_![Настройка свойств нового сценария](https://kb.comindware.ru/assets/scenario_create_properties.png)_

## Настройка события и действий сценария

Для настройки сценария предусмотрен удобный визуальный конструктор.

Перейти к конструктору сценария можно двумя способами:

- Дважды нажмите строку сценария в [списке сценариев](#использование-списка-сценариев-и-создание-сценария).
- Нажмите кнопку «**Сценарий на входе**» *‌* или «**Сценарий на выходе**» *‌* в меню элемента [диаграммы бизнес-процесса](https://kb.comindware.ru/article.php?id=4721).

_![Кнопки создания сценария на входе и выходе из элемента диаграммы процесса](https://kb.comindware.ru/assets/scenario_exit_enter_process_element.png)_

В конструкторе сценария предусмотрены следующие кнопки:

- **Свойства** — настройка [свойств сценария](#настройка-свойств-сценария).
- **Очистить** — безвозвратное удаление всех элементов сценария. После нажатия этой кнопки в сценарий будет помещено пустое начальное событие «**Нажатие кнопки**», как если бы сценарий был создан заново. Требуется подтверждение.
- **Удалить** — удаление сценария. Требуется подтверждение.
- **Проверить** — проверка целостности и работоспособности сценария. При нажатии этой кнопки отобразится панель «**Результат проверки**» с перечнем выявленных ошибок в сценарии. Элементы сценария с ошибкой будут выделены красным цветом.

_![Конструктор сценария](https://kb.comindware.ru/assets/scenario_designer.png)_

## Настройка элемента сценария

Внимание!

При настройке сценария изменения сохраняются и применяются автоматически.

1. Наведите указателя мыши на элемент сценария или выберите его.
2. Отобразятся кнопки настройки:

- **Название элемента сценария** — нажмите, чтобы перейти к настройке свойств элемента.
- **Изменить** — нажмите *‌*, чтобы перейти к настройке свойств элемента.
- **Перейти к контекстному шаблону** — нажмите кнопку *‌*, чтобы перейти к [шаблону](https://kb.comindware.ru/article.php?id=4709), в контексте которого выполняется элемент сценария.
- **Удалить** — нажмите кнопку *‌*, чтобы безвозвратно [удалить действие сценария](#удаление-действия). Подтвердите удаление.
- **Добавить действие** — нажмите кнопку *‌*, чтобы [создать действия](#создание-действия) после текущего элемента или внутри него.

_![Кнопки настройки элемента сценария](https://kb.comindware.ru/assets/scenario_element_buttons.png)_

### Создание действия

Примечание

Внутрь действий «**Создать запись**», «**Дублировать запись**», «**Сменить контекст**», «**Выполнить по условиям**», «**Повторять по числовому счётчику**», «**Повторять по количеству объектов**» можно поместить другие действия.

1. Наведите указатель мыши на элемент сценария, после или внутрь которого требуется добавить действие.
2. Нажмите кнопку «**Добавить действие**» *‌*.
3. Выберите необходимое действие в раскрывающемся меню.
4. В конструкторе сценария появится новое действие.
5. [Настройте действие](#настройка-элемента-сценария).

   ![Создание действия в сценарии](https://kb.comindware.ru/assets/scenario_create_action.png)

   Создание действия в сценарии

### Удаление действия

1. Наведите указатель мыши на подлежащее удалению действие.
2. Нажмите кнопку «**Удалить**» *‌*.
3. Подтвердите удаление.

_![Удаление действия из сценария](https://kb.comindware.ru/assets/scenario_delete_action.png)_

## Связанные статьи

**[Событие и действия сценария. Определения, типы, свойства, настройка](https://kb.comindware.ru/article.php?id=4718)**

**[Использование переменных в сценарии](https://kb.comindware.ru/article.php?id=4719)**