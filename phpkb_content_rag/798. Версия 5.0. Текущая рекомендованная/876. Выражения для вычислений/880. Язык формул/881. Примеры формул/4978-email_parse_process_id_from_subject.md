---
title: 'Эл. почта. Парсинг темы. Извлечение идентификатора процесса'
kbId: 4978
url: 'https://kb.comindware.ru/article.php?id=4978'
updated: '2025-10-03 13:02:32'
---

# Эл. почта. Парсинг темы. Извлечение идентификатора процесса

Здесь приведён пример извлечения идентификатора процесса из темы эл. письма с помощью **формулы**.

Это позволяет определить, какой процесс должен обработать письмо в таких сценариях, как:

- **маршрутизация** — направление писем в соответствующие экземпляры процессов;
- **обработка заявок** — привязка ответов к заявлениям по их номерам.

## Синтаксис формулы

Для извлечения ID процесса из темы письма используйте следующую формулу:

```
SUBSTRING(
    $Тема,
    INDEXOF($Тема,"[") + 1,
    INDEXOF($Тема,"]") - INDEXOF($Тема,"[") - 1)

```

Формула извлекает текст между квадратными скобками.

Если тема письма содержит `"Ответ по заявлению [12345] - одобрено"`, формула вернёт `12345`.

Важно: перед применением формулы убедитесь, что тема содержит символы `[` и `]`; при их отсутствии обработайте ситуацию безопасно (например, верните пустое значение).

Здесь:

- `$Тема` — атрибут, который хранит тему полученного письма;
- `SUBSTRING()` — функция, извлекающая из строки подстроку с найденной позиции и указанной длины;
- `INDEXOF()` — функция, возвращающая позицию символа в строке:
  - `INDEXOF($Tema,"[")` — находит позицию открывающей квадратной скобки `[`;
  - `INDEXOF($Tema,"]")` — находит позицию закрывающей квадратной скобки `]`;
  - `INDEXOF($Tema,"[") + 1` — позиция начала ID (сразу после `[`);
  - `INDEXOF($Tema,"]") - INDEXOF($Tema,"[") - 1` — длина ID (между скобками).

## Связанные статьи

- [Парсинг Email до знака @](https://kb.comindware.ru/article.php?id=4983)
- [Эл. почта в процессе. Отправка, получение и обработка](https://kb.comindware.ru/article.php?id=4691)
- [Получение эл. почты и веб-запросов в процессе](https://kb.comindware.ru/article.php?id=4695)
- [Список функций языка формул Comindware](https://kb.comindware.ru/article.php?id=4993)
- [Сценарии](https://kb.comindware.ru/article.php?id=4717)