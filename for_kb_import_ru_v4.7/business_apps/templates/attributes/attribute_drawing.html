<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr"> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <nav aria-label="Содержание" class="md-nav md-nav--secondary"> <div class="mce-toc"> <h2 class="toc-heading"> Содержание </h2> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link mkdocs_imported_link" href="#введение"> <span class="md-ellipsis"> Введение </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link mkdocs_imported_link" href="#прикладная-задача"> <span class="md-ellipsis"> Прикладная задача </span> </a> <nav aria-label="Прикладная задача" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link mkdocs_imported_link" href="#исходные-данные"> <span class="md-ellipsis"> Исходные данные </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link mkdocs_imported_link" href="#настройка-шаблонов-и-атрибутов"> <span class="md-ellipsis"> Настройка шаблонов и атрибутов </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link mkdocs_imported_link" href="#настройка-форм-и-полей"> <span class="md-ellipsis"> Настройка форм и полей </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи"> <span class="md-ellipsis"> Связанные статьи </span> </a> </li> </ul> </div> </nav> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset">  <h2 id="введение">Введение</h2> <p>На форме можно разместить чертёж, на котором будут отображаться данные из шаблонов записей с привязкой к объектам на чертеже.</p> <p>Для использования чертежа в <strong>Comindware Business Application Platform</strong> потребуется подготовить файл DWG, создать несколько шаблонов и атрибутов определённых типов, поместить поле атрибута типа «<strong>Чертёж</strong>» на форму и привязать его к шаблонам записей и атрибутам. Конечный пользователь, в свою очередь, должен импортировать файл чертежа в формате DWG и привязать конкретные слои полигонов и маркеров на чертеже к шаблонам и атрибутам, заданным при настройке поля.</p> <p>См. также <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=2574">Чертёж. Подготовка и импорт файла DWG</a>»</em> и <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=2531#form_dynamic_elements_drawing">Атрибут типа «Чертёж». Настройка шаблонов, атрибутов, форм и полей</a>»</em>.</p> <h2 id="прикладная-задача">Прикладная задача</h2> <p>Имеется план этажа с полигонами помещений и рабочих мест. Требуется настроить отображение на форме плана этажа с обозначением помещений и рабочих мест. Необходимо обеспечить возможность оформления и просмотра заявок на обслуживание помещений и рабочих мест на плане. Заявки должны быть представлены на плане в виде цветных маркеров. Цвета помещений и заявок должны соответствовать их статусу, а цвета рабочих мест — их состоянию.</p> <p>Настроим приложение для работы с планом этажа:</p> <ul> <li>настроим шаблоны, формы и атрибуты для хранения данных помещений, рабочих мест и заявок;</li> <li>создадим и заполним записи помещений и рабочих мест в соответствии с чертежом;</li> <li>импортируем файл чертежа в приложение;</li> <li>на полученном плане создадим несколько заявок.</li> </ul> <h3 id="исходные-данные">Исходные данные</h3> <p>Имеется подготовленный чертёж в формате DWG с четырьмя слоями. Для корректного импорта чертёж необходимо подготовить в соответствии с требованиями, приведёнными в статье <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=2574">Чертёж. Подготовка и импорт файла DWG</a>»</em>.</p> <p>Свойства исходного чертежа:</p> <ul> <li> <p><em>Помещения</em> — полигоны помещений:</p> <ul> <li><em>Диспетчерская</em></li> <li><em>Переговорная</em></li> <li><em>Кабинет руководителя</em></li> <li><em>Отдел продаж</em></li> </ul> </li> <li> <p><em>ID помещений</em> — текстовые блоки с идентификаторами полигонов помещений:</p> <ul> <li><em>Диспетчерская</em></li> <li><em>Переговорная</em></li> <li><em>Кабинет руководителя</em></li> <li><em>Отдел продаж</em></li> </ul> </li> <li> <p><em>Рабочие места</em> — полигоны рабочих мест:</p> <ul> <li><em>Диспетчер 1</em></li> <li><em>Диспетчер 2</em></li> <li><em>Диспетчер 3</em></li> <li><em>Стол для переговоров</em></li> <li><em>Рабочее место руководителя 1</em></li> <li><em>Специалист по продажам 1</em></li> <li><em>Специалист по продажам 2</em></li> <li><em>Специалист по продажам 3</em></li> </ul> </li> <li> <p><em>ID рабочих мест</em> — текстовые блоки с идентификаторами полигонов рабочих мест:</p> <ul> <li><em>Диспетчер 1</em></li> <li><em>Диспетчер 2</em></li> <li><em>Диспетчер 3</em></li> <li><em>Стол для переговоров</em></li> <li><em>Рабочее место руководителя 1</em></li> <li><em>Специалист по продажам 1</em></li> <li><em>Специалист по продажам 2</em></li> <li><em>Специалист по продажам 3</em></li> </ul> </li> </ul> <h2 id="настройка-шаблонов-и-атрибутов">Настройка шаблонов и атрибутов</h2> <p>Для настройки и использования чертежа на форме создайте перечисленные ниже шаблоны записей и атрибуты.</p> <p>Шаблоны и атрибуты необходимо будет привязать к объектам в файле DWG во время настройки поля атрибута типа «<strong>Чертёж</strong>» и при импорте файла DWG конечным пользователем.</p> <ol class="colored_numbers_list"> <li>Создайте три шаблона записей: <em>Этажи, Помещения, Рабочие места, Заявки</em>.</li> <li>Настройте в шаблонах атрибуты, как указано в следующей таблице.</li> </ol> <table style="width: 100%;"> <tbody> <tr> <th colspan="3"> <p><strong>Атрибуты шаблона «<em>Этажи»</em></strong></p> </th> </tr> <tr> <th> <p><strong>Тип данных</strong></p> </th> <th> <p><strong>Название</strong></p> </th> <th> <p><strong>Свойства</strong></p> </th> </tr> <tr> <td> <p><em>Текст</em></p> </td> <td> <p><em>Наименование</em></p> </td> <td> <p>По умолчанию</p> </td> </tr> <tr> <td> <p><em>Чертёж</em></p> </td> <td> <p><em>План</em></p> </td> <td> <p>По умолчанию</p> </td> </tr> <tr> <th colspan="3"> <p><strong>Атрибуты шаблона «<em>Помещения»</em></strong></p> </th> </tr> <tr> <th> <p><strong>Тип данных</strong></p> </th> <th> <p><strong>Название</strong></p> </th> <th> <p><strong>Свойства</strong></p> </th> </tr> <tr> <td> <p><em>Текст</em></p> </td> <td> <p><em>ID помещения</em></p> </td> <td> <p>Установлены флажки:</p> <ul> <li><strong>Использовать как заголовок записей</strong></li> <li><strong>Контролировать уникальность значений</strong></li> </ul> </td> </tr> <tr> <td> <p>_Запись _</p> </td> <td> <p><em>Этаж</em></p> </td> <td> <ul> <li><strong>Связанный шаблон</strong>: <em>Этажи</em></li> <li><strong>Хранить несколько значений</strong>: флажок снят</li> <li><strong>Взаимная связь с атрибутом:</strong><ul> <li><strong>С новым</strong></li> <li><strong>Название</strong>: <em>Помещения</em></li> <li><strong>Хранить несколько значений</strong>: флажок установлен</li> </ul> </li> </ul> </td> </tr> <tr> <td> <p><em>Список значений</em></p> </td> <td> <p><em>Статус</em></p> </td> <td> <p><strong>Список значений:</strong></p> <ul> <li><em>Эксплуатируется</em></li> <li><em>Не эксплуатируется</em></li> </ul> </td> </tr> <tr> <td> <p><em>Список значений</em></p> </td> <td> <p><em>Вид</em></p> </td> <td> <p><strong>Список значений:</strong></p> <ul> <li><em>Складское</em></li> <li><em>Санитарное</em></li> <li><em>Общее</em></li> <li><em>Техническое</em></li> <li><em>Офисное</em></li> <li><em>Административное</em></li> </ul> </td> </tr> <tr> <th colspan="3"> <p><strong>Атрибуты шаблона «<em>Рабочие места»</em></strong></p> </th> </tr> <tr> <th> <p><strong>Тип данных</strong></p> </th> <th> <p><strong>Название</strong></p> </th> <th> <p><strong>Свойства</strong></p> </th> </tr> <tr> <td> <p><em>Текст</em></p> </td> <td> <p><em>ID рабочего места</em></p> </td> <td> <p>Установлены флажки:</p> <ul> <li><strong>Использовать как заголовок записей</strong></li> <li><strong>Контролировать уникальность значений</strong></li> </ul> </td> </tr> <tr> <td> <p><em>Текст</em></p> </td> <td> <p><em>Наименование</em></p> </td> <td> <p>По умолчанию</p> </td> </tr> <tr> <td> <p><em>Список значений</em></p> </td> <td> <p><em>Статус</em></p> </td> <td> <p><strong>Список значений:</strong> - <em>Свободно</em> - <em>Занято</em></p> </td> </tr> <tr> <td> <p><em>Список значений</em></p> </td> <td> <p><em>Состояние</em></p> </td> <td> <p><strong>Список значений:</strong></p> <ul> <li><em>Хорошее</em></li> <li><em>Плохое</em></li> </ul> </td> </tr> <tr> <td> <p><em>Запись (Связать с Шаблон записи Помещения)</em></p> </td> <td> <p><em>Помещение</em></p> </td> <td> <ul> <li><strong>Связанный шаблон:</strong> <em>Помещения</em></li> <li><strong>Хранить несколько значений:</strong> флажок снят</li> <li><strong>Взаимная связь с атрибутом:</strong><ul> <li><strong>С новым:</strong><ul> <li><em>Название:</em> Рабочие места</li> <li><strong>Хранить несколько значений:</strong> флажок установлен</li> </ul> </li> </ul> </li> </ul> </td> </tr> <tr> <td> <p><em>Запись (Связать с Шаблон записи Этажи)</em></p> </td> <td> <p><em>Этаж</em></p> </td> <td> <ul> <li><strong>Связанный шаблон:</strong> <em>Этажи</em></li> <li><strong>Хранить несколько значений:</strong> флажок снят</li> <li><strong>Взаимная связь с атрибутом:</strong></li> <li><strong>С новым:</strong><ul> <li><em>Название:</em> Рабочие места</li> <li><strong>Хранить несколько значений:</strong> флажок установлен</li> </ul> </li> </ul> </td> </tr> <tr> <th colspan="3"> <p><strong>Атрибуты шаблона «<em>Заявки»</em></strong></p> </th> </tr> <tr> <th> <p><strong>Тип данных</strong></p> </th> <th> <p><strong>Название</strong></p> </th> <th> <p><strong>Свойства</strong></p> </th> </tr> <tr> <td> <p><em>Запись</em></p> </td> <td> <p><em>Этаж</em></p> </td> <td> <ul> <li><strong>Связанный шаблон:</strong> <em>Этажи</em></li> <li><strong>Хранить несколько значений:</strong> флажок снят</li> <li><strong>Взаимная связь с атрибутом:</strong></li> <li><strong>С новым:</strong><ul> <li><em>Название:</em> <em>Заявки</em></li> <li><strong>Хранить несколько значений:</strong> флажок установлен</li> </ul> </li> </ul> </td> </tr> <tr> <td> <p><em>Запись</em></p> </td> <td> <p><em>Помещение</em></p> </td> <td> <ul> <li><strong>Связанный шаблон:</strong> <em>Помещения</em></li> <li><strong>Хранить несколько значений:</strong> флажок снят</li> <li><strong>Взаимная связь с атрибутом:</strong><ul> <li><strong>С новым:</strong><ul> <li><em>Название:</em> <em>Заявки</em></li> <li><strong>Хранить несколько значений:</strong> флажок установлен</li> </ul> </li> </ul> </li> </ul> </td> </tr> <tr> <td> <p><em>Запись</em></p> </td> <td> <p><em>Рабочее место</em></p> </td> <td> <ul> <li><strong>Связанный шаблон:</strong> <em>Рабочие места</em></li> <li><strong>Хранить несколько значений:</strong> флажок снят</li> <li><strong>Взаимная связь с атрибутом:</strong><ul> <li><strong>С новым:</strong></li> <li><em>Название:</em> <em>Заявки</em></li> <li><strong>Хранить несколько значений:</strong> флажок установлен</li> </ul> </li> </ul> </td> </tr> <tr> <td> <p><em>Список значений</em></p> </td> <td> <p><em>Статус</em></p> </td> <td> <p><strong>Список значений:</strong></p> <ul> <li><em>Открыта</em></li> <li><em>Отменена</em></li> <li><em>Выполняется</em></li> <li><em>Выполнена</em></li> <li><em>Ожидает проверки</em></li> <li><em>Проверена</em></li> </ul> </td> </tr> </tbody> </table> <h2 id="настройка-форм-и-полей">Настройка форм и полей</h2> <ol class="colored_numbers_list"> <li>Вынесите созданные атрибуты на основные формы шаблонов.</li> <li>В шаблоне записи «Этажи» откройте основную форму и выберите поле атрибута «<strong>План</strong>».</li> <li> <p>Выберите блок «<strong>Связи</strong>» на поле чертежа.</p> <p><figure class="screenshot_with_caption" markdown=""><img alt="Настройка связей между слоями чертежа и шаблонами записи в приложении" src="https://kb.comindware.ru/assets/attribute_drawing_layers_settings.png"/><figcaption class="caption">Настройка связей между слоями чертежа и шаблонами записи в приложении</figcaption></figure></p> </li> <li> <p>Настройте два уровня связей между слоями чертежа и шаблонами записей с помощью панели «<strong>Свойства связей</strong>»:</p> <ul> <li> <p><em>Уровень 1</em></p> <ul> <li><strong>Шаблон записи:</strong> <em>Помещения</em>. В этом шаблоне будут храниться записи, связанные с полигонами слоя <em>«Помещения»</em> на чертеже.</li> <li><strong>Атрибут:</strong> <em>ID помещения.</em> По этому ключевому атрибуту полигоны со слоя <em>«Помещения»</em> на чертеже будут привязаны к записям в шаблоне <em>«Помещения»</em> путем сопоставления наименований полигонов со слоя <em>«ID помещений»</em> со значениями атрибута.</li> <li><strong>Форма на чертеже:</strong> <em>Помещения — Основная форма.</em> Эта форма будет отображаться в информационной панели для полигона, выбранного на чертеже.</li> <li><strong>Форма для перехода:</strong> <em>Помещения — Основная форма.</em> Эта форма будет отображаться при нажатии кнопки <em>«Перейти к записи»</em> в информационной панели для полигона, выбранного на чертеже.</li> </ul> </li> <li> <p><em>Уровень 2</em></p> <ul> <li><strong>Шаблон записи:</strong> <em>Рабочие места.</em> В этом шаблоне будут храниться записи, связанные с полигонами слоя <em>«Рабочих мест»</em> на чертеже. Настройте его аналогично <em>Уровню 1.</em></li> <li><strong>Атрибут:</strong> <em>ID рабочего места</em></li> <li><strong>Форма на чертеже:</strong> <em>Рабочие места — Основная форма</em></li> <li><strong>Форма на чертеже:</strong> <em>Рабочие места — Основная форма</em></li> </ul> </li> </ul> </li> <li> <p>Выберите блок «<strong>Маркеры</strong>» на поле чертежа.</p> <p><figure class="screenshot_with_caption" markdown=""><img alt="Настройка привязки маркеров на плане к записям в приложении и слоям чертежа" src="https://kb.comindware.ru/assets/attribute_drawing_markers_settings.png"/><figcaption class="caption">Настройка привязки маркеров на плане к записям в приложении и слоям чертежа</figcaption></figure></p> </li> <li> <p>Настройте привязку записей из шаблона <em>«Заявки»</em> к маркерам на плане с помощью панели «<strong>Свойства маркеров</strong>»:</p> <ul> <li><strong>Шаблон записи:</strong> <em>Заявки.</em> Записи этого шаблона, будут отображаться как маркеры на плане.</li> <li><strong>Форма для перехода:</strong> <em>Заявки — Основная форма.</em> Эта форма будет отображаться в информационной панели для маркера, выбранного на чертеже.</li> <li><strong>Форма на</strong> <strong>чертеже:</strong> <em>Заявки — Основная форма.</em> Эта форма будет отображаться при нажатии кнопки «<strong>Перейти к записи</strong>» в информационной панели на чертеже.</li> <li><strong>Таблица:</strong> <em>Все записи.</em> Эта таблица будет отображаться на вкладке «<strong>Заявки</strong>» слева от плана. Если для таблицы назначено <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=2402">представление карточек</a>, то оно будет отображаться вместо таблицы.</li> <li> <p><strong>Привязка к слоям</strong> — укажите для каждого уровня связи (слоя на чертеже) атрибут типа «<strong>Запись</strong>» из шаблона <em>«Заявки»</em>, ссылающийся на шаблон записи, заданный в <strong>связях</strong>. Маркеры будут привязаны к соответствующим слоям:</p> <ul> <li>Слой <em>«Помещения»:</em> атрибут <em>«Помещение»</em></li> <li>Слой <em>«Рабочие места»: атрибут </em>«Рабочее место»_</li> </ul> </li> </ul> </li> <li> <p>Выберите блок «<strong>Метаданные</strong>» на поле чертежа.</p> <p><figure class="screenshot_with_caption" markdown=""><img alt="Выбор атрибутов, задающих цвета полигонов на плане" src="https://kb.comindware.ru/assets/attribute_drawing_polygon_colours.png"/><figcaption class="caption">Выбор атрибутов, задающих цвета полигонов на плане</figcaption></figure></p> </li> <li> <p>На панели «<strong>Свойства метаданных</strong>» оставьте установленными все флажки. Каждый флажок представляет атрибут типа «<strong>Список значений</strong>», задающий цвета полигонов, связанных с записями помещений и рабочих мест. Кроме того, с помощью вкладки «<strong>Цвета</strong>» слева от плана конечный пользователь сможет отфильтровать полигоны по значениям выбранных атрибутов.</p> <ul> <li>Слой <em>«Помещения»:</em> установите флажок <em>«Статус»</em> и <em>«Вид»</em></li> <li>Слой <em>«Рабочие места»:</em> установите флажки <em>«Статус»</em> и <em>«Состояние»</em></li> </ul> </li> <li> <p>Создайте в шаблоне <em>«Этажи»</em> одну запись с <em>наименованием «Этаж 1»</em>.</p> </li> <li> <p>Создайте и заполните записи в шаблонах <em>«Помещения»</em> и <em>«Рабочие места».</em></p> <ul> <li>В каждой записи введите ID помещения или рабочего места, соответствующий текстовому идентификатору полигона в подготовленном DWG-файле.</li> <li> <p>Шаблон <em>«Помещения»</em></p> <ul> <li> <p>Создайте записи со следующими значениями атрибута <em>«ID помещения»</em>:</p> <ul> <li><em>Диспетчерская</em></li> <li><em>Переговорная</em></li> <li><em>Кабинет руководителя</em></li> <li><em>Отдел продаж</em></li> </ul> </li> <li> <p>Для всех записей укажите <em>Этаж 1</em>.</p> </li> <li>Поля <em>«Статус»</em> и <em>«Вид»</em> заполните произвольными значениями.</li> </ul> </li> <li> <p>Шаблон <em>«Рабочие места»</em></p> <ul> <li> <p><em>Создайте записи со следующими значениями атрибута </em>«ID рабочего места»_: </p> <ul> <li><em>Диспетчер 1</em></li> <li><em>Диспетчер 2</em></li> <li><em>Диспетчер 3</em></li> <li><em>Стол для переговоров</em></li> <li><em>Рабочее место руководителя 1</em></li> <li><em>Специалист по продажам 1</em></li> <li><em>Специалист по продажам 2</em></li> <li><em>Специалист по продажам 3</em></li> </ul> </li> <li> <p>Для всех записей укажите <em>Этаж 1</em>.</p> </li> <li>Для каждого рабочего места, укажите соответствующее помещение.</li> <li>Поля <em>«Статус»</em> и <em>«Состояние»</em> заполните произвольными значениями.</li> </ul> </li> </ul> </li> <li> <p>Создайте несколько записей в шаблоне <em>«Заявки»</em>, указав для них <em>этаж 1</em>, произвольное помещение, соответствующее помещению рабочее место и произвольный статус.</p> </li> <li>В поле <em>«План»</em> на форме записи <em>«Этаж 1»</em> нажмите кнопку «<strong>Загрузка файла</strong>».</li> <li> <p>С помощью мастера <em>«</em><strong>Настройка плана</strong><em>»</em> загрузите DWG-файл и привяжите слои полигонов и слои наименований на чертеже к шаблонам записи:</p> <table style="width: 100%;"> <thead> <tr> <th>Слой полигонов</th> <th>Слой наименований</th> <th>Шаблон записи</th> <th>Атрибут</th> </tr> </thead> <tbody> <tr> <td>Помещения</td> <td>ID помещений</td> <td>Помещения</td> <td>ID помещения</td> </tr> <tr> <td>Рабочие места</td> <td>ID рабочих мест</td> <td>Рабочие места</td> <td>ID рабочего места</td> </tr> </tbody> </table> <p><figure class="screenshot_with_caption" markdown=""><img alt="Привязка слоёв чертежа к шаблонам записей в приложении" src="https://kb.comindware.ru/assets/attribute_drawing_layers_connect.png"/><figcaption class="caption">Привязка слоёв чертежа к шаблонам записей в приложении</figcaption></figure></p> </li> <li> <p>Отобразится план <em>этажа 1</em>.</p> </li> <li> <p>Поэкспериментируйте с планом:</p> <ul> <li>выбирайте полигоны и маркеры на плане;</li> <li>просматривайте сведения об объектах и заявках в панели справа от чертежа;</li> <li>выбирайте, скрывайте и отображайте слои, объекты и маркеры с помощью панели слева от чертежа.</li> </ul> <p><figure class="screenshot_with_caption" markdown=""><img alt="Использование плана на форме" src="https://kb.comindware.ru/assets/attribute_drawing_plan_usage.png"/><figcaption class="caption">Использование плана на форме</figcaption></figure></p> </li> </ol> <h2 id="связанные-статьи">Связанные статьи</h2> <p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=2574">Чертёж. Подготовка и импорт файла DWG</a></strong></p> <p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=2531#form_dynamic_elements_drawing">Чертёж. Настройка поля на форме</a></strong></p> </article> </div> </div> <a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#"> <i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i> К началу </a> </main> </div> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>