---
title: 'Нагрузочное тестирование'
kbTitle: 'Нагрузочное тестирование Comindware Platform'
kbId: 
tags:
  - Apache JMeter
  - load testing
  - нагрузочное тестирование
  - оптимизация
  - производительность
  - тестирование
hide: tags
---

# Нагрузочное тестирование {{ productName }} {: #load_testing }

## Введение {: #load_testing_intro }

Нагрузочное тестирование — это критически важный этап подготовки приложений к промышленной эксплуатации. Оно позволяет заблаговременно выявить узкие места системы и обеспечить надёжную работу приложений под нагрузкой.

## Цели тестирования {: #load_testing_goals }

### Технические цели {: #load_testing_goals_technical }

- Определить максимальную пропускную способность системы и количество одновременных пользователей, которое она может обрабатывать без нарушения требований к производительности.
- Выявить узкие места в архитектуре приложения, конфигурации серверов и инфраструктурных службах.
- Проверить корректность работы системы при пиковых нагрузках и стрессовых сценариях.
- Измерить время отклика ключевых операций и убедиться, что оно соответствует установленным нормам.
- Оценить потребление системных ресурсов (процессор, память, сеть, диск) под нагрузкой.

### Бизнес-цели {: #load_testing_goals_business }

- Обеспечить бесперебойную работу критически важных бизнес-процессов в пиковые периоды.
- Подтвердить готовность системы к промышленной эксплуатации и определить оптимальную конфигурацию оборудования.
- Минимизировать риски простоев и потери данных.
- Получить количественные метрики для планирования ресурсов и масштабирования системы.

## Ожидаемые результаты {: #load_testing_outcomes }

### Технические результаты {: #load_testing_outcomes_technical }

- Значения ключевых метрик производительности системы:
  - **время отклика** — время выполнения типовых операций (открытие таблицы, сохранение формы, запуск процесса);
  - **пропускная способность** — количество запросов в секунду, которое система обрабатывает без перебоев;
  - **процент ошибок** — доля неуспешных запросов при заданной нагрузке;
  - **загрузка ресурсов** — потребление ресурсов ЦП, оперативной памяти, операций дискового ввода-вывода, сетевого трафика.
- Выявленные узкие места и рекомендации по их устранению.
- Рекомендуемые значения параметров конфигурации для достижения целевой производительности.

### Бизнес-результаты {: #load_testing_outcomes_business }

- Обоснование выбора конфигурации оборудования для промышленной эксплуатации.
- Подтверждение соответствия системы требованиям к производительности и масштабируемости.
- Базовые показатели для последующего мониторинга и сравнения при изменениях в системе.
- Уверенность в стабильной работе системы при ожидаемой и пиковой нагрузке.

## Развертывание {{ productName }} {: #load_testing_deployment }

Перед нагрузочным тестированием разверните **{{ productName }}**.

Конфигурация системы должна быть продуктовой или близка к ней (согласно [рассчитанному сайзингу][system_requirements]).
Это позволит получить более точные результаты и провести дальнейшую аналитику журналов.

См.:

<div class="relatedTopics" markdown="block">

- [Установка, запуск, инициализация и остановка ПО в Linux][deploy_guide_linux]
- [Установка, запуск, инициализация и остановка ПО в Windows][deploy_guide_windows]
- [Системные требования {{ productName }}][system_requirements]
- [Факторы, влияющие на производительность. Рекомендации по оптимизации][performance_optimize]

</div>

## Установка и настройка Apache JMeter {: #load_testing_jmeter_setup }

1. Установите Java 8+.
2. Скачайте и распакуйте в любую папку архив Apache JMeter [с официального сайта][jmeter_download].
3. Скачайте готовый [файл конфигурации Apache JMeter](assets/filename).
4. Запустите JMeter и откройте данный файл с помощью меню «**File**» — «**Open**».
5. На вкладке «**Test plan**» укажите свои параметры:

    - `SRV_HOST` — адрес экземпляра **{{ productName }}**;
    - `SOTRUDNIK_LOGIN` — имя пользователя **{{ productName }}**;
    - `SOTRUDNIK_PASSWORD` — пароль;
    - `AccountsCount` и `ReadAcc` — количество пользовательских сеансов, которое требуется запустить;
    - `ramp_up` — интервал в миллисекундах между запуском сеансов;
    - `iterations` — количество итераций прогона теста.

## Использование готового файла конфигурации Apache JMeter {: #load_testing_jmeter_scenarios }

!!! question "Готовый файл конфигурации от {{ companyName }}"

    В готовом файле конфигурации представлены примеры следующих сценариев тестирования:

        - открыть таблицу;
        - сохранить форму с заполненными данными;
        - нажатие пользовательской кнопки по выбранным записям из таблицы.

1. Для создания своего сценария добавьте новый контроллер транзакций и HTTP-запрос:

    - выберите вкладку с имеющимся сценарием тестирования;
    - нажмите правую кнопку мыши и выберите пункт «**Duplicate**»;
    - выберите требуемый целевой блок или нажмите правой кнопкой целевую вкладку;
    - выберите пункты «**Add**» — «**Logic Controller**» — «**Transaction Controller**»;
    - выберите пункты «**Add**» — «**Sampler**» — «**HTTP Request**».

    _![Добавление контроллера транзакций](img/jmeter_transaction_controller.png)_

    _![Добавление HTTP-запроса](img/jmeter_interface.png)_

2. Для настройки HTTP-запроса укажите протокол, адрес стенда, порт, метод (POST) — по аналогии с примерами. Также укажите путь и тело запроса.

    _![Настройка HTTP-запроса](img/jmeter_http_request_config.png)_

## Получение путей и тела запроса для тестирования {: #load_testing_jmeter_get_request }

1. Откройте нужную страницу стенда, включите меню разработки, перейдите во вкладку Network. Чтобы получить данные, нажмите кнопку либо перезагрузите страницу с формой или списком, выберите значение в раскрывающемся списке на форме либо заполните поле.
2. В таблице «Name» найдите соответствующую запись: Query (список), QueryForm (форма), Execute (кнопка), QueryData (заполнение поля).
3. Путь будет указан На вкладке «Headers» в строке «Request URL» после адреса стенда.

    _![Вкладка Network в браузере](img/browser_network_tab.png)_

4. Тело запроса будет указано На вкладке «Payload». Для быстрого копирования выберите первую строку после «Request Payload» и нажмите на «Copy».

    _![Вкладка Payload в браузере](img/browser_payload_tab.png)_

5. Реквизит «objId» в теле запроса отвечает за ID записи, к которой это будет применено. Его можно менять для проведения операций с разными записями. Если сценарий создания новой записи -> ничего не нужно редактировать в скопированном теле. Так же сценарий создания новой записи – это кнопка «Сохранить» на форме создания.

6. Если требуется запускать сценарии одновременно под пользователями с разными ролями, добавьте новую группу пользователей «Thread Group» (сделайте дубликат существующей). В «Test Plan» добавьте новые переменные с данными для авторизации пользователя под конкретной ролью. В «HTTP Authorization Manager» в «Username» и «Password» укажите соответствующие переменные по аналогии с примером.

    _![HTTP Authorization Manager](img/jmeter_http_auth_manager.png)_

7. Для выключения какого-то элемента без удаления выберите его->нажмите правой кнопкой мыши->«Disable». Для включения: «Enable». Выключенные элементы подсвечиваются серым и пропускаются при выполнении теста.

    _![Отключение элемента в JMeter](img/jmeter_disable_element.png)_

    _![Выключенный элемент в JMeter](img/jmeter_disabled_element.png)_

## Проведение нагрузочного тестирования {: #load_testing_execution }

1. Перед началом тестирования измените конфигурацию системы: в любое место файла `/usr/share/comindware/configs/instance/cmwdata.yml`, обычно после версии платформы, добавьте: `isTestEnvironment: true`.
2. Перезагрузите систему.
3. Для запуска теста нажмите на «Start».

    _![Кнопка Start в JMeter](img/jmeter_start_button.png)_

4. После окончания тестирования, отчеты будут отображены в «View Result Tree» и «Summary Report».

    _![View Result Tree](img/jmeter_view_results.png)_

    _![Summary Report](img/jmeter_summary_report.png)_

5. Затем выгрузите логи со стенда и загрузите их для анализа.
6. После проведения всех работ удалите добавленную строку в конфигурации системы и перезагрузите её.

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- [Страница загрузки Apache JMeter][jmeter_download]
- [Установка, запуск, инициализация и остановка ПО в Linux][deploy_guide_linux]
- [Установка, запуск, инициализация и остановка ПО в Windows][deploy_guide_windows]
- [Системные требования {{ productName }}][system_requirements]
- [Факторы, влияющие на производительность. Рекомендации по оптимизации][performance_optimize]
- [Пути и содержимое директорий экземпляра ПО][paths]
- [Конфигурация экземпляра, компонентов ПО и служб. Настройка][configuration_files_linux]

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
