---
title: 'Урок 1. Введение в N3 и графы знаний'
kbTitle: 'Урок 1. Введение в N3 и графы знаний'
kbId: 
tags:
    # Common tutorial_n3 tags
    - ElasticData
    - N3
    - Notation3
    - RDF
    - Turtle
    - выражения
    - разработка
    - обучение
    - платформа
    - триплеты
    - тройки
    - уроки
    - учебник
    # Lesson-specific tags
    - введение
    - синтаксис
    - HR
hide: tags
---

# Урок 1. Введение в N3 и графы знаний {: #tutorial_n3_lesson_1 }

## Введение {: #tutorial_n3_lesson_1_intro }

В ходе этого урока вы познакомитесь с RDF и графами знаний, узнаете, что такое триплет вида `субъект–предикат-объект` и как составлять триплеты в нотации N3 для манипуляций с данными в **{{ productName }}**.

Кроме того, разберётесь с базовым синтаксисом языка N3, пятью типами запросов и контекстом исполнения выражений в **{{ productName }}**.

**Предусловия:**

- Имеется доступ к веб-сайту с **{{ productName }}**.
- **Рекомендуется** пройти _курс «[Аналитик. Ознакомительный][tutorial_hr]»_, чтобы получить базовые навыки работы с **{{ productName }}**.

**Расчётная продолжительность:** 1 час 30 минут.

!!! warning "Бизнес-логика"

    В курсе используется контекст HR‑процесса подбора кандидатов: анкета кандидата → вакансия → интервью → итоговое решение.
    
    Примеры ориентированы на практику работы с данными в **{{ productName }}**.

{% include-markdown ".snippets/tutorial_version_notice.md" %}

## Темы, навыки и задания урока {: #tutorial_n3_lesson_1_taxonomy }

### Темы {: #tutorial_n3_lesson_1_topics }

- **Языки запросов в {{ productName }}**
- **RDF и графы знаний**
- **Графовая СУБД ElasticData**
- **Триплеты — атомарные элементы N3**
- **Базовый синтаксис N3**
- **Типы запросов на N3**
- **Контекст исполнения N3**
- **Переход от формул к N3**

### Навыки {: #tutorial_n3_lesson_1_skills }

- Понимание назначения и преимуществ использования языка N3 в **{{ productName }}**
- Понимание представления данных в виде графов
- Чтение и составление элементарных выражений на языке N3
- Понимание контекста, входных и выходных данных выражений
- Выбор корректного типа запроса под задачу

### Задания {: #tutorial_n3_lesson_1_tasks }

- Освоить базовые принципы представления данных в виде графов
- Разобрать простейшие выражения на N3
- Составить выражения для получения данных из связанных шаблонов

<div class="admonition question" markdown="block">

## Определения {: .admonition-title #tutorial_n3_lesson_1_definitions}

- **RDF (Resource Description Framework)** — модель представления знаний в виде триплетов.
- **Граф знаний** — сеть сущностей (узлов) и связей (рёбер), описывающих предметную область.
- **Триплет (тройка)** — утверждение вида: `субъект — предикат — объект`.
- **N3** — текстовая нотация для записи триплетов и графов.
- **URI** — идентификатор ресурса вида `https://www.w3.org/1999/02/22-rdf-syntax-ns#type`.
- **ElasticData** — фирменная СУБД в основе **{{ productName }}**, построенная на графовой модели RDF.

</div>

## Языки запросов в {{ productName }} {: #tutorial_n3_lesson_1_syntax }

В **{{ productName }}** предусмотрено два языка запросов:

1. **Формулы** — фирменный язык выражений **{{ companyName }}**, похожий на формулы Excel. Является простым для восприятия и представляет собой надстройку над языком **N3**. Для базовой настройки системы его зачастую достаточно. Типовые примеры использования формул:

    - выборка данных из связанных шаблонов записей;
    - подсчёт количества объектов;
    - простые математические операции типа умножения и деления;
    - конкатенация и преобразования строк.

2. **N3** (**Notation 3**, **триплеты**) — более сложный в прочтении и написании, но более функциональный язык, позволяющий составлять сложные запросы и получать доступ к данным, которые затруднительно получить с помощью формул, например к системным атрибутам, атрибутам и экземплярам процессов и задач. Язык N3 представляет собой сокращённую запись RDF. Синтаксис N3 определён международным консорциумом W3C.

В рамках этого курса мы рассмотрим базовые принципы использования языка **N3**.

## СУБД ElasticData, графы знаний и RDF {: #tutorial_n3_lesson_1_rdf_graphs }

В **{{ productName }}** данные хранятся в СУБД ElasticData, которая построена на графовой модели данных RDF.

RDF — это модель, которая описывает данные (знания) как граф утверждений.

Каждое утверждение представляет собой так называемый **триплет** `субъект — предикат — объект`, где:

- `субъект` — это описываемый ресурс;
- `предикат` — это свойство или связь субъекта с объектом;
- `объект` — это значение свойства или другой ресурс.

Триплет также можно представить как подлежащее, сказуемое и дополнение, например: `сотрудник — работает в — компании`. Тое сть объект и субъект представлены существительными, а предикат — глаголом.

Такое представление естественным образом соответствует любым предметным областям, где сущности и их отношения образуют семантическую сеть.

Например, с помощью графа можно описать HR-процессы, участвующие в них сущности (ресурсы), их связи и взаимодействие — организационные единицы, сотрудников, документы и т.&nbsp;п.

Таким образом, в **{{ productName }}** все объекты имеют следующее внутренне представление:

- шаблоны, атрибуты, значения атрибутов и любые другие сущности — это узлы (вершины) графа, то есть субъекты и объекты;
- связи между сущностями — это рёбра графа, то есть предикаты.

Пример триплета, составленного из URI ресурсов:

``` rdf
<http://example.com/hr/employee/bobrov> <http://example.com/hr/relation/worksIn> <http://example.com/hr/company/woodworking>.
              субъект                                   предикат                                    объект
          сотрудник Бобров                             работает в                       компании ООО «Деревообработка»
```

!!! question "Факты и направленный граф"

    Триплет в **{{ productName }}** также называется **фактом**, то есть утверждением, фиксирующим некое знание.

    Следует учитывать, что в **{{ productName }}** графы являются направленными. Поэтому утверждения `сотрудник → работает в → компании` и `сотрудника ← наняла ← компания` являются **двумя разными фактами**, описывающими ресурсы `сотрудник` и `компания`.

См. также: _«[ElasticData][elasticdata_description]»_, _«[Графы][n3_graphs]»_, _«[Графы знаний][n3_knowledge_graphs]»_, _«[Модель][n3_model]»_.

## Язык N3 для обращения к данным в {{ productName }} {: #tutorial_n3_lesson_1_n3_basic_syntax }

Для доступа к данным в **{{ productName }}** используется язык **N3**, который представляет собой сокращенное человекочитаемое написание RDF.

Та как данные в **{{ productName }}** хранятся в виде триплетов RDF, язык N3 позволяет описывать факты в базе данных и обращаться к ним наиболее естественным (нативным) образом.

Например, запишем факт `сотрудник Бобров → работает в → компании ООО «Деревообработка»` на языке N3:

``` turtle
# Для удобочитаемости объявляем сокращённые имена ресурсов
# с помощью директивы @prefix
@prefix employee: <http://example.com/hr/employee/>.
@prefix relation: <http://example.com/hr/relation/>.
@prefix company: <http://example.com/hr/company/>.

# Записываем факт в виде триплета
# с короткими именами ресурсов
employee:bobrov relation:worksIn company:woodworking.
```

!!! question "Базовый синтаксис N3"

    - Каждый триплет должен завершаться **точкой**.
    - Каждый триплет должен находиться **на одной строке** и не может содержать переносов строк.
    - `@prefix` — директива, объявляющая сокращённое имя ресурса по его URI. Такие имена ресурсов позволяют сделать выражения на N3 более удобочитаемыми и наглядными.

!!! example "Практическое задание"

    Попробуйте записать на языке N3 следующий факт:

    `ООО «Деревообработка» → получило резюме → кандидата Иванова`

## Пять типов запросов и поведение интерпретатора {: #tutorial_n3_lesson_1_query_forms }

Интерпретатор выражений в **{{ productName }}** поддерживает пять форм (подробно — [Руководство по N3][n3_guide]):

1. Выбор значений (pattern‑match triples)
2. Присваивание/вычисление
3. Утверждение (assert)
4. Отрицание (not { ... })
5. Итерации и коллекции (`from { ... } select ...`)

Основные правила выполнения:

- Тройки в блоке конъюнктивны (по умолчанию AND).
- Выполнение останавливается при несоответствии (fan‑out ограничивается ложью).
- Более избирательные условия располагайте выше для эффективности.

## Контекст и ввод‑вывод по сущностям {: #tutorial_n3_lesson_1_io_context }

Важная особенность — контекст исполнения и контракт I/O переменных:

- `?item` — текущая сущность контекста (например, кандидат).
- `?value` — итоговое значение (или список значений), возвращаемое выражением.

Типы и семантика `?item`/`?value` зависят от сущности и точки применения (атрибут, вычисляемое поле, фильтр и т. п.). Смотрите матрицу I/O в [Руководство по N3][n3_guide]. В этом курсе мы явно отмечаем, какой тип ожидается и что возвращается.

## N‑Triples ↔ N3: соответствие и мини‑рефактор {: #tutorial_n3_lesson_1_ntriples_mapping }

Одна и та же семантика может быть записана как N‑Triples, так и N3.

N‑Triples (простая, построчная форма):

``` turtle
<http://example.com/hr#Candidate123> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://example.com/hr#Candidate> .
<http://example.com/hr#Candidate123> <http://example.com/hr#fullName> "Иван Петров" .
```

Эквивалент в N3/Turtle с префиксами и `a`:

``` turtle
@prefix ex: <http://example.com/hr#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.

ex:Candidate123 a ex:Candidate;
    ex:fullName "Иван Петров".
```

Мини‑рефактор Formula → N3 (иллюстрация):

``` turtle
# Было (псевдокод формул)
# fullName = Candidate.name + " " + Candidate.surname

# Стало (N3‑идея):
{ ?candidate a ex:Candidate;
             ex:firstName ?first;
             ex:lastName ?last. }
=> { ?candidate ex:fullName ?full. }.

@prefix w3string: <http://www.w3.org/2000/10/swap/string#>.

{ (?first " " ?last) w3string:concatenation ?full. }
```

Примечание: используйте фактические предикаты и функции, доступные в **{{ productName }}**, см. каталоги и примеры в [Руководство по N3][n3_guide] и раздел «Примеры».

## Редактор N3 в платформе и глоссарий {: #tutorial_n3_lesson_1_editor_glossary }

- Где писать N3: редактор выражений внутри атрибутов, фильтров, сценариев.
- Подсветка синтаксиса, проверки и сообщения об ошибках.
- Глоссарий терминов и префиксов: см. [Глоссарий][n3_glossary], [Руководство по N3][n3_guide].

## Пример: от кандидата к отделу {: #tutorial_n3_lesson_1_example_hr }

Задача: находясь в контексте кандидата (`?item` — `ex:Candidate`), получить название отдела, в который открыта вакансия, на которую подаётся кандидат, и вернуть его в `?value`.

``` turtle
@prefix ex: <http://example.com/hr#>.

{ ?item a ex:Candidate;
        ex:appliesFor ?position.
  ?position ex:department ?dept.
  ?dept ex:name ?deptName. }
=> { ?value = ?deptName }.
```

!!! note "Типичные ошибки"
    - Отсутствует точка в конце тройки.
    - Пропущены фигурные скобки вокруг блока.
    - Неоднозначное переиспользование переменной.

## Практическое задание {: #tutorial_n3_lesson_1_practical_task }

1. Создайте выражение, которое из контекста кандидата возвращает его полное имя в `?value` (имя + пробел + фамилия). Используйте функции работы со строками из [Руководство по N3][n3_guide].
2. Модифицируйте пример «кандидат → отдел», чтобы возвращать пару значений: название отдела и название позиции (подумайте о форме результата в вашем контексте).
3. Найдите в [примерах](#tutorial_n3_lesson_1_links) фрагмент с `from { } select` и объясните, чем отличается такой сбор коллекции от простого сопоставления троек.

!!! example "Отладка и производительность"
    - Сведите выражение к минимальной тройке, воспроизводящей проблему.
    - Переместите самые избирательные условия выше в блоке.
    - Применяйте `once {}` только там, где гарантирована единственность.

## Итоги урока {: #tutorial_n3_lesson_1_summary }

Вы познакомились с RDF и графами знаний, базовым синтаксисом N3, формами запросов, контекстом исполнения и I/O‑переменными, а также увидели соответствие N‑Triples ↔ N3 на простых примерах HR‑контекста.

В ходе [следующего урока][tutorial_n3_lesson_2] вы закрепите синтаксис и формы запросов.

---

### Полезные ссылки {: #tutorial_n3_lesson_1_links }

- [Руководство по N3][n3_guide]
- [Учебник по N3][n3_tutorial]
- [Нотация N3][n3_notation]
- [Графы][n3_graphs], [Графы знаний][n3_knowledge_graphs]
- [Модель и соответствие данным][n3_model]
- [ElasticData][elasticdata_description]

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}

<!-- 
Перенести в следующие уроки

- `[]` — анонимные узлы 
Анонимный узел (когда имя ресурса несущественно):

``` turtle
ex:Position456 ex:requirement [ ex:skill "SQL" ].
```

Коллекция значений (упорядоченный список):

``` turtle
ex:Candidate123 ex:skills ("SQL" "Python" "ETL").
```

Присваивание с `=` используется для связывания значений переменных и термов внутри выражения, когда синтаксис поддерживается контекстом формы запроса. Подробнее: [Руководство по N3][n3_guide], [Нотация N3][n3_notation].

-->