---
title: Введение в API
kbId: 4860
---

# Общие сведения об API {{ productName }} {: #api_intro }

## Введение

**{{ productName }}** может обращаться к API внешних систем через [подключения][connections] и [пути передачи данных][communication_routes], а также может обрабатывать запросы из внешних систем через интерфейсы **REST API** трёх типов:

- [**Solution API**][api_solution] — обеспечивает доступ к актуальной модели и бизнес-логике конкретного приложения.
- [**System Core API**][api_system_core] — предоставляет доступ к системным функциям (управление аккаунтами, системными службами и т.д.).
- [**Web API**][api_web] — универсальные методы прикладного уровня для работы с данными (излечение записей, базовые CRUD-операции).

## Стратегия выбора API

Перед выбором API ознакомьтесь с параграфом _«[**Обратная совместимость API**](#обратная-совместимость-api)»_.

Помимо обратной совместимости, при выборе API следует учесть все технические и бизнес-факторы, включая потенциальные затраты на обновление интеграций в случае устаревания используемых API.

Чтобы выбрать оптимальные API в соответствии с целями и потребностям вашего предприятия, обязательно привлеките системных аналитиков, бизнес-аналитиков и представителей коммерческих отделов вашей организации.

В общем случае можно рекомендовать следующий подход к выбору API:

- Для интеграций с бизнес-логикой приложений используйте **Solution API**. При этом предусмотрите механизм обработки изменений логики работы приложений.
- Для системных задач (аутентификация, настройки) используйте **System Core API**. Учитывайте, что при обновлении мажорной версии ПО (например, с 4.2 на 5.0) может потребоваться обновить код интеграций.
- Для стабильных и долгосрочных интеграций отдавайте предпочтение **Web API**. Эти интерфейсы обладают наибольшей обратной совместимостью.

## Обратная совместимость API

Для API **{{ productName }}** различных типов применяются разные политики обратной совместимости.

### Solution API

- **Обратная совместимость**: не гарантируется и может меняться в при внесении изменений в приложения, за исключением метаданных (например, базовой структуры сущностей **{{ productName }}**).
- **Рекомендации**: используйте для интеграций, где требуется доступ к текущей модели приложения. Учитывайте, что модель данных и логика работы приложения методы могут меняться по мере его развития.

### System Core API

- **Обратная совместимость**: поддерживается в рамках мажорной версии (например, 5.x.x). Методы сохраняют стабильность, но в новых минорных версиях могут быть реализованы новые параметры или возможности с сохранением совместимости.
- **Рекомендации**: при обновлении мажорной версии (например, с 4.x.x на 5.0.0) проверяйте документацию на наличие изменений. Для минорных версий (например, 5.1 и 5.2) совместимость сохраняется.

### Web API

- **Обратная совместимость**: полностью гарантирована. Методы остаются стабильными между всеми версиями **{{ productName }}** (например, 4.x.x и 5.x.x).
- **Рекомендации**: оптимально подходит для долгосрочных интеграций. Изменения вносятся только в исключительных случаях, с сохранением обратной совместимости.

<div class="admonition question" markdown="block">

## Определения {: .admonition-title #definitions}

- **API** (Application Programming Interface) — это интерфейс прикладного программирования — набор методов, классов, библиотек и функций, обеспечивающих возможность взаимодействия между системами.
- **REST API** — это API, соответствующий архитектуре Representational State Transfer (передача репрезентативного состояния). Преимуществами REST API являются возможность оптимального использования протокола HTTP, масштабирования сервисов и разработки приложений с использованием практически любых языков программирования с соблюдением принципов проектирования REST:
    - отсутствие сохранения состояния на сервере — каждый поступающий запрос содержит все необходимые для обработки данные и обрабатывается независимо от других запросов;
    - единообразный интерфейс — сервер передаёт информацию в стандартном формате;
    - независимость клиента и сервера — клиент может взаимодействовать с сервером только посредством URI ресурса, а сервер может лишь передавать на клиент запрошенные данные посредством HTTP;
    - возможность кэширования ресурсов — ответы содержат данные о кэшируемости, запрашиваемые многократно ресурсы могут кэшироваться на стороне сервера или клиента;
    - многоуровневая архитектура системы — клиент может подключаться к авторизованным посредникам между клиентом и сервером, чтобы получать ответы от сервера, а сервер может передавать запросы другим серверам;
    - код по запросу — сервер может расширить возможности клиента, передав исполняемый код, например, для проверки введённых пользователем данных.
- **RESTful** — это веб-служба, реализующая архитектуру **REST**.
- **Ресурс** — это объект или информация в приложении, например шаблон, аккаунт или документ, доступ к которым предоставляет API.
- **URI ресурса** — это универсальный идентификатор ресурса в API.
- **Клиент** — это человек или система, которые осуществляют доступ к ресурсам посредством API.

</div>

## Доступ к API

В простейшем случае **RESTful**-службы отправляют и получают HTTP-запросы в строке URL-адреса для получения и отправки данных, запуска команд и выполнения других действий.

Все интеграции с помощью **REST API** настраиваются по одному принципу:

- составьте сценарий интеграции — какая система инициирует вызов API, как часто, какие методы она использует для передачи каких данных, что потом происходит и т. д.;
- используйте документацию по API для тестирования запросов, настройки подключения и формирования финальных «рабочих» запросов.

### Методы API

**{{ productName }}** поддерживает следующие методы API.

- `GET` — получить данные об объекте.
- `DELETE` — удалить объект.
- `POST` — создать новый объект.
- `PUT` — изменить данные объекта.

### Инициация запроса из внешней системы

**{{ productName }}** может принимать HTTP-запросы к **API** двумя способами:

- Запрос `GET` или `DELETE` в виде URL-строки, содержащей все параметры запроса.
    - Внешняя система отправляет запрос в строке URL. Заготовку запроса для внешней системы можно сформировать в интерфейсе [Swagger](#использование-swagger).
    - Такой запрос можно проверить с помощью браузера: скопируйте полученный **Request URL** в адресную строку и нажмите клавишу `Enter`. Если вы уже вошли в систему в этом браузере, аутентификация не потребуется.
- Запрос `POST` или `PUT` с телом, содержащим все параметры (например, имя пользователя и пароль, данные, которые необходимо отправить или получить и т. д.).
    - Внешняя система отправляет запрос в формате JSON или XML. Заготовку запроса для внешней системы можно сформировать в интерфейсе [Swagger](#использование-swagger).
    - Этот вариант является более гибким, позволяя передать гораздо больше данных в структурированном виде. Но такой запрос нельзя протестировать с помощью браузера. Для тестирования можно использовать встроенный веб-интерфейс Swagger или такие службы, как Postman, SoapUI, Insomnia и т. п.
- **{{ productName }}** возвращает ответ формате JSON или XML.

### Аутентификация внешних систем при доступе к API

API **{{ productName }}** поддерживает два способа аутентификации внешних систем:

- Basic-аутентификация — требуется передать имя пользователя и пароль аккаунта, от имени которого будет выполняться запрос;
- HMAC —  требуется передать токен и секретный ключ, сформированные для аккаунта на странице «**Администрирование**» – «**[Ключи аутентификации][authentication_keys]**».

!!! note "Примечание"

    - Для использования методов API и интерфейса [Swagger](#использование-swagger) следует создать специальный аккаунт и предоставить предоставить ему разрешение «**Вызов API**» в системной роли. См. *«[Системные роли. Определения, настройка, объединение, удаление][system_roles]»*. Кроме того, API и Swagger могут использовать пользователи, входящие в системную роль «**Системные администраторы**».
    - При вызове методов API в интерфейсе [Swagger](#использование-swagger) на странице `https://your-host/docs` уже выполнен вход в **{{ productName }}**, и дополнительная аутентификация не требуется.
    - При вызове методов API из внешней системы в запросы необходимо добавлять заголовки для аутентификации с использованием аккаунта, которому предоставлен доступ к API.
    - Большинство внешних систем обладают интерфейсом настройки метода аутентификации, при отсутствии такового добавьте в `Header` запроса параметр `Authorization`, содержащий зашифрованные в формате `Base64` имя пользователь и пароль.

### Инициация запроса к внешней системе

**REST API** широко применяется в современных системах, и зачастую найти документацию по использованию API конкретной системы можно, введя в поисковой системе запрос вида *«<название системы> REST API»*.

**{{ productName }}** поддерживает перечисленные ниже способы обращения к API внешних систем:

- Запрос отправляет скрипт на C# (вызываемый [кнопкой][buttons] или [задачей выполнения сценария][process_diagram_elements_script_task] в процессе). Скрипт устанавливает подключение к внешней системе, формирует запрос, отправляет его и получает ответ.
- Запрос формирует и отправляет [сценарий][scenarios] посредством настроенного подключения к внешней системе. Сценарий позволяет сформировать тело запроса, проанализировать полученный ответ и поместить из него данные в атрибуты записей.
- Запрос формирует и отправляет [промежуточное][process_diagram_elements_send_message_intermediate_event] или [конечное событие][process_diagram_elements_send_message_end_event] отправки сообщения в процессе.

!!! note "Примечание"

    Для отправки запросов с помощью сценариев и событий процесса требуется настроить [подключение][connections] к внешней службе и [путь передачи данных][communication_routes]. 

### Аутентификация при доступе к API внешних систем

При доступе из к внешним API используйте метод аутентификации, который поддерживает внешняя система. Обратитесь документации API этой системы, чтобы узнать, следует ли указывать имя пользователя b пароль в URL-адресе или теле запроса, или необходимо сгенерировать и использовать токен безопасности вместо передачи пароля в виде обычного текста.

## Использование Swagger

**{{ productName }}** предоставляет встроенный веб-интерфейс API на основе Swagger.

- Swagger предоставляет подробную справку по методам API, включая описания запросов и ответов, а также модели данных с примерами значений.
- Swagger позволяет выполнять запросы и просматривать ответы.
- При выполнении запроса Swagger формирует URI ресурса API для использования во внешних системах, включая синтаксис тела запроса.

1. Чтобы перейти к странице Swagger, введите в адресной строке браузера строку `https://your-host/docs`, где `your-host` — доменное имя вашего сервера.
2. Отобразится страница **{{ productName }} API** со следующими разделами:

    - **RESTful Web API** — общие методы для всех версий ПО (см. [Методы Web API][api_web]);
    - **System Core API** — системные методы, которые могут отличаться для разных версий ПО (см. [Методы System Core API][api_system_core]);
    - **Solution API** — методы для шаблонов бизнес-приложений (см. [Методы Solution API][api_solution]).

3. Перейдите на страницу требуемого API.
4. Раскройте требуемый метод API в списке.
5. Выберите формат запроса и ответа в поле **Response Content Type**.
6. Запустите любой из доступных методов, нажав кнопку **Try it out**.
7. Отобразится заготовка запроса:

    - **Request URL** — скопируйте эту строку во внешнюю систему в качестве URI запроса, для запросов `GET` и `DELETE` она содержит весь запрос;
    - **Example Value** — скопируйте эту строку во внешнюю систему в качестве тела запроса.

_![Страница Swagger UI с разделами API {{ productName }}](https://kb.comindware.ru/assets/img_661d06c21de49.png)_

## Пример вызова метода System Core API

Для создания шаблона записи с помощью System Core API отправьте следующий `POST`-запрос на адрес **Request URL**, указанный в Swagger:

```
http://your-host/api/public/system/TeamNetwork/ObjectAppService/Create
```

- Вместо `your-host` укажите адрес экземпляра **{{ productName }}**.
- В теле запроса (`body`) укажите системное имя шаблона записи (например, `"Car"`).
- В ответ на запрос **{{ productName }}** вернёт ID созданного шаблона записи (например, `"oa.1"`).

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Методы Solution API][api_solution]_
- _[Методы System Core API][api_system_core]_
- _[Методы Web API][api_web]_
- _[Ключи аутентификации][authentication_keys]_
- _[Системные роли. Определения, настройка, объединение, удаление][system_roles]_

</div>
{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
