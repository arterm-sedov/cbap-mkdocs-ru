# Сводка: что из черновиков ПМ не вошло в статью ai_features_guide

**Статус:** открытых пропусков **нет**. Все перечисленные ниже пункты **включены** в статью [Инструкции по применению новых возможностей ИИ в платформе](ai_features_guide.md). Сводка сохранена для истории и вычитки.

Ограничения и планы развития (только системный чат, будущие сценарии со своими чатами) вынесены в конец статьи: [Ограничения и планы развития](ai_features_guide.md#ai_features_guide_limits_and_roadmap).

---

## Из «Инструкция по настройке адаптера и операций» (Excel / .md)

| Что было потеряно или сокращено | Где в черновике | Статус в статье |
|----------------------------------|------------------|------------------|
| **Полные JSON** для каждой из 8 операций (MockNavigation + MessageToNavigation) с конкретными id (objectId 469, template oa.13, form form.287, datasetId lst.262, columns ds.2288…, filter/sorting/paging, dataformChanges с fw.1879 и т.д.) | Таблица, строки 5–12 | ✅ Добавлен раздел [Полные примеры JSON по операциям](ai_features_guide.md#ai_features_guide_full_json): восемь подразделов, по одному на бизнес-задачу, с полными JSON и пояснениями. |
| **Конкретные примеры ключевых фраз** для MessageToNavigation: «Открой экземпляр шз1», «Покажи список таблицы 1», «Создай тестовую запись», «Открой мне мою задачу», «Найди мне все Записи с значением: Тест», «Открой Дашборды», «Найди мне текстовое поле» | Таблица, колонка MessageToNavigation | ✅ Таблица [Примеры ключевых фраз и ответов](ai_features_guide.md#ai_features_guide_operations_examples) и те же фразы в полных JSON. |
| **Уточнённое предусловие для списка**: «Настроен список с вынесенными колонками, **2 фильтрами и одной сортировкой**» | Строка 36 | ✅ В разделе «Открыть настроенный список» и в полном JSON: «двумя фильтрами и одной сортировкой». |
| **Пошаговое предусловие для «Создание записи»**: «Нажать F12 → Создать новый экземпляр записи → Заполнить данные → Нажать Сохранить» | Строка 51 | ✅ В разделе «Создание записи» и в полном JSON: F12 → создать экземпляр → заполнить данные → Сохранить → Network → Execute → Response. |
| Комментарий по списку: **datasetId** — id таблицы; **ds** и **direction** смотреть в F12 → Network → Query → Payload (в черновике опечатка «Qery») | Комментарии в таблице | ✅ В перечне операций и в полном JSON: datasetId, ds, direction, F12 → Network → Query → Payload. |

---

## Из «Использование сценариев» (.md / .docx)

| Что было потеряно или сокращено | Где в черновике | Статус в статье |
|----------------------------------|------------------|------------------|
| **Полный пример промпта для LLM** (классификация: Клиент / Сделка / Не определено) с правилами и примерами фраз пользователя | Блок «Формирование сообщения для LLM» | ✅ Полный пример промпта в блоке кода в разделе [Формирование сообщения для LLM](ai_features_guide.md#ai_features_guide_form_message_llm). |
| **Формулировка «1 сценарий = миниагент»** | «1 сценарий – миниагент, описан ниже» | ✅ В разделе лоу код агентов: «такой сценарий выступает мини-агентом». |
| **Планы по развитию**: «В будущем будут сценарии со своими чатами», «появится возможность выбора: системный чат или чат сценария (сейчас только системный)» | Несколько мест в тексте | ✅ В блоке «Получение сообщения из чата»: «В будущем появятся сценарии со своими чатами и возможность выбора…». |
| **Пометка «Это новый блок»** для события «Получение сообщения из чата» | Перед описанием блока | ✅ «Это новый блок события.» в начале подраздела. |
| **Второй пример операции в JSON** («Создать сделку»: objectId cmw.temp.2, template oa.2, form form.144) | После первого JSON «Создать компанию» | ✅ Второй полный JSON «Создать сделку» в разделе [Формирование операций (кнопок)](ai_features_guide.md#ai_features_guide_form_operations). |
| **Уточнение про complexObjectChanges**: «НЕ ИСПОЛЬЗУЕТСЯ. ЗАДУМКА не реализована. НЕ ПОКАЗЫВАТЬ В ДОКУМЕНТАЦИИ.» | В черновике | ✅ В статье: «complexObjectChanges — служебное поле; не используется, на поведение не влияет»; в полных JSON — примечание «Поле complexObjectChanges зарезервировано и не используется». |
| **Подраздел «Результат вызова»** в блоке про тестирование mock | В конце «Тестирование моковых операций» + изображение | ✅ Подраздел [Результат вызова](ai_features_guide.md#ai_features_guide_mock_result): текст без изображения. |
| **Дедлайн «ЧЕТВЕРГ 5 ФЕВРАЛЯ»** | В начале «Использование сценариев» | ⏭ Не включён (внутренняя пометка ПМ; в пользовательскую документацию не вносится). |

---

## Уже было учтено в статье до данной сводки

- Все шаги настройки подключения (ключ API, адаптер, подключение, путь, параметры Интеграции).
- ResponseWithMocks и пояснение про Mocks (исправлена опечатка «ResponceWithMock»).
- Все 8 типов операций и поля MockNavigation/MessageToNavigation.
- Предусловия (список, атрибуты ОГРН/ИНН/Адрес, F12 для создания записи и дашборда).
- Структура сценария (событие чата, Message, отправка в LLM, условия, operation, отправка в чат).
- Динамические операции и экранирование `{{`/`}}` в FORMAT().
- UserCommand и пример «Проанализировать звонок» / «Звонок».

---

## Ссылки на Diátaxis (использованы в статье)

- [How-to guides](https://diataxis.fr/how-to-guides/) — инструкции по задачам.
- [Reference](https://diataxis.fr/reference/) — справочник по операциям и JSON.
- [Tutorials](https://diataxis.fr/tutorials/) — обучающие сценарии (при разделении материала).
- [Explanation](https://diataxis.fr/explanation/) — объяснение возможностей ИИ в платформе (при отдельной статье).

---

## Финальная проверка по черновикам (validation)

Сверка выполнена по файлам: _Инструкция по настройке адаптера и операций.md_, _Использование сценариев.md_.

### Инструкция по настройке адаптера и операций

| № в черновике | Модуль / заголовок | Проверка в статье |
|---------------|---------------------|--------------------|
| 1 | Получения ключа для работы с api сбер | ✅ Шаги 1–5 + «ключ понадобится в пути» (adapter_api_key). |
| 2 | Создание адаптера | ✅ Шаги + название _Искусственный интеллект_, _AIAdapter.zip_ (adapter_create). |
| 3 | Создание Подключения | ✅ Шаги + Создать → Пользовательское подключение → AI agent Adapter (connection_create). |
| 4 | Создание пути передачи данных | ✅ Путь, подключение, тип GigaChat, все 5 параметров Интеграции (Llm Model, Api Key, OAuth Endpoint, OAuth Scope, Endpoint), ResponseWithMocks и Mocks (route_create). |
| 5 | Открыть экземпляр шз | ✅ MockNavigation + MessageToNavigation в перечне и в полных JSON (op_open_instance, full_json_open_instance). |
| 6 | Открыть настроенный список | ✅ Предусловие (2 фильтра, 1 сортировка), query (datasetId lst.262, columns, filter, sorting, paging), MessageToNavigation, F12/Query/Payload (op_open_list, full_json_open_list). |
| 7 | Актуализация данных | ✅ Предусловие ОГРН/ИНН/Адрес, UserCommandPageOperation (event.1333, ObjectId 469), MessageToNavigation с двумя операциями (op_actualize, full_json_actualize). |
| 8 | Создание записи | ✅ Предусловие F12 → создать экземпляр → заполнить → Сохранить, dataformChanges/widgetChanges (fw.*, literal), Execute/Response, MessageToNavigation (op_create_record, full_json_create_record). |
| 9 | Открытие задачи | ✅ TaskNavigationPayload taskId 474, MessageToNavigation (op_open_task, full_json_open_task). |
| 10 | Поиск записей | ✅ GlobalSearchNavigationPayload SearchText «Тест», MessageToNavigation (op_search, full_json_search). |
| 11 | Переход в детализацию дашбордов | ✅ Предусловие детализация с фильтром, ChartNavigationPayload/ChartQuery (dwc.14, columns, filter), F12/Get/Payload, MessageToNavigation (op_dashboard, full_json_dashboard). |
| 12 | Навигация на виджет | ✅ FormNavigationPayload + widget fw.1880, objectId 469, MessageToNavigation (op_navigate_widget, full_json_navigate_widget). |

### Использование сценариев

| Блок / тема в черновике | Проверка в статье |
|--------------------------|--------------------|
| Сценарий: Создай клиента / Создай сделку | ✅ Описание потока сообщение → сценарий → LLM → операция → чат; полный промпт с «Клиент», «Сделка», «Не определено». |
| Настройка блоков: адаптер, подключение, путь, провайдер | ✅ Предусловия lowcode (adapter, connection, route, провайдер GigaChat). |
| Чаты: любые темы, перемещать/удалять/переименовывать | ✅ «В чате можно общаться на любые темы; чаты можно перемещать, удалять и переименовывать». |
| 1 сценарий – миниагент | ✅ «такой сценарий выступает мини-агентом». |
| 1. Получение сообщения из чата | ✅ Новый блок, будущее свои чаты/выбор чата, тип, контекстный шаблон Любой, переменная (Title, Creator), Title = контент. |
| 2. Формирование сообщения для LLM | ✅ Переменная **Message** (системное имя, таблица «запрос» пути), UserMessage, полный промпт (Клиент/Сделка/Не определено). |
| 3. Отправка в LLM | ✅ Подключение и путь от AI adapter, переменная = промпт, ответ = response.Message (плейнтекст). |
| 4. Условия ответа LLM | ✅ Ветки по ответу, маршрут для непредвиденного, дальше обычный сценарий. |
| 5. Формирование операций | ✅ Действие «Изменить значения переменных», порядок (первая выполняется и остаётся), кнопки исчезают после обновления, переменная **operation**, JSON (Создать компанию: cmw.temp.1, oa.1, form.143; Создать сделку: cmw.temp.2, oa.2, form.144), complexObjectChanges не используется. |
| 6. Отправка ответа в чат | ✅ Тело (текст/ответ LLM, простой текст), получатели (системный чат), имя набора с операциями (_action_). |
| Динамические операции | ✅ FORMAT с экранированием `{{`/`}}`, LIST($$Call->id), пример без экранирования; где использовать (mock-поля пути и «Изменить значения переменных»). |
| Тестирование mock | ✅ ResponseWithMocks, все чаты кроме системного, отключение LLM, MockNavigation (массив, без экранирования), UserCommand (Проанализировать звонок, event.910, 629), MessageToNavigation (Звонок, operations, responseText), результат вызова. |

**Итог:** все пункты из обоих черновиков отражены в статье. Открытых пропусков нет. Единственное намеренно не перенесённое — внутренняя пометка «ДЕДЛАЙН ЧЕТВЕРГ 5 ФЕВРАЛЯ».
