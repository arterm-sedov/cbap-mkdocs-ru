---
title: Импорт данных в шаблон
kbId: 4802
---

# Импорт данных в шаблон {: #import_data}

## Введение

Функция импорта данных предусмотрена для шаблонов записей, шаблонов аккаунтов, шаблонов оргединиц и шаблонов ролей.

Поддерживается импорт данных из файлов Excel и CSV.

## Порядок импорта данных

1. Откройте шаблон записи и выберите вкладку «**Импорт**».
2. Прикрепите файл XLSX или CSV в поле «**Файл с данными**».
3. Откроется форма настройки импорта данных.
4. Настройте параметры импорта данных.

    - **Кодировка** — выберите кодировку импортируемого файла.
    - **Разделитель столбцов** — выберите разделитель, используемый в импортируемом файле. Это поле отображается файлов формата CSV.
    - **Часовой пояс** — выберите часовой пояс загружаемых дат.
    - **Игнорировать ошибки парсинга** — установите этот флажок, чтобы загружать данные, даже если в процессе импорта возникли ошибки.
    - **Обновить существующие записи данными из файла** — установите этот флажок, чтобы обновить имеющиеся записи данными из соответствующих строк импортируемого файла и создать отсутствующие записи. Если этот флажок не установлен, для каждой строки в импортируемом файле будет создана новая запись.
        - **Столбец** — выберите ключевой столбец импортируемой таблицы. Ячейки в этом столбце должны содержать уникальные **текстовые** значения, совпадающие (с учётом регистра) со значениями ключевого атрибута в имеющихся записях. Имеющиеся записи будут обновлены импортированными данными из соответствующих строк. Для остальных строк будут созданы новые записи с импортированными данными.
        - **Ключевой атрибут** — выберите атрибут, по значениям которого импортируемые строки будут сопоставляться с имеющимися записями в шаблоне.

    {% include-markdown ".snippets/pdfPageBreakHard.md" %}

    - **Сопоставление данных** — настройте соответствие столбцов импортируемого файла атрибутам шаблона.
        - **Столбец** — заголовок столбца импортируемой таблицы.
        - **Атрибут** — выберите атрибут, в который требуется импортировать значения из столбца. Если оставить это поле пустым, то соответствующий столбец не будет импортирован.
        - **Формат** — выберите формат импортируемой ячейки в соответствии с типом атрибута. См. [требования к импортируемому файлу](#подготовка-импортируемого-файла).
            - Для атрибута типа «**Дата и время**» выберите пункт «**Не задано**» (автоматическое преобразование данных) или формат, соответствующий представлению данных в импортируемом файле.
            - Для атрибута типа «**Число**» или «**Длительность**» выберите формат, соответствующий представлению данных в импортируемом файле.
            - Для атрибута типа «**Запись**», «**Роль**» или «**Организационная единица**» выберите атрибут связанного шаблона **ID** или атрибут **Name** — это [атрибут-заголовок записей][attribute_displayed] связанного шаблона. Выбранный атрибут будет использоваться в качестве ключевого для привязки импортированных записей к связанному шаблону.
            - Для атрибута типа «**Аккаунт**» выберите атрибут шаблона аккаунта: **ID**, **Адрес эл. почты**, **Имя пользователя** или **Ф. И. О.** Выбранный атрибут будет использоваться в качестве ключевого для привязки импортированных записей к аккаунтам.
            - Для атрибутов остальных типов формат данных выбирать не требуется, данные будут преобразованы автоматически.

5. Нажмите кнопку «**Загрузить**».
6. В случае успешного импорта отобразится сообщение «**Данные импортированы**».

_![Настройка импорта данных из файла CSV](img/import_settings.png)_

## Подготовка импортируемого файла {: .pageBreakBefore }

Для корректного импорта данных в шаблон файл в формате XLSX следует подготовить, как указано ниже.

- Все импортируемые данные должны находиться на первом листе. Остальные листы при импорте будут пропущены.
- Первая строка листа должна содержать текстовые заголовки для всех столбцов.
- По возможности удалите столбцы, которые не требуется импортировать.
- Для импорта значений атрибута типа «**Число**» задайте формат ячеек «**Числовой**».
- Для импорта значений атрибута типа «**Дата и время**» задайте формат ячеек  «**Дата**» или «**Время**».
- Для импорта значений атрибута типа «**Длительность**» задайте формат ячеек «**Время**».
- Для импорта значений атрибута типа «**Логический**» задайте формат ячеек «**Общий**» или «**Текстовый**».

    - Ячейки должны содержать значения `ИСТИНА` или ЛОЖЬ (либо `TRUE` или `FALSE`). Пустое значение в ячейке будет преобразовано в значение `ложь`.

- Для импорта значений атрибута типа «**Запись**», «**Аккаунт**», «**Роль**» или «**Организационная единица**» задайте формат ячеек «**Общий**» или «**Текстовый**».

    - Эти ячейки должны содержать уникальные значения, совпадающие (с учётом регистра) со значениями ключевого атрибута в имеющихся записях из связанного шаблона.
    - По совпадающим значениям будет сформирована связь между импортируемыми записями и имеющимися записями в связанном шаблоне.
    - Для остальных импортированных строк в данном атрибуте будет установлено пустое значение. 
    - Для привязки нескольких записей импортируемые ячейки должны содержать ключевые значения, разделённые точками с запятыми без пробелов.

- Для остальных ячеек задайте формат «**Общий**» или «**Текстовый**».

!!! note "Примечание"

    Если в ячейке Excel находится формула, то будет импортировано результирующее значение, вычисленное по формуле, с учётом формата ячейки.

## Практический пример {: .pageBreakBefore }

Рассмотрим пример импорта заявлений на отпуск и решений по ним из файлов формата XLSX в два связанных между собой шаблона: _Заявления на отпуск_ и _Решения по заявлениям на отпуск_. В примере воспользуемся функциями обновления имеющихся записей и установления связей между записями по ключевым атрибутам.

### Подготовка исходных данных

1. Создайте [accounts][accounts] с перечисленными ниже **Ф. И. О.**: _Иванов И. И., Кулагина А. Н., Филиппов К. В., Журавлёва Т. С., Игнатьев А. Б._ Остальные свойства аккаунтов заполните произвольными сведениями.
2. Создайте шаблон записи _«Заявления на отпуск»_ с указанными ниже атрибутами.

    |Название атрибута|Тип данных|Свойства атрибута|
    |---|---|---|
    |_№ заявления_|Текст|**Использовать как заголовок записей:** флажок установлен<br>**Контролировать уникальность значений:** флажок установлен|
    |_Заявитель_|Аккаунт||
    |_Дата начала_|Дата и время||
    |_Длительность отпуска_|Число|**Количество знаков после запятой:** **0**|

3. Вынесите созданные атрибуты на _основную форму_ и в таблицу «_Все записи_» шаблона _«Заявления на отпуск»._
4. Создайте шаблон записи _«Решения по заявлениям на отпуск»_  с указанными ниже атрибутами.

    |Название атрибута|Тип данных|Свойства атрибута|
    |---|---|---|
    |_Заявления_|Запись|**Связанный шаблон:** _Заявления на отпуск_<br>**Хранить несколько значений:** флажок установлен|
    |_Руководитель_|Аккаунт||
    |_Решение_|Логический||

5. Вынесите созданные атрибуты на _основную форму_ и в таблицу «_Все записи_» шаблона _«Решения по заявлениям на отпуск»._
6. Создайте файл `_Заявления_на_отпуск.XLSX_` и заполните его приведёнными ниже данными (можно скопировать и вставить таблицу).

    |№ заявления|Ф. И. О. заявителя|Дата заявления|Длительность|
    |---|---|---|---|
    |_1_|_Иванов И. И._|16.02.2024|_5_|
    |_2_|_Кулагина А. Н._|25.03.2024|_20_|
    |_3_|_Филиппов К. В._|01.08.2024|_15_|
    |_4_|_Журавлёва Т. С._|15.05.2024|_30_|

7. Задайте формат ячеек в файле `_Заявления_на_отпуск.XLSX_`, как указано ниже.

    |Столбец|Формат ячеек|
    |---|---|
    |№ заявления|**Общий**|
    |Ф. И. О. заявителя|**Текстовый**|
    |Дата начала|**Дата**|
    |Длительность|**Числовой<br>Количество знаков после запятой: 0**|

8. Создайте файл `_Решения_по_заявлениям_на_отпуск.XLSX_` и заполните его приведёнными ниже данными (можно скопировать и вставить таблицу).

    |№ заявления|Руководитель|Решение|
    |---|---|---|
    |_1;2_|_Игнатьев А. Б._|_ЛОЖЬ_|
    |_3;4_|_Игнатьев А. Б._|_TRUE_|

9. Задайте формат ячеек в файле `_Решения_по_заявлениям_на_отпуск.XLSX_`, как указано ниже.

    |Столбец|Формат ячеек|
    |---|---|
    |№ заявления|**Общий**|
    |Руководитель|**Текстовый**|
    |Решение|**Общий**|

10. Создайте в шаблоне записи _«Заявления на отпуск»_ одну запись и заполните её поля следующими данными:

    |Поле|Значение|
    |---|---|
    |№ заявления|_1_|
    |Заявитель|_Филиппов К. В._|
    |Дата начала|_25.03.2024_|
    |Длительность отпуска|_30_|

### Импорт данных в шаблоны {: .pageBreakBefore }

1. Откройте шаблон _«Заявления на отпуск»_ и выберите вкладку «**Импорт**».
2. В поле «**Файл с данными**» выберите файл _Заявления_на_отпуск.XLSX._
3. Установите флажок «**Обновить существующие записи данными из файла**» и настройте обновление:

    - **Столбец:** _№ заявления_
    - **Ключевой атрибут:** _№ заявления_

4. Настройте **сопоставление данных** следующим образом:

    |Столбец|Атрибут|Формат|
    |---|---|---|
    |_№ заявления_|_№ заявления_||
    |_Дата начала_|_Дата начала_|**Не задано**|
    |_Длительность_|_Длительность отпуска_|**Целое число**|
    |_Ф. И. О. заявителя_|_Заявитель_|**Ф. И. О.**|

5. Нажмите кнопку «**Загрузить**».

    _![Настройка импорта данных в шаблон «Заявления на отпуск»](img/import_settings_to_vacations.png)_

6. Перейдите на вкладку «**Свойства**» шаблона _«Заявления на отпуск»_ и нажмите кнопку «**Перейти к экземплярам**»
7. Отобразится список всех заявлений на отпуск.
8. Заявление № 1 должно быть обновлено и должны появиться три новых заявления в соответствии с импортированными данными.

      _![Импортированные заявления на отпуск](img/import_added_records_to_vacation.png)_

9.  Откройте шаблон _«Решения по заявлениям на отпуск»_ и выберите вкладку «**Импорт**».
10. В поле «**Файл с данными**» выберите файл _Заявления_на_отпуск.XLSX._
11. Настройте **сопоставление данных** следующим образом:

    |Столбец|Атрибут|Формат|
    |---|---|---|
    |_№ заявления_|_Заявления_|**Name**|
    |_Решение_|_Решение_||
    |_Руководитель_|_Дата начала_|**Ф. И. О.**|

12. Нажмите кнопку «**Загрузить**».

    _![Настройка импорта данных в шаблон «Решения по заявлениям на отпуск»](img/import_data_settings.png)_

13.  Перейдите на вкладку «**Свойства**» шаблона _«Решения по заявлениям на отпуск»_ и нажмите кнопку «**Перейти к экземплярам**»
14. Отобразится список всех решений по заявлениям.
15. В списке должно быть два решения, каждое по двум заявлениям на отпуск.
16. Перейдите на вкладку «Свойства» шаблона _«Заявления на отпуск»_  и нажмите кнопку «Перейти к экземплярам»
17. Отобразится два решения, каждое по двум заявлениям на отпуск.

    _![Импортированные решения по заявлениям на отпуск](img/import_added_records_to_decisions.png)_

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Шаблоны. Определения, создание, настройка, перенос между приложениями, архивирование, очистка, удаление][templates]_
- _[Атрибут-заголовок записей шаблона][attribute_displayed]_
- _[Аккаунты. Создание, настройка, замещение, привязка к шаблону аккаунта, назначение лицензий, удаление][accounts]_

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}