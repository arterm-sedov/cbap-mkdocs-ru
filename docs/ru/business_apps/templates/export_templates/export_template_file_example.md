---
title: Пример использования шаблона экспорта
kbId: 4795
tags:
  - шаблон экспорта
  - настройка файла шаблона экспорта
  - настройка шаблона экспорта
  - файл шаблона экспорта
  - DOCX
  - Word
  - XLSX
  - Excel
  - поля-заполнители
  - поля шаблона экспорта
  - синтаксис полей шаблона экспорта
  - экспорт данных
  - атрибут-заголовок записи
hide:
  - tags
---

# Пример настройки и использования шаблона экспорта авансового отчёта {: #export_template_file_example}

## Порядок настройки

1. Создайте три **[шаблона записи][record_templates]**:

    * _Заявки_
    * _Затраты_
    * _Тип затрат_

2. В шаблоне _«Заявки»_ создайте атрибуты:

    * _Номер заявки_
        * **Системное имя**: `Nomerzayavki`
        * **Тип данных**: **текст**
    * _Время подачи_
        * **Системное имя**: `Datapodachi`
        * **Тип данных**: **дата и время**
    * _Затраты_
        * **Системное имя**: `Zatraty`
        * **Тип данных**: **запись**
        * **Связанный шаблон**: _Затраты_
        * **Хранить несколько значений**: флажок установлен
    * _Итоговая сумма затрат_
        * **Системное имя**: `Itogovayasummazatrat`
        * **Тип данных**: **число**

3. В шаблоне _«Затраты»_ создайте атрибуты:

    * _Тип затрат_
        * **Системное имя**: `Tipzatrat`
        * **Тип данных**: **запись**
        * **Связанный шаблон**: _Тип затрат_
    * _Сумма_
        * **Системное имя**: `Summa`
        * **Тип данных**: **число**
    {% include-markdown ".snippets/pdfPageBreakHard.md" %}

4. В шаблоне _«Тип затрат»_ создайте атрибуты:

    * _Название_
        * **Системное имя**: `Nazvanie`
        * **Тип данных**: **текст**

5. Вынесите созданные атрибуты на формы в шаблонах.
6. Создайте несколько наглядных записей:

    * справочник типов затрат;
    * затраты с указанием их типа;
    * заявки с указанием затрат.

7. Создайте файл шаблона экспорта `advance_report.xlsx`, показанный на иллюстрации:

    *![Файл шаблона экспорта «Авансовый отчёт»](export_template_file_example_advance_report.png)*

8. Создайте в шаблоне записи «_Заявки_» [шаблон экспорта][export_templates] «_Авансовый отчёт_» с файлом `advance_report.xslx`.
9. Вместе с шаблоном экспорта будет автоматически создана [кнопка экспорта записи][export_template_button_configure] «_Авансовый отчёт_».
10. Вынесите кнопку «_Авансовый отчёт_» на форму шаблона записи «_Заявки_».
11. Откройте любую запись шаблона «_Заявки_».
12. Нажмите кнопку «_Авансовый отчёт_».
13. Браузер скачает файл следующего вида (с именем, заданным в [свойствах шаблона экспорта][export_templates]):

    *![Файл, сформированный по шаблону экспорта](export_template_file_result.png)*

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Настройка шаблона экспорта с использованием C#][export_template_csharp_configure]_
- _[Настройка выгрузки нескольких коллекций и изображений][export_template_csharp_collection_download]_
- _[Настройка шаблона экспорта][export_templates]_
- _[Подготовка файла шаблона экспорта][export_template_file_configure]_
- _[Настройка кнопки экспорта][export_template_button_configure]_

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}