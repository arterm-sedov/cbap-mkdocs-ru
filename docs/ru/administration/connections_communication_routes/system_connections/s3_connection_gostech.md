---
title: Хранилище S3
tags:
  - подключение
  - подключения
  - AD
  - Active Directory
hide:
  - tags
kbId: 
---

# Хранилище S3. Настройка экземпляра ПО и подключения {: #s3_connection }

## Введение

ПО **{{ productName }}** может хранить загруженные пользователями и сформированные системой файлы в хранилище S3:

- файлы, прикреплённые к атрибутам типа «Документ» и «Изображение»;
- файлы, загруженные на странице «Темы»;
- файлы шаблонов экспорта;
- файлы с исходным кодом адаптеров;
- резервные копии экземпляра ПО;
- загруженные файлы изображений для баннеров;
- изображения профилей аккаунтов;
- загруженные изображения фона страниц входа и регистрации;
- временные файлы экземпляра ПО.

Здесь представлены инструкции по настройке конфигурации экземпляра ПО под управлением Linux для подключения к хранилищу S3 с целью хранения файлов в контейнерах (корзинах) S3.

После настройки экземпляра ПО и подключения к хранилищу S3 файлы, загруженные пользователями и сформированные системой будут отправляться в хранилище S3, а в конфигурации резервного копирования можно будет указать контейнер S3 вместо пути на сервере с экземпляром ПО.

## Настройка конфигурации экземпляра ПО {: .pageBreakBefore }

1. Перед тем как развёртывать **{{ productName }}** измените в конфигурационном файле `values.yaml` Helm-чарта следующие директивы:

    ``` yaml
    ...
    # Адрес сервера S3 с указанием порта, идентификатор ключа доступа и секретный ключ
    s3.default.endpointURL: http://<s3hostname>:<s3port>
    s3.default.accessKey: xxxxx
    s3.default.secretKey: xxxxx
    # Установите значение true, если сервер принимает только запросы path-style вида:
    # https://<s3hostname>/bucket-name/key-name
    s3.default.pathStyle: true
    s3.default.description: Подключение к S3

    # Параметры контейнера загруженных файлов
    userStorage.type: S3
    userStorage.s3.bucket: user-files-bucket
    userStorage.s3.connection: default

    # Параметры контейнера временных файлов
    tempStorage.type: S3
    tempStorage.s3.bucket: temp-files-bucket
    tempStorage.s3.connection: default
    ...
    ```

2. Сохраните файл конфигурации.
3. Разверните экземпляр ПО. См. _«[Установка и инициализация ПО][deploy_guide_linux]»_.
4. Проверьте подключение хранилищу S3 в экземпляре ПО.

## Проверка подключения к хранилищу S3 {: .pageBreakBefore }

1. Перейдите в [список подключений][connections].
2. Дважды нажмите в списке подключение типа «**S3**» (название подключения задаётся директивой `s3.default.description` в [файле конфигурации](#настройка-конфигурации-экземпляра-по)).
3. Просмотрите свойства подключения:
    - **Отключить** — этот флажок установлен, если подключение неактивно;
    - **Название** — наглядное наименование подключения;
    - **Адрес конечной точки** — адрес сервера S3;
    - **Ключ доступа** — идентификатор секретного ключа доступа к серверу S3;
    - **Секретный ключ** — ключ для доступа к серверу S3;
    - **Запросы типа path-style** — флажок установлен, если сервер принимает только запросы path-style вида:

        ```
        https://s3.region-code.amazonaws.com/bucket-name/key-name
        ```

4. Нажмите кнопку «**Проверить соединение**».
    - Должно отобразиться сообщение «**Соединение установлено**».

**![Настройка подключения к хранилищу S3](https://kb.comindware.ru/assets/img_65e9b87a6e895.png)**

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Установка и инициализация ПО][deploy_guide_linux]_

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
