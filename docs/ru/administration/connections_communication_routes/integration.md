---
title: 'Интеграция с внешними системами. Общие рекомендации'
kbTitle: 'Интеграция Comindware Platform с внешними системами. Общие рекомендации'
kbId:
tags:
    - интеграции
    - интеграция
hide: tags
---

# Интеграция с внешними системами. Общие рекомендации

<div class="admonition question" markdown="block">
## Определения {: .admonition-title #definitions}

**Интеграция** — это автоматизированный процесс взаимодействия **{{ productName }}** с внешними системами, направленный на двусторонний обмен данными и синхронизацию процессов. Реализуется через REST API, OData, заказные адаптеры и сторонние решения.

</div>

## Роли {{ productName }} в интеграциях

**{{ productName }}** может как получать, так и передавать данные в формате JSON или XML, в том числе одновременно и асинхронно.

В зависимости от роли отличается процесс его настройки **{{ productName }}**.

**{{ productName }}** предоставляет **REST API**. Чтобы посмотреть и протестировать доступные методы в интерфейсе Swagger, откройте следующий URL в браузере:

``` html
http://your-host/docs
```

Здесь `your-host` — адрес сервера **{{ productName }}**.

Для доступа к интерфейсу Swagger требуется авторизация с соответствующими правами.

Подробные сведения см. в _[Справочнике по API][api_intro]_.

### Получение запросов от внешних систем

**{{ productName }}** может получать запросы от внешних систем.

Получение данных из внешних систем может происходить в двух режимах:

- ожидание входящих запросов от внешних систем;
- отправка запроса во внешнюю систему и обработка ответа.

Получение данных посредством запроса во внешние системы можно осуществлять по таймеру.

Для доступа к API и внесения изменений в данные **{{ productName }}** внешняя система должна быть авторизована через аккаунт, которому предоставлены соответствующие права. См. _«[Системные роли. Определения, настройка, объединение, удаление][system_roles]»_.

### Отправка запросов во внешние системы

**{{ productName }}** может отправлять запросы во внешние системы.

Встроенные HTTP-адаптеры позволяют использовать методы `PUT`, `POST`, `DELETE` для изменения данных во внешних системах, а также метод `GET` для получения данных из них.

Для передачи данных во внешние системы их следует преобразовать в необходимый формат.

Двустороннюю синхронизацию данных можно осуществлять по таймеру с требуемым интервалом времени.

Для подключения к внешним системам экземпляр ПО **{{ productName }}** должен пройти авторизацию с соответствующими правами.

## Возможности интеграций

**{{ productName }}** предоставляет гибкие инструменты для автоматизации обмена данными с внешними системами с перечисленными ниже возможностями.

### Преимущества интеграций

- **Поддержка различных протоколов и форматов**
    - Поддержка стандартных протоколов и форматов.
    - Использование методов RESTful API.
    - Передача данных в форматах JSON, XML и особых фирменных форматах.
    - Транзакционная обработка данных.
- **Готовые решения и заказная разработка**
    - Готовые модули для интеграции с популярными системами.
    - Возможность разработки специализированных адаптеров.
- **Гибкая настройка и управление интеграциями**
    - Гибкая настройка сценариев обмена данными любой сложности.
    - Поддержка отправки, получения и двусторонней синхронизации данных.
    - Обмен данными по таймерам.
    - Настройка подключений и путей передачи данных.
    - Определение ролей систем и направлений интеграции.
- **Автоматизация и оптимизация процессов**
    - Минимизация ручного ввода данных.
    - Уменьшение количества ошибок за счёт автоматизации.
    - Распределение функциональной нагрузки между интегрируемыми системами.
    - Масштабирование бизнес-процессов.
- **Интеграция оборудования**
    - Использование в бизнес-процессах данных от специализированных устройств и аппаратуры.
    - Обмен данными с любыми техническими средствами и управление ими.

### Передача произвольных данных

С помощью интеграций можно передавать любые данные, например:

- **текстовые данные** – информация в виде строк и сообщений;
- **числовые данные** – параметры и показатели в виде целых, десятичных, шестнадцатеричных чисел;
- **дата, время и длительность** – временные метки и интервалы;
- **файлы** – документы, изображения, цифровые подписи и файлы любых типов;
- **двоичные данные** – информация в специализированных бинарных форматах.

### Решение бизнес-задач

С помощью интеграций можно решить следующие задачи:

- синхронизация данных;
- загрузка исторических данных;
- подключение оборудования и внедрение его в процессы;
- обмен данными с внешними системами, в том числе:
    - сервисы электронной почты
    - СФЕРА Курьер
    - СУБД
    - 1С
    - СберКорус
    - Bitrix24
    - Телфин
    - Novofon
    - OnlinePBX
    - Megaplan
    - Telegram
    - SAP
    - DocuSign
    - Private Branch Exchange
    - MS Dynamics
    - MailChimp
    - Unisender
    - UiPath
    - Viber

## Механизмы и выбор интеграций

Прежде чем приступать к настройке интеграции, ознакомьтесь с доступными типами и их особенностями:

| Критерий | Стандартные интеграции | OData | Кастомные адаптеры | API |
|----------|------------------------|--------|-------------------|-----|
| Гибкость | Средняя | Высокая | Высокая | Высокая |
| Назначение | Готовые решения для популярных систем | Синхронизация данных с ERP/CRM | Работа с нестандартными протоколами и оборудованием | Универсальная интеграция через API |
| Требуемые навыки | Low-code-разработка | <p>Low-code-разработка</p><p>Знание стандарта OData</p> | Программирование | Программирование |
| Время настройки | 1–2 часа | 2–4 часа | 1+ неделя | 4–6 часов |

## Преимущества разных типов интеграций

**{{ productName }}** поддерживает несколько подходов к интеграции, каждый из которых решает специфические задачи.

Ниже представлены ключевые особенности и преимущества каждого подхода.

### Стандартные интеграции

Готовые решения для популярных систем с использованием HTTP-запросов, SMTP и IMAP.

**Преимущества**

- Быстрое подключение: минимум настроек — достаточно настроить подключение, аутентификацию и сопоставление данных.
- Поддержка специализированных процессов: помимо сценариев можно настроить обработку данных непосредственно в бизнес-процессе.
- Низкий порог входа: не требуются навыки программирования.

**Пример:** отправка и получение электронной почты.

### Интеграции по OData

Автоматическая двусторонняя синхронизация данных между **{{ productName }}** и внешними системами по протоколу OData.

**Преимущества**

- Автоматизация по расписанию: данные обновляются без ручного вмешательства.
- Не требуется настройка сценариев: достаточно настроить подключение, аутентификацию и параметры синхронизации.
- Полная синхронизация: поддерживается массовая выгрузка и загрузка записей.

**Пример:** обмен данными с 1С.

### Заказные адаптеры

Решение для интеграции с системами, использующими проприетарные протоколы или оборудование.

**Преимущества**

- Работа с нестандартными протоколами и оборудованием: можно реализовать взаимодействие по проприетарным протоколам и с аппаратным обеспечением.
- Нестандартная обработка данных: при настройке адаптера можно создать уникальную структуру обрабатываемых данных

**Пример:** вывод этикеток с QR-кодами на принтер.

### Интеграция по REST API

**Преимущества**

- Стабильность: методы API обычно не меняются в пределах мажорной версии ПО, либо обеспечивается их обратная совместимость.
- Безопасность: API предоставляет расширенные возможности для настройки аутентификации и авторизации.
- Стандартизация: API позволяет автоматизировать процессы обмена данными в стандартном формате JSON или XML.

**Пример:** создание записей посредством API.

## Общий порядок настройки

Чтобы настроить интеграцию, выполните следующие шаги:

1. Определите, какая система является отправителем данных, а какая — получателем.
2. Определите структуру и формат передаваемых данных.
3. Настройте сопоставление данных между **{{ productName }}** и внешней системой:

    - В **{{ productName }}** настройте необходимые шаблоны и атрибуты.
    - Во внешней системе настройте требуемую модель данных, например таблицы и поля.

4. Настройте интеграцию в **{{ productName }}**:

    - **Для OData**
        - Настройте подключение типа «**Подключения REST и OData**» — «**Синхронизация с веб-сервисом**».
        - Настройте синхронизацию данных с OData-сервисом на странице «**Интеграции**» <i class="fal fa-sync-alt"></i> приложения.

        См. _«[Синхронизация с веб-сервисом. Интеграция по OData][odata_integration]»_.

    - **Для HTTP-запросов, эл. почты и других встроенных адаптеров**
        - Настройте **подключение** к внешней системе.
        - Настройте **путь передачи данных** для сопоставления данных между **{{ productName }}** и внешней системой.
        - Настройте **сценарий** или **бизнес-процесс** для обработки и преобразования данных.

        См. _«[Подключения. Определения, типы, создание, настройка, удаление][connections]»_, _[Пути передачи данных][communication_routes]_, _«[Сценарии. Определение, создание, настройка, использование][scenarios]»_, _«[Диаграмма процесса. Определения, просмотр, редактирование, публикация][process_diagram]»_.

    - **Для заказных адаптеров**
        - Создайте решение Visual Studio с исходным кодом адаптера.
        - Добавьте и скомпилируйте адаптер на странице «**Адаптеры**» <i class="fa-light fa-puzzle-piece-simple">‌</i>.
        - Настройте подключение посредством адаптера.
        - Настройте путь передачи данных для сопоставления данных между **{{ productName }}** и адаптером.
        - Настройте **сценарий** или **бизнес-процесс** для обработки и преобразования данных.

         См. _«[Адаптеры. Определения, настройка, удаление][adapters]»_.

    - **Для REST API {{ productName }}**
        - Настройте в **{{ productName }}** аккаунт, который внешняя система будет использовать для доступа к API.
        - Настройте во внешней системе использование необходимых заголовков аутентификации.
        - Настройте во внешней системе вызов методов API **{{ productName }}**.

        См. _«[Введение в API][api_intro]»_.

### Логика использования подключений и путей передачи данных

Для использования встроенного или заказного адаптера, например для обработки HTTP-запросов или эл. почты, в **{{ productName }}** необходимо настроить **[подключение][connections]** к внешней системе и **[путь передачи данных][communication_routes]**.

- **Подключение** представляет собой канал передачи данных между **{{ productName }}** и внешней системой.
- **Путь передачи данных** представляет собой модель сопоставления данных с внешней системой. Для одного подключения можно настроить несколько путей передачи данных для реализации разной логики сопоставления и преобразования данных.

 См. _«[Подключения. Определения, типы, создание, настройка, удаление][connections]»_, _[Пути передачи данных][communication_routes]_.

## Тестирование HTTP-интеграций

Чтобы проверить корректную работу настроенной интеграции, воспользуйтесь одним из следующих инструментов:

- В командной строке отправьте запрос при помощи Curl и проверьте полученный ответ.
- Используйте сервисы для отладки HTTP-запросов, например:
    - Postman
    - Apidog
    - Insomnia
    - Hoppscotch
    - SoapUI

## Примеры настроек интеграций

### Для работы с электронной почтой

- _[Отправка эл. почты из сценариев по SMTP/Exchange][scenario_send_email]_
- _[Получение эл. почты с помощью сценариев через IMAP и Exchange][scenario_receive_email]_
- _[Отправка почты из процесса][process_sending_connection]_
- _[Получение эл. почты и веб-запросов в процессе][process_receiving_connection]_

### Для работы с HTTP-запросами

- _[HTTP-запросы типа GET. Отправка запроса и обработка ответа в формате JSON][http_send_example]_
- _[HTTP-запросы. Получение JSON-данных в сценарии][http_receive_example]_
- _[HTTP-запросы. Получение и обработка данных с помощью JSONPath][http_receive_jpath]_
- _[HTTP-запросы типа POST. Отправка и получение ответа][http_send_post]_
- _[HTTP-запросы типа POST. Отправка составного содержимого и файлов][http_send_file]_
- _[HTTP-запросы с составным содержимым. Получение файлов в сценарии][http_receive_file]_

### Для работы с СУБД

- _[Внешняя СУБД (MySQL, MSSQL, Oracle, PostgreSQL). Отправка SQL-запроса. Настройка подключения, пути передачи данных и сценария][sql_send_connection]_
- _[Внешняя СУБД (MySQL, MSSQL, Oracle, PostgreSQL). Получение данных по таймеру. Настройка подключения, пути передачи данных и сценария][sql_receive_connection]_

### Для работы с различными сервисами

- _[Синхронизация с веб-сервисом. Интеграция по OData][odata_integration]_
- _[Интеграция с 1С по OData. Настройка для импорта данных][1c_integrations]_
- _[Collabora Online. Настройка подключения][collabora_connection]_
- _[Р7 Офис. Настройка сервера и подключения][r7_connection]_
- _[Отправка запросов данных в «СФЕРА Курьер»][esphere_send_configure]_
- _[Получение документов из «СФЕРА Курьер»][esphere_receive_configure]_
- _[Отправка уведомлений с помощью Telegram-бота][telegram_send_notification]_

## Типичные проблемы и их решения

В процессе настройки и использования интеграции могут возникнуть различные ошибки.

Ниже приведены типичные проблемы и возможные способы их устранения:

- **Некорректно настроено подключение к внешней системе**
    - Проверьте параметры соединения, например адрес сервера и учётные данные, указанные в свойствах подключения.
    - Проверьте соединение в свойствах подключения.
- **Отключено подключение или путь передачи данных**
    - Проверьте, не установлен ли флажок «**Отключить**» в свойствах подключения и пути передачи данных.
- **Неправильно настроены атрибуты сообщений или параметры интеграции**
    - Сверьте настройки пути передачи данных с документацией внешней системы.
    - Проверьте работу интеграции по журналам работы адаптеров.
- **Неправильно названы, структурированы или сопоставлены поля данных**
    - Убедитесь, что системные имена и структура атрибутов сообщений в свойствах пути передачи данных соответствует модели данных во внешней системе.
     Убедитесь в соответствии типов данных в **{{ productName }}** и внешней системе.
    - При необходимости добавьте преобразование типов.
- **Неверно задан формат данных**
    - Убедитесь, что **{{ productName }}** и внешняя система передают данные в одном формате (JSON, XML и т. д.).
    - При необходимости добавьте необходимые действия для преобразование данных, например с помощью сценария.
- **Проблемы с правами доступа**
    - Предоставьте необходимые права аккаунту, который внешняя система использует для доступа к API **{{ productName }}**.
- **Ошибки аутентификации**
    - Проверьте корректность учетных данных в свойствах подключения **{{ productName }}** к внешней системы.
    - Убедитесь, что корректно настроена аутентификация **{{ productName }}** для доступа к API внешней системы.
    - Убедитесь, что используются актуальные токены доступа.
- **Отсутствуют данные в ответе на запрос**
    - Проверьте, корректно ли формируется запрос.
    - Убедитесь, что все обязательные поля заполнены.
    - Протестируйте запрос с помощью инструментов отладки.
- **Ошибки в сценарии или процессе для обмена данными**
    - Удостоверьтесь, что используются корректные структуры данных.
    - Добавьте действия для проверки входящих и исходящих данных.
    - Найдите ошибки с помощью инструментов отладки.

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Введение в API][api_intro]_
- _[Адаптеры. Определения, настройка, удаление][adapters]_
- _[Подключения. Определения, типы, создание, настройка, удаление][connections]_
- _[Пути передачи данных][communication_routes]_
- _[Синхронизация с веб-сервисом. Интеграция по OData][odata_integration]_
- _[Системные роли][system_roles]_
- _[Отладка формул, выражений N3, сценариев и C#-скриптов][expression_debug]_
- _[Подсистема журналирования][logging_engine]_

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
