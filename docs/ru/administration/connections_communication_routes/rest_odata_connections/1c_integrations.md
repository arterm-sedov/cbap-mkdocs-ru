---
title: Интеграция с 1С по OData
kbId: 4698
---

# Интеграция с 1С по OData. Настройка для импорта данных {: #1c_integrations}

## Введение

В **{{ productName }}** можно настраивать интеграции с внешними службами посредством OData без помощи разработчиков — силами аналитика. Для этого достаточно настроить подключение к внешней службе и сопоставление атрибутов между приложением и внешней службой.

После настройки интеграции синхронизацию данных между приложением и внешней службой можно запускать как вручную, так и автоматически.

Здесь представлен пример настройки интеграции с 1С.

## Настройка подключения

1. Создайте новое [подключение для **синхронизации с веб-сервисом**][odata_connection].
2. Настройте свойства подключения:

    - **Название** — наглядное наименование подключения, например _1С_.
    - **Тип исходящего подключения** — **OData**.
    - **Адрес веб-сервиса** — введите URL-адрес OData-сервера 1C.
    - **Тип аутентификации** — **Обычная**.
        - **Имя пользователя** — введите логин для подключения к OData-серверу 1C.
        - **Пароль** — введите пароль для подключения к OData-серверу 1C.
    - **Версия** **OData** — выберите версию протокола OData, которую поддерживает OData-сервер 1C, например V3.
    - **Заголовок** — при необходимости введите заголовки HTTP-запроса к OData-серверу 1C.

3. Нажмите кнопку «**Проверить соединение**».
4. В случае успешного соединения в области «**Результаты**» отобразится список справочников из базы данных 1С. В случае неуспешного соединения — сообщение «**Произошла ошибка**». В таком случае проверьте правильность введенных данных и наличие прав на доступ к службе 1С у пользователя, под которым настраиваете аутентификацию.
5. Сохраните подключение.

_![Настройка подключения к OData-сервису](1c_connection_odata_settings.png)_

## Настройка интеграции {: .pageBreakBefore }

1. Откройте приложение, в котором будете настраивать интеграцию
2. Выберите пункт «**Интеграции**».

    _![Расположение раздела «Интеграции»](1c_connection_integrations_section.png)_

3. Нажмите кнопку «**Создать**».
4. Отобразится окно свойств интеграции.
5. Настройте параметры на вкладке «**Основные настройки**»:

    - **Название** — введите наглядное название интеграции, например _«Номенклатурные объекты»_.
    - **Подключение по** **OData** — выберите ранее созданное подключение для синхронизации с веб-сервисом, например _«1С»_.
    - **Тип** — **Импорт**.
    - **Шаблон записи** — шаблон записи, в который будут импортироваться данные, например _«(1С) Номенклатура. Объекты»_.
    - **Внешняя сущность** — источник данных, из которого будут импортироваться данные в шаблон, например _«Catalog_Номенклатура»_.
    - **Какие объекты синхронизировать** — **Все**.
    - **Тип запуска** — **Вручную**.
    - **Преобразование атрибутов** — настройте сопоставление атрибутов между **шаблоном записи** и **внешней сущностью**:
        - **Внутренние данные** — укажите атрибуты шаблона записи, в которые будут записываться импортируемые данные;
        - **Внешние данные** — укажите атрибут **внешней сущности**, из которых будут импортироваться данные (в нашем примере это поля справочника _«Catalog_Номенклатура»_);
        - **Ключевое свойство** — укажите пару атрибутов, являющихся первичными ключами (primary_key). Если при импорте записи совпадут значения этих атрибутов в имеющейся записи в шаблоне и в импортируемой записи, то запись в шаблоне будет обновлена импортируемыми данными. В противном случае в шаблоне будет создана новая запись с импортированными данными.

    _![Настройка основных свойств интеграции в приложении](1c_connection_properties_settings.png)_

6. Настройте параметры вкладку «**Настройки импорта**»:

    - **Зависит от** — выберите другую интеграцию, синхронизацию по которой необходимо запускать перед текущей интеграцией. В нашем примере выбрана интеграция _«Единица изм.»_, потому что в записях в шаблоне _«(1С) Номенклатура. Объекты»_ указаны единицы измерения и их необходимо актуализировать перед импортом данных.

7. При необходимости настройте параметры постпроцессинга:

    - **Добавить новую настройку постпроцессинга** — нажмите эту кнопку, чтобы настроить устанавливать значения в атрибутах типа «**Запись**» посредством сопоставления значений ключевых атрибутов в импортируемых записях и связанных записях.
    - **Целевой атрибут** — выберите атрибут типа «**Запись**» к которому требуется привязать имеющиеся записи из связанного шаблона, например «_Ед.Изм._».
    - **Атрибут в выбранном шаблоне** — выберите атрибут из шаблона записи, связанного с атрибутом _«Ед.изм.»_, в котором хранятся уникальные значения, с которыми будут сравниваться значения **атрибута в ссылочном шаблоне**;
    - **Атрибут в ссылочном шаблоне** — выберите атрибут из шаблона «_1С_Номенклатуры.Объекты_», в который будут импортироваться уникальные идентификаторы единиц измерения из базы данных 1C.

    !!! warning "Логика постпроцессинга"

        Постпроцессинг позволяет привязать импортируемые записи к имеющимся записям в связанном шаблоне.

        В таблице «**Преобразование атрибутов**» необходимо выбрать ключевые атрибуты связанных шаблонов записи, содержащие уникальные идентификаторы записей, которые требуется связать между собой посредством **целевого атрибута**.

        Эти значения будут сравниваться при импорте записей. Если значения ключевых атрибутов в импортируемой записи и в имеющейся записи связанного шаблона совпадут, то эти записи будут связаны посредством выбранного **целевого атрибута**.

8. Сохраните интеграцию.
9. В списке интеграций установите флажок выбора у настроенной интеграции и нажмите «**Запуск синхронизации**».
10. Затем перейдите в журналы, откройте таблицу «**Интеграция по OData**».
11. При неудачных интеграциях ознакомьтесь с журналом для более детальной информации об ошибках.

_![Настройки импорта данных из 1C](img/1c_connection_import.png)_

_![Журнал сеансов интеграции по OData](img/1c_connection_log.png)_

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Синхронизация с веб-сервисом. Настройка подключения][odata_connection]_
- _[Синхронизация с веб-сервисом. Интеграция по OData][odata_integration]_
- _[Журналы событий][logs]_

</div>

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
