---
title: Урок 8. Экспорт данных
kbId: 5119
---

# Урок 8. Экспорт данных {: #tutorial_hr_lesson_8 }

## Введение {: #tutorial_hr_lesson_8_intro }

В ходе этого урока вы научитесь формировать и экспортировать отчёты по процессу найма персонала с помощью шаблонов экспорта и кнопок в интерфейсе **{{ productName }}**. Вы освоите подготовку шаблона Excel, сопоставление атрибутов, настройку кнопки экспорта и выдачу прав на её использование для HR-менеджера.

**Предусловия:** пройден [урок 2 «Первый реестр данных»][tutorial_hr_lesson_2].

**Расчётная продолжительность:** 50 мин.

## Темы, навыки и задания урока {: #tutorial_hr_lesson_8_taxonomy }

**Темы**

- Подготовка шаблона экспорта
- Сопоставление атрибутов и ячеек Excel
- Экспорт отчёта
- Кнопка

**Навыки**

- Готовить шаблон Excel для экспорта данных
- Создавать кнопку для экспорта
- Экспортировать отчёт

**Задания**

- Перейти в шаблон записи «Кандидаты» и удалить фильтр на колонке таблицы
- В настройках шаблона записи «Кандидаты» перейти в шаблоны экспорта, создать шаблон «Отчет о найме»
- Создать файл Excel, указать в колонках в {} атрибуты ФИО, Оценка за прохождение  собеседования. Вложить файл в шаблон, задать имя выходного файла.
- Перейти в Кнопки – создать кнопку «Экспорт отчета», контекст операции – Запись, операция – Экспорт записи, результат выполнения – Скачать документ, шаблон экспорта – созданный шаблон экспорта.
- Перейти в Таблицы – Все записи, вынести кнопку на тулбар таблицы.
- Перейти в роль HR-менеджер и выдать разрешение на использование кнопки Экспорт отчета

## Определения {: #tutorial_hr_lesson_8_definitions }

- **Шаблон экспорта** — файл (Excel или Word) с заполнителями, куда автоматически подставляются значения атрибутов из системы.
- **Экспорт отчёта** — автоматическое формирование документа на основе шаблона экспорта.
- **Кнопка** — элемент интерфейса, запускающий операцию экспорта данных.
- **Разрешение на использование кнопки** — право пользователя запускать экспорт отчёта.

## Формирование отчёта

!!! question "Настройка шаблона экспорта"
    
    {% include-markdown ".snippets/tutorial_export_steps.md" %}

### Создание файла шаблона экспорта {: #tutorial_hr_lesson_8_excel_template }

1. Создайте файл Excel `Отчет_о_найме.xlsx`.
2. В первой ячейке первой строки укажите заголовок таблицы _«ОТЧЁТ О НАЙМЕ»_.
3. В ячейках на третьей строке укажите названия столбцов для отчёта — _«Ф. И. О. кандидата»_ и _«Оценка за собеседование»_.
4. В ячейках на пятой строке укажите системные имена атрибутов в фигурных скобках — `{ФИО}` и `{Оценказасобеседование}`.
5. Сохраните файл.

!!! warning "Используйте фактические системные имена атрибутов"

    В шаблоне Excel указывайте именно те системные имена, которые используются в вашем приложении.

### Создание шаблона экспорта в системе {: #tutorial_hr_lesson_8_export_template }

1. Перейдите в шаблон записи _«Кандидаты»_.
2. Откройте вкладку **Шаблоны экспорта**.
3. Нажмите «**Создать**».
4. Укажите **название** шаблона экспорта _«Отчёт о найме»_.
5. В поле «**Файл шаблона**» выберите пункт «**Значение**»  и загрузите созданный ранее файл `Отчет_о_найме.xlsx`.
6. В поле «**Имя выходного файла**» выберите пункт «**Значение**» и укажите требуемое имя экспортируемого файла с данными (без расширения файла), например: `Отчёт о найме`.
7. Установите флажок «**Экспортировать как PDF**».
8. Нажмите кнопку «**Сохранить**».

## Настройка кнопки экспорта отчёта

При создании шаблона экспорта автоматически создается кнопка экспорта.

Эту кнопку необходимо добавить на форму или в таблицу, чтобы выгружать данные.

### Проверка кнопки экспорта

Удостоверимся, что кнопка экспорта соответствует нашим требованиям.

1. Перейдите на вкладку «**Кнопки***» шаблона _«Кандидаты»_.*
2. Откройте кнопку _«Отчёт о найме»_
3. Проверьте корректность свойств кнопки:

    - **Отображаемое название** — _Отчёт о найме_
    - **Контекст операции**— **Запись**
    - **Операция —** **Экспорт записи**
    - **Результат выполнения** — **Скачать документ**
    - **Шаблон экспорта** — _Отчёт о найме_

### Добавление кнопки экспорта на форму пользовательской задачи

Поместим кнопку для выгрузки отчёта на форму задачи _«Сформировать и согласовать предложение с кандидатом»_.

1. Откройте шаблон _«Кандидаты»_.
2. Перейдите на вкладку «**Формы**».
3. Создайте новую форму.
4. Введите **отображаемое название** формы — _«Выгрузка отчёта»_.
5. Измените **отображаемое название** автоматически созданной **новой области** на _«Выгрузка отчёта»_.
6. Выделите область кнопок _«Выгрузка отчёта»_ и перетащите на неё кнопку _«Отчёт о найме»_.
7. Сохраните форму.
8. Откройте диаграмму процесса _«Найм персонала»_.
9. Нажмите кнопку* «**Редактировать**».
10. Выберите задачу _«Сформировать и согласовать предложение с кандидатом»_ и в меню элемента нажмите кнопку «**Форма**» <i class="fa-light fa-newspaper">‌</i>.
11. Разверните в панели элементов шаблон _«Кандидаты»_
12. Перетащите форму _«Выгрузка отчёта»_ над формой _«Кандидаты — Основная форма»_.
13. Сохраните форму задачи.
14. Опубликуйте диаграмму процесса _«Найм персонала»_.

### Настройка разрешения на использование кнопки экспорта

Для того, чтобы _HR-менеджер_ мог воспользоваться кнопкой _«Отчёт о найме»_, необходимо предоставить ему соответствующее разрешение с помощью роли _«HR-менеджер»_.

1. Откройте раздел «**Роли***» приложения _«Управление персоналом»_.
2. Откройте роль _«HR-менеджер»_.
3. Перейдите на вкладку «**Разрешения**».
4. Раскройте в панели ресурсов шаблон _«Кандидаты»_.
5. Перетащите кнопку _«Отчёт о найме»_ на таблицу разрешений.
6. Установите для кнопки _«Отчёт о найме»_ разрешение «**Использование кнопки**»*.
7. Сохраните роль.

## Итоги урока {: #tutorial_hr_lesson_8_summary }

Вы научились формировать и экспортировать документ по шаблону в формате Excel, подставляя в него фактические данные из приложения.

Поздравляем! Вы завершили курс по автоматизации процесса найма персонала в **{{ productName }}**. Теперь вы можете создавать цифровые решения для HR-задач, автоматизировать процессы, управлять данными и формировать отчёты для руководства.

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
