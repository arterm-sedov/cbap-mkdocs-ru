---
title: 'Атрибуты типа «Изображение» и «Документ». Вывод изображения на форму записи'
kbId: 4975
---

# Атрибуты типа «Изображение» и «Документ». Вывод изображения на форму записи

## Введение

В **{{ productName }}** можно загрузить изображения двумя способами: прикрепив их к атрибуту типа «**Изображение**» или «**Документ**». При этом изображения, прикреплённые к этим атрибутам отображаются только в режиме предпросмотра и не помещаются на форму в полном размере.

Чтобы вывести изображение в полном размере на форму, можно воспользоваться текстовым атрибутом, используя формат отображения «**HTML-текст**».

Здесь представлены настройки по выводу изображений на форму из атрибута типа «**Изображение**» или «**Документ**».

!!! question "Структура атрибута типа «Изображение»"

    --8<-- "attribute_image_logic.md"
    --8<-- "attribute_image_get_file_n3.md"

!!! question "Структура атрибута типа «Документ»"

    --8<-- "attribute_document_logic.md"
    --8<-- "attribute_document_get_file_n3.md"
    --8<-- "attribute_document_get_file_formula.md"

## Прикладная задача

Требуется вывести на форму полноразмерные изображения, которые хранятся в атрибуте типа «**Изображение**» или «**Документ**».

## Исходные данные

В шаблоне _«Карточки товаров»_ (системное имя `ProductCards`) имеются две формы — **основная**, на которой данные заполняют сотрудники, и _«Клиентская форма»_, которая отображается для клиентов.

## Порядок настройки для атрибута тип «Изображение»

1. В шаблоне _«Карточки товаров»_ добавьте атрибут _«Изображения»_ со следующими свойствами:

    - **Системное имя:** _Images_
    - **Тип данных: изображение**
    - **Хранить несколько значений: флажок установлен**

2. Создайте атрибут _«Отображение изображений на форме»_ со следующими свойствами:

    - **Системное имя:** _ImagesView_
    - **Тип данных: текст**
    - **Формат отображения: HTML-текст**
    - **Вычислять автоматически:** флажок установлен
    - **Выражение для вычислений:**
        - **формула**

            ``` cs
            # Из атрибута «Изображения» (Images) собираем изображения
            # и соединяем в HTML с разделителем <br/>
            # 'https://host-name' — имя хоста {{ productName }}
            JOIN("<br/>", from a in $Images select
                FORMAT("<img src='https://your-host{0}'>", 
                LIST(a->uri)
                )
            )
            ```

        **или**

        - **N3**

            ``` turtle
            # Импортируем функции для работы
            # с изображениями и строками
            @prefix object: <http://comindware.com/ontology/object#>.
            @prefix image: <http://comindware.com/ontology/image#>.
            @prefix cmwstring: <http://comindware.com/logics/string#>.
            @prefix string: <http://www.w3.org/2000/10/swap/string#>.
            {
                # Находим атрибут «Изображения» (Images) и помещаем в ?imagesAttribute
                ("ProductCards" "Images") object:findProperty ?imagesAttribute.
                # Запускаем цикл
                from {
                    # Находим содержимое ?imagesAttribute в текущей
                    # записи и помещаем в ?image
                    ?item ?imagesAttribute ?image.
                    # Получаем ссылку на файл без имени хоста
                    # и помещаем в ?imageUri
                    ?image image:uri ?imageUri.
                    # Формируем HTML-строки c изображениями и помещаем в ?formatUri
                    # 'https://host-name' — имя хоста {{ productName }}
                    ("<img src='https://host-name{0}'>" ?imageUri) string:format ?formatUri.
                    }
                # Формируем лист HTML-строк ?uriList из ?formatUri.
                select ?formatUri -> ?uriList.
                # Формируем из ?uriList одну большую строку
                # с разделителем <br/> (перенос строки)
                # и возвращаем её в значение атрибута
                ("<br/>" ?uriList) cmwstring:join ?value.
            }
            ```

3. Поместите атрибут _«Изображения»_ на **основную форму**.
4. Поместите атрибут _«Отображение изображений на форме»_ на форму _«Клиентская форма»_.

### Тестирование

1. Создайте запись в шаблоне _«Карточки товаров»_.
2. Прикрепите изображения к атрибуту _«Изображения»_.
3. С помощью селектора <i class="fa-light  fa-angle-down"></i> перейдите к форме _«Клиентская форма»_.
4. На форме отобразятся прикреплённые изображения.

## Порядок настройки для атрибута типа «Документ»

1. В шаблоне _«Карточки товаров»_ добавьте атрибут _«Фотографии»_ со следующими свойствами:

    - **Системное имя:** _Photos_
    - **Тип данных: документ**
    - **Хранить несколько значений:** флажок установлен

2. Создайте атрибут _«Отображение фотографий на форме»_ со следующими свойствами:

    - **Системное имя:** _PhotosView_
    - **Тип данных: текст**
    - **Формат отображения: HTML-текст**
    - **Вычислять автоматически:** флажок установлен
    - **Выражение для вычислений:**
        - **Формула**

            ``` cs
            # Из атрибута «Фотографии» (Photos) собираем изображения
            # и соединяем в HTML с разделителем <br/>
            # 'https://host-name' — имя хоста {{ productName }}
            JOIN("<br/>", from a in $Photos select
                FORMAT("<img src='https://your-host{0}'/>", 
                LIST(a->currentRevision->httpUri)
                )
            )
            ```

        **или**

        - **N3**

            ``` turtle
            # Импортируем функции для работы
            # с документами и строками
            @prefix object: <http://comindware.com/ontology/object#>.
            @prefix document: <http://comindware.com/ontology/document#>.
            @prefix cmwstring: <http://comindware.com/logics/string#>.
            @prefix string: <http://www.w3.org/2000/10/swap/string#>.
            {
                # Находим атрибут «Изображения» (Photos) и помещаем в ?photosAttribute
                ("ProductCards" "Photos") object:findProperty ?photosAttribute.
                # Запускаем цикл
                from {
                    # Находим содержимое ?photosAttribute в текущей
                    # записи и помещаем в ?photos
                    ?item ?photosAttribute ?photos.
                    # Получаем текущую ревизию документа и
                    # помещаем в ?fileRevision
                    ?photos document:currentRevision ?fileRevision.
                    # Получаем ссылку на файл без имени хоста
                    # и помещаем в ?fileUri
                    ?fileRevision document:httpUri ?fileUri.
                    # Формируем HTML-строки c изображениями и помещаем в ?formatUri
                    # 'https://host-name' — имя хоста {{ productName }}
                    ("<img src='https://host-name{0}'>" ?fileUri) string:format ?formatUri.
                    }
                # Формируем лист HTML-строк ?uriList из ?formatUri.
                select ?formatUri -> ?uriList.
                # Формируем из ?uriList одну большую строку
                # с разделителем <br/> (перенос строки)
                # и возвращаем её в значение атрибута
                ("<br/>" ?uriList) cmwstring:join ?value.
            }
            ```

3. Поместите атрибут _«Фотографии»_ на **основную форму**.
4. Поместите атрибут _«Отображение фотографий на форме»_ на форму _«Клиентская форма»_.

### Тестирование

1. Создайте запись в шаблоне _«Карточки товаров»_.
2. Прикрепите изображения к атрибуту _«Фотографии»_.
3. С помощью селектора <i class="fa-light  fa-angle-down"></i> перейдите к форме _«Клиентская форма»_.
4. На форме отобразятся прикреплённые изображения.

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Атрибут типа «Документ»][attribute_document]_
- _[Атрибут типа «Изображение»][attribute_image]_
- _[Атрибут «Документ». Формирование ссылки на файл][document_uri]_

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
