---
title: Атрибут типа «Список значений». Фильтрация с помощью N3
kbId: 5077
tags:
    - N3
    - выражение на N3
    - тройки
    - тройка
    - список значений
hide:
    - tags
---

# Атрибут типа «Список значений». Фильтрация связанных записей по значению атрибута с помощью N3 {: #enum_attribute_value_filter }

## Введение

В ряде случаев требуется отображать записи с определённым значением атрибута типа «[**Список значений**][attribute_enum]».

Здесь представлен пример настройки фильтрации записей связанного шаблона по значению атрибута типа «**Список значений**».

## Прикладная задача

Имеется шаблон _«Клиенты»_, с которым связан шаблон _«Заявки на перевозку»_. В шаблоне _«Заявки на перевозку»_ имеется атрибут _«Статус»_ типа «**Список значений**».

Требуется выводить на форме заявки таблицу со списком просроченных заявок.

## Исходные данные

- Имеется шаблон записи _«Заявки на перевозку»_ (с системным именем `Заявкинаперевозку`).
- В шаблоне _«Заявки на перевозку»_ есть атрибут _«Статус»_ типа «**Список значений**» с системным именем `Статус` и следующими значениями:

    | Системное имя | RU           |
    | ------------- | ------------ |
    | _Overdue_     | _Просрочена_ |
    | _Timely_      | _В срок_     |
    | _Cancelled_   | _Отменена_   |

- В шаблоне _«Клиенты»_ имеется атрибут _«Заявки на перевозку»_:
    - **Тип данных: Запись**
    - **Системное имя:** `Заявкинаперевозку`
    - **Связанный шаблон:** _Заявки на перевозку_
    - **Хранить несколько значений:** флажок установлен.

## Распределение заявок по значению атрибута список значений

1. Откройте для редактирования форму шаблона _«Клиенты»_.
2. Поместите на форму атрибут _«Заявки на перевозку»_.
3. Настройте представление атрибута _«Заявки на перевозку»_ в виде таблицы.
4. Добавьте в таблицу _«Заявки на перевозку»_ атрибут _«Статус»_.
5. Обавьте в область кнопок таблицы _«Заявки на перевозку»_ кнопку «**Создать**».
6. Поместите повторно на форму атрибут _«Заявки на перевозку»_.
7. Настройте **свойства поля** _«Заявки на перевозку»_:

    - **Отображаемое название:** _Просроченные заявки_
    - **Представление: таблица**
    - **Фильтр — Отображаемые записи: N3**

        ``` turtle
        # Импортируем функции для работы
        # с записями, строками и базой данных.
        @prefix object: <http://comindware.com/ontology/object#>.
        @prefix convert: <http://comindware.com/logics/convertions#>.
        {
            # Находим атрибут «Заявки на перевозку» в шаблоне «Клиенты».
            ("Клиенты" "Заявкинаперевозку") object:findProperty ?TransportRequestsAttribute.
            # Находим атрибут «Статус» в шаблоне «Заявки на перевозку».
            ("Заявкинаперевозку" "Статус") object:findProperty ?StatusAttribute.

            # Берём значения ?TransportRequestsAttribute
            # и помещаем в ?TransportRequiresValue.
            ?item ?TransportRequestsAttribute ?TransportRequiresValue.
            # Находим ID значения Overdue «Просрочена»
            # атрибута «Статус».
            ("Статус" "Overdue") convert:enumValue ?enumIdOverdue.
            # Фильтруем ?TransportRequiresValue
            # по значению ?StatusAttribute равному ?enumIdOverdue.
            ?TransportRequiresValue ?StatusAttribute ?enumIdOverdue.
              
            # Возвращаем отфильтрованные значения из ?TransportRequiresValue.
            ?TransportRequiresValue -> ?value.
        }
        ```

8. Сохраните форму.

## Тестирование

1. Создайте запись в шаблоне _«Клиенты»_.
2. Создайте несколько связанных записей в таблице атрибута _«Заявки на перевозку»_, выбрав разные _статусы_ заявок, включая _«Просрочена»_.
3. В таблице _«Просроченные заявки»_ должны отобразиться соответствующие заявки.

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Атрибут типа «Список значений»][attribute_enum]_
- _[Написание выражений на языке N3][manual_n3]_
- _[Атрибут типа «Список значений». Вычисление значения с помощью N3 и формул][enum_attribute_value_calculation]_

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
