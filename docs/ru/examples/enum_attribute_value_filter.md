---
title: Атрибут типа «Список значений». Фильтрация с помощью N3
kbId: 5077
tags:
    - N3
    - выражение на N3
    - тройки
    - тройка
    - список значений
hide:
    - tags
---

# Атрибут типа «Список значений». Фильтрация связанных записей по значению атрибута с помощью N3 {: enum_attribute_value_filter }

## Введение

Атрибут [типа «**Список значений**»][attribute_enum] может содержать большое число значений. При этом, могут понадобиться записи только с определённым значением данного атрибута.

Здесь представлен пример настройки фильтрации записей связанного шаблона по значению атрибута типа «**Список значений**».

## Прикладная задача

Имеется шаблон _«Заявки»_, с которым связан шаблон _«Заявки на перевозки»_. В шаблоне _«Заявки на перевозки»_ имеется атрибут типа «**Список значений**».

Требуется настроить отображение таблицы связанных записей на форме, отфильтрованных по значению атрибута типа «**Список значений**».

## Исходные данные

- В шаблоне _«Заявки на перевозки»_ есть атрибут _«Тип ТС»_ типа «**Список значений**»:

    | Системное имя |  RU                    |
    | ------------- |  --------------------- |
    | _Bus_         |  _автобус_             |
    | _Car_         |  _легковой автомобиль_ |
    | _Truck_       |  _грузовой автомобиль_ |

- В шаблоне _«Заявки»_ имеется атрибут _«Заявки на транспорт»_ типа «**Запись**», который связан с шаблоном _«Заявки на перевозки»_.
- Атрибут _«Заявки на транспорт»_ может хранить несколько значений.
- Имеется запись шаблона _«Заявки»_, с которой связаны несколько записей шаблона _«Заявки на перевозки»_. В связанных записях выбраны разные значения атрибута _«Тип ТС»_.

## Распределение заявок по значению атрибута список значений

1. В шаблоне _«Заявки»_ создайте атрибут _«Заявки на легковой автомобиль»_ с указанными значениями:

    - **Тип данных: запись**
    - **Связанный шаблон:** _Заявки на перевозки_
    - **Хранить несколько значений:** флажок установлен
    - **Вычислять автоматически:** флажок установлен
    - **Вычисляемое значение: N3**

        ``` turtle
        # Импортируем функции для работы
        # с записями, строками и базой данных.
        @prefix object: <http://comindware.com/ontology/object#>.
        @prefix convert: <http://comindware.com/logics/convertions#>.
        {
            # Находим атрибут TransportRequires (Заявки на транспорт)
            # в шаблоне Requires (Заявки).
            ("Requires" "TransportRequires") object:findProperty ?TransportRequiresAttribute.
            # Находим атрибут TransportType (Тип ТС)
            # в шаблоне TransportationRequires (Заявки на перевозки).
            ("TransportationRequires" "TransportType") object:findProperty ?TransportTypeAttribute.

            # Берём значения ?TransportRequiresAttribute
            # и помещаем в ?TransportRequiresValue.
            ?item ?TransportRequiresAttribute ?TransportRequiresValue.
            # Находим ID значения Car (легковой автомобиль)
            # атрибута TransportType  (Тип ТС).
            ("TransportType" "Car") convert:enumValue ?enumIdCar.
            # Фильтруем ?TransportRequiresValue
            # по значению ?TransportTypeAttribute равному ?enumIdCar.
            ?TransportRequiresValue ?TransportTypeAttribute ?enumIdCar.
              
            # Возвращаем отфильтрованные значения из ?TransportRequiresValue.
            ?TransportRequiresValue -> ?value.
        }
        ```

2. Поместите на форму шаблона _«Заявки»_ атрибут _«Заявки на легковой автомобиль»_.
3. Выберите **представление** атрибута _«Заявки на легковой автомобиль»_ в виде **таблицы**.
4. Сохраните форму.

## Тестирование

1. Откройте запись шаблона _«Заявки»_.
2. В таблице атрибута _«Заявки на легковой автомобиль»_ отобразятся отфильтрованные записи.

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- _[Атрибут типа «Список значений»][attribute_enum]_
- _[Написание выражений на языке N3][manual_n3]_
- _[Атрибут типа «Список значений». Вычисление значения с помощью N3 и формул][enum_attribute_value_calculation]_

</div>

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
