---
title: Атрибут типа «Список значений». Вычисление значения по справочнику
kbId: 4916
---

# Атрибут типа «Список значений». Вычисление значения по справочнику {: #attribute_enum_calculate_registry }

## Введение

Здесь представлен способ вычисления значения атрибута типа «**Список значений**» по справочнику из связанного шаблона.

См. также _[подробное описание и другие примеры использования атрибута типа «Список значений»][attribute_enum]_.

!!! question "Структура атрибута типа «Список значений»"

    --8<-- "attribute_enum_logic.md"

!!! tip "Получение данных из атрибута типа «Список значений» с помощью формулы"

    --8<-- "attribute_enum_get_data_formula.md"

!!! tip "Сравнение и фильтрация значения атрибута с помощью с помощью N3"

    --8<-- "attribute_enum_compare_value_formula.md"

## Прикладная задача

Требуется настроить простейшую форму заказа транспортных услуг со следующей бизнес-логикой:

1. Заказчик создаёт заявку на перевозку и выбирает её тип:

    - автобусная перевозка;
    - грузоперевозка;
    - перевозка на легковом автомобиле;
    - перевозка на микроавтобусе.

2. На форме заявки и в списке заявок должен автоматически отображаться подходящий для выполнения заявки тип транспортного средства с цветовой маркировкой и соответствующим значком.

## Исходные данные

Для выполнения примера создайте указанные в следующей таблице шаблоны и атрибуты.

| **Шаблон записи** | **Название / системное имя атрибута**                 | **Тип атрибута** | **Описание**                                                                  |
| ----------------- | ----------------------------------------------------- | ---------------- | ----------------------------------------------------------------------------- |
| _Типы заявок_     | _Наименование типа заявки_ / `Наименованиетипазаявки` | **Текст**        | Атрибут _«Наименование типа заявки»_ содержит наглядное название типа заявки. |
|                   | _Код типа заявки_ / `Кодтипазаявки`                   | **Текст**        | Атрибут _«Код типа заявки»_ содержит условное обозначение типа заявки.        |
| _Заявки_          | _Тип заявки_ / `Типзаявки`                            | **Запись**       | Атрибут _«Тип заявки»_ связан с шаблоном _«Типы заявок»_.                     |

## Настройка приложения

1. В шаблоне _«Типы заявок»_ создайте четыре записи:

    | Наименование типа заявки         | Код типа заявки |
    | -------------------------------- | --------------- |
    | Автобусная перевозка             | bus             |
    | Грузоперевозка                   | truck           |
    | Перевозка на микроавтобусе       | van             |
    | Перевозка на легковом автомобиле | passengerCar    |

2. Поместите на форму и в таблицу шаблона _«Заявки»_ атрибут _«Тип заявки»._
3. Создайте и поместите на форму и в таблицу шаблона _«Заявки»_ атрибут _«Тип транспортного средства»_:

    - **Тип данных:** **Список значений**
    - **Формат отображения:****Бейдж**
    - **Вычислять автоматически:** флажок установлен
    - **Вычисляемое значение:** **формула**

    ```
     ENUMVALUE("VehicleType",$Типзаявки->Кодтипазаявки)
    ```

    !!! question "Синтаксис формулы"

        - `ENUMVALUE(enumAttributeSystemName, enumValueSystemName)` — эта функция принимает два аргумента: системное имя атрибута типа «**Список значений**» и системное имя одного из значений этого атрибута, и возвращает ID указанного значения.
        - `ENUMVALUE("VehicleType",$Типзаявки->Кодтипазаявки)` — возвращает строку с ID значения атрибута `VehicleType`, соответствующего значению атрибута `Кодтипазаявки` из записи шаблона _«Типы заявок»_, на которую ссылается атрибут `Типзаявки`.
        - Данная формула присваивает атрибуту _«Тип транспортного средства»_ значение, соответствующее  из справочника типов заявок

    - **Список значений:**

    | Системное имя  | RU                    | Цвет                                                             | Значок                                              |
    | -------------- | --------------------- | ---------------------------------------------------------------- | --------------------------------------------------- |
    | `bus`          | _Автобус_             | `#ff0000`{: style="background-color: #ff0000; color: #ffffff;" } | <i class="fa-light fa-bus">‌</i> bus             |
    | `passengerCar` | _Легковой автомобиль_ | `#0000ff`{: style="background-color: #0000ff; color: #ffffff;" } | <i class="fa-light fa-car">‌</i> car             |
    | `truck`        | _Грузовик_            | `#00ff00`{: style="background-color: #00ff00;" }                 | <i class="fa-light fa-truck">‌</i> truck             |
    | `van`          | _Микроавтобус_        | `#ffff00`{: style="background-color: #ffff00;" }                 | <i class="fa-light fa-van-shuttle">‌</i> van-shuttle |

    !!! warning "Важно!"

        Системные имена значений атрибута должны совпадать со значениями атрибута _«Код типа заявки»_ в ранее созданных записях шаблона _«Типы заявок»_: `bus`, `passengerCar`, `truck`, `van`

## Тестирование

1. Создайте запись в шаблоне _«Заявки»_.
2. На форме заявки выберите любой _тип заявки_.
3. В поле _«Тип транспортного средства»_ должны автоматически отображаться соответствующие значения.

    _![Автоматическое вычисление значения атрибута типа «Список значений» по значению атрибута из справочника](https://kb.comindware.ru/assets/enum_field_calculate_by_reference.gif)_

4. Откройте таблицу с записями шаблона _«Заявки»_.
5. Столбец _«Тип транспортного средства»_ должен выглядеть как показано на иллюстрации.

    _![Представление атрибута типа «Список значений» в таблице](https://kb.comindware.ru/assets/img_65b75c467bf5d.png)_

--8<-- "related_topics_heading.md"

- _[Атрибут типа «Список значений»][attribute_enum]_
- _[Атрибут типа «Запись»][attribute_record]_
- _[Атрибут типа «Список значений». Вычисление текущего значения][attribute_enum_calculate_current_value]_
- _[Атрибут типа «Список значений». Вычисление значения по справочнику][attribute_enum_calculate_registry]_
- _[Атрибут типа «Список значений». Фильтрация связанных записей по значению атрибута с помощью N3][attribute_enum_value_filter]_
- _[Атрибут типа «Список значений». Вычисление значения с помощью N3 и формул][attribute_enum_value_calculation]_

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
