---
title: 'Вычисление пользователей с активными задачами'
kbTitle: 'Вычисление пользователей, у которых есть активные задачи (с учетом замещений)'
tags:
    - процессы
    - уведомления
    - N3
    - тройки
    - тройка
    - задачи
    - замещения
    - пользователи
    - аккаунты
    - вычисление
hide:
    - tags
kbId: 4966
---

# Вычисление пользователей с активными задачами {: #n3_calculate_active_task_accounts }

## Введение {: #n3_calculate_active_task_accounts_intro }

В **{{ productName }}** можно вычислить аккаунты всех пользователей, у которых на данный момент есть активные задачи, с учетом всех замещений. Это может быть полезно, например, для запуска подпроцесса отправки уведомлений по задачам.

См. также _«[Периодические напоминания об открытых задачах][n3_periodic_task_notifications]»_.

## Прикладная задача {: #n3_calculate_active_task_accounts_use_case .pageBreakBefore }

Требуется настроить процесс для отправки уведомлений пользователям, у которых есть активные задачи по всем бизнес-процессам, с учетом всех замещений.

Задаче может быть назначен как один исполнитель, так список возможных исполнителей.

Список аккаунтов, у которых есть задачи, необходимо поместить в атрибут типа «**Аккаунт**».

## Исходные данные {: #n3_calculate_active_task_accounts_initial_data }

Имеется несколько шаблонов процессов с пользовательскими задачами, которым назначены различные исполнители.

Имеется шаблон записи _«Уведомления о задачах»_.

## Настройка вычисления {: #n3_calculate_active_task_accounts_configure }

1. В шаблоне _«Уведомления о задачах»_ создайте атрибут _«Исполнители»_ типа «**Аккаунт**».
2. В свойствах атрибута установите флажки «**Хранить несколько значений**» и «**Вычислять автоматически**».
3. Введите следующее **вычисляемое значение** на языке **N3**:

    ``` turtle
    # Импортируем функции для работы 
    # с логикой, контейнерами, аккаунтами и статусами задач.
    @prefix cmw: <http://comindware.com/logics#>.
    @prefix container: <http://comindware.com/ontology/container#>.
    @prefix account: <http://comindware.com/ontology/account#>.
    @prefix taskStatus: <http://comindware.com/ontology/taskStatus#>.
    {
        # Находим класс Account.
        ?class cmw:className "Account".
        # Получаем все объекты этого класса.
        ?value a ?class.
        # Проверяем, что аккаунт активен.
        ?value account:active true.
        # Проверяем, что аккаунт не отключен.
        not {?value cmw:isDisabled true.}.
        # Проверяем, что у аккаунта есть активные задачи.
        or {?tasks cmw:assignee ?value.}
        or {?tasks cmw:possibleAssignee ?value.}.
        # Проверяем, что задача активна.
        ?tasks cmw:taskStatus taskStatus:inProgress.
    }
    ```

3. Поместите атрибут _«Исполнители»_ на форму шаблона _«Уведомления о задачах»_.

## Тестирование {: #n3_calculate_active_task_accounts_test }

1. Запустите несколько процессов.
2. Создайте или откройте запись в шаблоне _«Уведомления о задачах»_.
3. В поле _«Исполнители»_ должен отображаться список пользователей с активными задачами по всем процессам.

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- [Периодические напоминания об открытых задачах][n3_periodic_task_notifications]
- [Настройка процесса для отправки эл.&nbsp;почты][process_email_configure]
- [Уведомления. Типы, назначение, настройка, использование][notification_types]
- [Замещения. Создание, настройка, удаление][substitution]

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
