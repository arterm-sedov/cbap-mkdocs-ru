---
title: 'Подсчет количества записей без учета архивированных'
kbTitle: 'Подсчет количества записей без учета архивированных'
kbId: 4987
tags:
  - COUNT
  - архивные записи
  - язык формул
  - пример
  - подсчет записей
  - формулы
hide: tags
---

# Подсчет количества записей без учета архивированных {: #example_formula_count_records_no_archive }

## Введение {: #example_formula_count_records_no_archive_introduction }

В **{{ productName }}** при подсчете записей с определенным статусом или условием важно исключать архивные записи из расчета.

Здесь представлен пример использования формулы для подсчета количества записей с определенным статусом, исключая архивные записи.

## Прикладная задача {: #example_formula_count_records_no_archive_use_case }

Требуется подсчитать количество записей с определенным статусом (например, согласованных заявок, оплаченных счетов), исключая из расчета архивные записи.

## Настройка подсчета записей {: #example_formula_count_records_no_archive_configuration }

Для подсчета количества записей с определенным статусом без учета архивированных используйте следующую формулу:

``` sql
COUNT(
    (from a in db->Запросы
    where AND(EQUALS(a->Статус, "Согласована"), EQUALS(a-> _isDisabled, false))
    select a->id)
)
```

### Синтаксис формулы  {: #example_formula_count_records_formula_syntax }

- `COUNT()` — функция подсчета количества записей в результате запроса.
- `from a in db->Запросы` — выборка из шаблона записей с системным именем `Запросы`.
- `where AND(...)` — условие фильтрации записей.
- `EQUALS(a->Статус, "Согласована")` — проверка статуса записи.
- `EQUALS(a-> _isDisabled, false)` — исключение архивных записей.
- `select a->id` — выбор идентификаторов записей.
- **Аргументы**:
    - `Запросы` — системное имя шаблона записи с нужными записями (заявками, счетами и т.д.).
    - `Статус` — атрибут типа «**Текст**» (может быть любой другой атрибут), хранящий признак для выделения записей.
    - `Согласована` — признак для выделения записей (статус — _Согласована_).
    - `_isDisabled` — системный атрибут «**В архиве**».

## Тестирование {: #example_formula_count_records_no_archive_testing }

1. Создайте несколько записей в шаблоне с разными статусами
2. Архивируйте часть записей
3. Используйте формулу для подсчета записей с определенным статусом
4. Убедитесь, что архивные записи не учитываются в подсчете

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- [Язык формул][formula_guide]
- [Список функций языка формул Comindware][formula_function_list]
- [Атрибуты. Определения и настройка][attributes]

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
