---
title: 'Парсинг ID процесса из темы письма'
kbTitle: Эл.&nbsp;почта. Парсинг темы. Извлечение идентификатора процесса
kbId: 4978
tags:
    - ID процесса
    - INDEXOF
    - SUBSTRING
    - формулы
    - обработка писем
    - парсинг
    - тема письма
    - эл. почта
    - ИД процесса
hide: tags
---

# Эл.&nbsp;почта. Парсинг темы. Извлечение идентификатора процесса {: #example_email_parse_process_id_from_subject }

Здесь приведён пример извлечения идентификатора процесса из темы эл.&nbsp;письма с помощью **формулы**.

Это позволяет определить, какой процесс должен обработать письмо в таких сценариях, как:

- **маршрутизация** — направление писем в соответствующие экземпляры процессов;
- **обработка заявок** — привязка ответов к заявлениям по их номерам.

## Синтаксис формулы {: #example_email_parse_process_id_from_subject_formula }

Для извлечения ID процесса из темы письма используйте следующую формулу:

``` cs
SUBSTRING(
    $Тема,
    INDEXOF($Тема,"[") + 1,
    INDEXOF($Тема,"]") - INDEXOF($Тема,"[") - 1)
```

Формула извлекает текст между квадратными скобками.

Если тема письма содержит `"Ответ по заявлению [12345] - одобрено"`, формула вернёт `12345`.

Важно: перед применением формулы убедитесь, что тема содержит символы `[` и `]`; при их отсутствии обработайте ситуацию безопасно (например, верните пустое значение).

Здесь:

- `$Тема` — атрибут, который хранит тему полученного письма;
- `SUBSTRING()` — функция, извлекающая из строки подстроку с найденной позиции и указанной длины;
- `INDEXOF()` — функция, возвращающая позицию символа в строке:
    - `INDEXOF($Tema,"[")` — находит позицию открывающей квадратной скобки `[`;
    - `INDEXOF($Tema,"]")` — находит позицию закрывающей квадратной скобки `]`;
    - `INDEXOF($Tema,"[") + 1` — позиция начала ID (сразу после `[`);
    - `INDEXOF($Tema,"]") - INDEXOF($Tema,"[") - 1` — длина ID (между скобками).

<div class="relatedTopics" markdown="block">

--8<-- "related_topics_heading.md"

- [Парсинг Email до знака @][example_email_parse_address_before_at_sign]
- [Эл.&nbsp;почта в процессе. Отправка, получение и обработка][process_email_configure]
- [Получение эл.&nbsp;почты и веб-запросов в процессе][process_receiving_connection]
- [Список функций языка формул Comindware][formula_function_list]
- [Сценарии][scenarios]

</div>

{% include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md" %}
