<h1>Adding users to a group</h1><p>In order to enable a process to add a user or users to a specific system group (for example, to manage the role model), enter the following expression:</p>
<div>
<table class="source_code_container">
<tbody>
<tr>
<td class="source_code">
<p style="box-sizing: border-box; margin: 0px; font-size: 13px; font-weight: 300; letter-spacing: 0.2px; line-height: 25px; padding: 0px; color: #545764; font-family: monospace; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #fafafa; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">using System;<br style="box-sizing: border-box;"/>using System.Collections.Generic;<br style="box-sizing: border-box;"/>using System.Linq;<br style="box-sizing: border-box;"/>using Comindware.Data.Entity;<br style="box-sizing: border-box;"/>using Comindware.TeamNetwork.Api.Data.UserCommands;<br style="box-sizing: border-box;"/>using Comindware.TeamNetwork.Api.Data;</p>
<p style="box-sizing: border-box; margin: 0px; font-size: 13px; font-weight: 300; letter-spacing: 0.2px; line-height: 25px; padding: 0px; color: #545764; font-family: monospace; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #fafafa; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">class Script<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>public static void Main(Comindware.Process.Api.Data.ScriptContext context, Comindware.Entities entities)<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>string[] OA = new string[] {<br style="box-sizing: border-box;"/>"Clients"<br style="box-sizing: border-box;"/>};<br style="box-sizing: border-box;"/>string[] OP = new string[] {<br style="box-sizing: border-box;"/>"Manager"<br style="box-sizing: border-box;"/>};<br style="box-sizing: border-box;"/>string[] GROUP = new string[] {<br style="box-sizing: border-box;"/>"group.28"<br style="box-sizing: border-box;"/>};<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>for(int j = 0; j &lt; GROUP.Length; j++)<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>var group = GROUP[j];<br style="box-sizing: border-box;"/>var old_users = Api.Base.AccountGroupService.Get(group);<br style="box-sizing: border-box;"/>Api.Base.AccountGroupService.ExcludeMembers(group, old_users.Users);<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>var my_list = Api.TeamNetwork.ObjectService.ListWithAlias(OA[j]);<br style="box-sizing: border-box;"/>foreach (var i in my_list)<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>var data = i as Dictionary&lt;string,object&gt;;<br style="box-sizing: border-box;"/>data.TryGetValue(OP[j], out object obj);<br style="box-sizing: border-box;"/>if (obj == null)<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>continue;<br style="box-sizing: border-box;"/>}</p>
<p style="box-sizing: border-box; margin: 0px; font-size: 13px; font-weight: 300; letter-spacing: 0.2px; line-height: 25px; padding: 0px; color: #545764; font-family: monospace; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #fafafa; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">if (obj is string)<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>Api.Base.AccountGroupService.IncludeMembers(group, new List&lt;string&gt;(){ obj.ToString() }); ÿ<br style="box-sizing: border-box;"/>}<br style="box-sizing: border-box;"/>else<br style="box-sizing: border-box;"/>{<br style="box-sizing: border-box;"/>var accounts = obj as object[];<br style="box-sizing: border-box;"/>var accountsIds = accounts.Select(x =&gt; x.ToString());<br style="box-sizing: border-box;"/>Api.Base.AccountGroupService.IncludeMembers(group, accountsIds);<br style="box-sizing: border-box;"/>}<br style="box-sizing: border-box;"/>}<br style="box-sizing: border-box;"/>}<br style="box-sizing: border-box;"/>}<br style="box-sizing: border-box;"/>}</p>
</td>
</tr>
</tbody>
</table>
</div>
<p><strong>where:</strong></p>
<p><em><strong>Clients</strong> </em>— system name of the record template;</p>
<p><strong><em>Manager</em> </strong>— system name of the attribute of the "Account" data type in the specified record template;</p>
<p><em><strong>group.28</strong></em> — ID of a system group.</p>
<div class="blue_note">This script, when called, firstly removes all users from the group, and then iterates through all records in the specified record template and adds users from the specified attribute to the group, thus updating the composition of the system group.</div>