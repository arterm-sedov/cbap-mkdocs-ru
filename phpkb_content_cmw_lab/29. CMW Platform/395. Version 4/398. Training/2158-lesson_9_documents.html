<h1>Lesson 9 &amp;mdash; Document Generation</h1><div class="mce-toc">
<h2 class="toc-heading">Table of Contents</h2>
<ul>
<li><a href="#mcetoc_1hfbshsge1">Introduction</a></li>
<li><a href="#mcetoc_1gtla7l400">Generate Cost Report</a>
<ul>
<li><a href="#mcetoc_1hfbsqahj2">Configure Excel Template File</a></li>
<li><a href="#mcetoc_1gtlbnf2i0">Configure Export Template</a></li>
</ul>
</li>
<li><a href="#mcetoc_1gtlhpsts0">Configure Export Button</a>
<ul>
<li><a href="#mcetoc_1hfcageur0">Verify Export Button Properties</a></li>
<li><a href="#mcetoc_1hfbt00783">Add Export Button to the User Task Form</a></li>
<li><a href="#mcetoc_1gtliva6e0">Configure Export Button Display Condition</a></li>
</ul>
</li>
<li><a href="#mcetoc_1gtlj8n9g0">Test the Cost Report Export</a></li>
<li><a href="#mcetoc_1gtljk1n11">Results</a></li>
</ul>
</div>
<h2 id="mcetoc_1hfbshsge1">Introduction</h2>
<p><span style="color: #545764; font-family: 'Open Sans', sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">In this lesson, you will learn how to generate a PDF report from the business process data using a Microsoft Excel template.</span></p>
<p><span style="color: #545764; font-family: 'Open Sans', sans-serif; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 300; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">Estimated time to complete</span>: 15 min</p>
<p><span style="letter-spacing: 0.2px;">Prerequisite</span>: complete <samp data-name="aid" data-title="" data-value="2155"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.cmwlab.com/images/marker.png" style="vertical-align: middle;"/>{Article-ID:2155}</span></samp></p>
<p><strong><span data-preserver-spaces="true">Note:</span></strong><span data-preserver-spaces="true"> This lesson is for the <strong>CMW Platform</strong> version 4.2.571.0. In other versions, the page and menu appearance may differ from the screenshots.</span></p>
<h2 id="mcetoc_1gtla7l400">Generate Cost Report</h2>
<div class="notice notice-warning">
<p class="admonition-title">Business Requirement</p>
<p>After completing the trip, the <em>Driver</em> needs to download a PDF report detailing the expenses they filed.</p>
</div>
<p>Let's configure the cost report generation on a button click in the <em>Complete the trip</em> user task.</p>
<p>To export a record as a formatted document, you need to:</p>
<ol>
<li>Create an Excel or Word file with data placeholders and arbitrary static content.</li>
<li>Configure an export template using your Excel or Word template file.</li>
<li>Configure a button to generate the document filled with the exported data.</li>
<li>Click the button to download the generated document.</li>
</ol>
<h3 id="mcetoc_1hfbsqahj2">Configure Excel Template File</h3>
<p>Let's configure an Excel file with placeholders for the export template.</p>
<p><strong>1.</strong> Create an Excel file (in XLSX format).</p>
<p><strong>2.</strong> Fill in the Excel sheet as shown in the figure below:</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="Cost report Excel template file" class="img-responsive" height="367" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_1.png" width="1150"/></p>
<p class="caption" style="font-size: 15px !important;">Cost report Excel template file</p>
</div>
<div class="notice notice-success">
<p class="admonition-title">Export Template File Syntax</p>
<p>The export template replaces placeholders in an Excel or Word file with the exported data. The rest of the template file content remains intact during the export. </p>
<p>The export template file may contain arbitrary content and placeholders to hold the exported data. You can export single attribute values and datasets.</p>
<p>This way, you can create a sophisticated layout, e.g., an invoice, and fill it with the exported data.</p>
<ul>
<li>To export an attribute value, enter its system name in curly brackets: <code>{systemname}</code></li>
<li>To export a linked template attribute value, enter its system name after the record attribute system name separated by a full stop: <code>{RecordAttribute.LinkedTemplateAttribute}</code></li>
<li>To export a dataset ​​from a record template linked to a multivalue record attribute, use the <code>foreach</code> and <span style="color: #36464e; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">end </span>statements: 
<pre><span style="color: #36464e; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">{foreach:MultiValueRecordAttribute} {RecordAttribute.LinkedTemplateAttribute1} {LinkedTemplateAttribute2} {end:MultiValueRecordAttribute}</span></pre>
<ul>
<li>A table row with the <code>foreach<span style="color: #545764; font-family: Open Sans, sans-serif;"><span style="font-size: 15px; background-color: #ecf7ed;"> and </span></span></code><code>end</code> statements is converted to several rows — a row per linked record.</li>
<li>In the first column, enter the <code>foreach:</code> operator and the record attribute system name (no spaces allowed): <span style="color: #36464e; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">{foreach:MultiValueRecordAttribute}</span></li>
<li>In the last column, enter the <code>end:</code> operator and the record attribute system name (no spaces allowed): <span style="color: #36464e; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">{end:MultiValueRecordAttribute}</span></li>
<li><span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">Between the </span></span><code style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; color: #36464e !important; word-break: break-word; padding: 0px; background-color: #f5f5f5; border-radius: 0.25rem; font-weight: normal;">foreach</code> <span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">and </span></span><code style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; color: #36464e !important; word-break: break-word; padding: 0px; background-color: #f5f5f5; border-radius: 0.25rem; font-weight: normal;">end</code> <span style="box-sizing: border-box; vertical-align: inherit;">statements</span><span style="box-sizing: border-box; vertical-align: inherit;"><span style="box-sizing: border-box; vertical-align: inherit;">, enter the linked template attribute system names in curly braces: <span style="color: #36464e; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">{LinkedTemplateAttribute}</span>.</span></span></li>
</ul>
</li>
</ul>
<p>To export data from the <em>Vehicle request</em> record template, enter attribute system names in curly brackets:</p>
<ul>
<li><code>{Totalcosts}</code> — the total amount of costs.</li>
<li><code>{Number}</code> — the request number.</li>
<li><code>{Cardeliverytime}</code> — car delivery time.</li>
</ul>
<p>To export the cost records linked to a vehicle request, enter the following:</p>
<pre><span style="color: #36464e; font-family: SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 13.5px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.2px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #f5f5f5; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">{foreach:Costs} {Type.Title} {Amount} {end:Costs}</span></pre>
<ul>
<li><code>Costs </code>— the multivalue record attribute in the <em>Vehicle requests</em> record template linked to the <em>Costs</em> record template.</li>
<li><code>Amount</code> — the attribute in the <em>Costs</em> record template.</li>
<li><code>Type</code> — the record attribute in the <em>Costs</em> record template linked to the <em>Cost types </em>record template.</li>
<li><code>Title</code> — the attribute in the <em>Cost types</em> record template.</li>
</ul>
</div>
<h3 id="mcetoc_1gtlbnf2i0">Configure Export Template</h3>
<p><strong>1.</strong> In the <em>Vehicle requests</em> record template, go to the <strong>Export templates</strong> tab.</p>
<p><strong>2.</strong> Click <strong>Create</strong>.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="" class="img-responsive" height="406" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_2.png" width="1350"/></p>
<p class="caption" style="font-size: 15px !important;">Creating an export template</p>
</div>
<p><strong>3.</strong> The <strong>New export template</strong> window appears.</p>
<p><strong>4.</strong> Specify the export template <strong>name </strong>— <em>Cost report</em>.</p>
<p><strong>5.</strong> In the <strong>Template file</strong> field, select <strong>Value</strong> and upload the XLSX template file you created earlier.</p>
<p><strong>6.</strong> In the <strong>Output file name</strong> field, select <strong>Value</strong> and specify the required name of the exported data file <em>without the file extension — Cost report</em>.</p>
<p><strong>7.</strong> Check the <strong>Export as PDF</strong> checkbox.</p>
<p><strong>8. </strong>Click <strong>Save</strong>.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="Configuring an export template" class="img-responsive" height="449" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_3.png" width="1350"/></p>
<p class="caption" style="font-size: 15px !important;">Configuring an export template</p>
</div>
<h2 id="mcetoc_1gtlhpsts0">Configure Export Button</h2>
<p>When you create an export template, a corresponding button to download the exported document is automatically created.</p>
<p>Let's verify the export button properties and add the button to the user task form.</p>
<h3 id="mcetoc_1hfcageur0">Verify Export Button Properties</h3>
<p><strong>1.</strong> In the <em>Vehicle requests</em> record template, go to the <strong>Buttons</strong> tab.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="The list of buttons in the record template" class="img-responsive" height="472" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_4.png" width="1350"/></p>
<p class="caption" style="font-size: 15px !important;">The list of buttons in the record template</p>
</div>
<p><strong>2.</strong> Open the <em>Cost report</em> button by double-clicking on it. Check that its properties are correct:</p>
<ul>
<li><strong>Display name:</strong> <em>Cost report</em></li>
<li><strong>Operation context:</strong> <strong>Record</strong></li>
<li><strong>Operation:</strong> <strong>Export record</strong></li>
<li><strong>Operation result:</strong> <strong>Download document</strong></li>
<li><strong>Export template:</strong><span style="letter-spacing: 0.2px;"> <em>Cost report</em></span></li>
</ul>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="The Cost report button properties" class="img-responsive" height="573" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_5.png" width="1350"/></p>
<p class="caption" style="font-size: 15px !important;">The Cost report button properties</p>
</div>
<h3 id="mcetoc_1hfbt00783">Add Export Button to the User Task Form</h3>
<p>Let's add the <em>Cost report</em> button to the <em>Complete the trip</em> user task form:</p>
<ul>
<li>Create the <em>Report download </em>form with only the <em>Cost report</em> button.</li>
<li>Place the <em>Report download </em>form on the <em>Complete the trip</em> user task form.</li>
</ul>
<p><strong>1.</strong> Open the <em>Vehicle requests</em> record template and go to the <strong>Forms</strong> tab.</p>
<p><strong>2.</strong> Click <strong>Create</strong>.</p>
<p><strong>3.</strong> Rename the form to <em>Report download</em>.</p>
<p><strong>4.</strong> Rename the default area to <em>Report download</em>.</p>
<p><strong>5.</strong> Select the toolbar in the <em>Report download </em>area and drag the <em>Cost report</em> button to the toolbar.</p>
<p><strong>6.</strong> Save the form.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="Adding a button to the form" class="img-responsive" height="475" src="https://kb.cmwlab.com/assets/img_655630b02a0c2.png" width="1229"/></p>
<p class="caption" style="font-size: 15px !important;">Adding a button to the form</p>
</div>
<p><strong>7.</strong> In the <em>Ordering a corporate vehicle</em> process template, go to the <strong>Diagram </strong>tab and click <strong>Edit</strong>.</p>
<p><strong>8.</strong> Select the <em>Complete the trip</em> user task and click <strong>Form</strong> in the element menu.</p>
<p><strong>9.</strong> Expand the <em>Vehicle requests</em> template in the element pane and drag the <em>Report download</em> form below the <em>Complete the trip</em> area.</p>
<p><strong>10. </strong>Save the form.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="Adding the Report download subform to the Complete the trip user task form" class="img-responsive" height="619" src="https://kb.cmwlab.com/assets/img_6556314418e53.png" width="1229"/></p>
<p class="caption" style="font-size: 15px !important;">Adding the Report download subform to the Complete the trip user task form</p>
</div>
<p><strong>5. </strong>Publish the <em>Ordering a corporate vehicle </em>process diagram.</p>
<h3 id="mcetoc_1gtliva6e0">Configure Export Button Display Condition</h3>
<p>To use the <em>Cost report</em> button, the <em>Driver</em> needs the appropriate permission in the <em>Driver</em> role.</p>
<p><strong>1.</strong> In the <em>Vehicle management</em> application, go to <strong>Roles</strong>.</p>
<p><strong>2.</strong> Open the <em>Driver</em> role and go to the <strong>Permissions</strong> tab.</p>
<p><strong>3.</strong> Expand the <em>Vehicle request</em> record template in the resources pane and drag the <em>Cost report </em>button to the resource permissions table.</p>
<p><strong>4.</strong> Select the <strong>Use buttons</strong> checkbox for the <em>Cost report</em> button.</p>
<p><strong>5.</strong> Save the role.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt='Adding the permission to use a button in the "Driver" role' class="img-responsive" height="680" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_8.png" width="1350"/></p>
<p class="caption" style="font-size: 15px !important;">Adding the permission to use a button in the Driver role</p>
</div>
<h2 id="mcetoc_1gtlj8n9g0">Test the Cost Report Export</h2>
<div class="notice notice-info">
<p class="admonition-title">Note</p>
<p>If you completed <samp data-name="aid" data-title="" data-value="2157"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.cmwlab.com/images/marker.png" style="vertical-align: middle;"/>{Article-ID:2157}</span></samp>, the user tasks are assigned to different accounts.</p>
<p>To go through the business process, you can perform user tasks in one of the three ways:</p>
<ul>
<li>Log in several times with different accounts: <em>Initiator, Secretary, Driver, Garage manager</em>.</li>
<li>Order a vehicle, open the running process instance diagram, and go through the tasks using the <strong>Navigate </strong>button in the <strong>Tokens</strong> panel.</li>
<li>Set your account as the performer of all user tasks.</li>
</ul>
</div>
<p><strong>1. </strong>Submit a new vehicle request using the instance list of the <em>Ordering a corporate vehicle</em> process template.</p>
<p><strong>2.</strong> Go through the business process up to the <em>Complete the trip </em>task using <strong>My tasks</strong>.</p>
<p><strong>3. </strong>Open the <em>Complete the trip </em>task and add some costs to the table.</p>
<p><strong>4.</strong> Click <strong>Save</strong>.</p>
<p><strong>5. </strong>Click <em>Cost report</em> and wait for the generated PDF document to download.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="Downloading the cost report from the Complete the trip task" class="img-responsive" height="528" src="https://kb.cmwlab.com/assets/img_655636a793e24.png" width="1048"/></p>
<p class="caption" style="font-size: 15px !important;">Downloading the cost report from the Complete the trip task</p>
</div>
<p><strong>6.</strong> Open the exported document. </p>
<p><strong>7.</strong> Complete the task.</p>
<div class="screenshot_with_caption" style="font-size: 15px !important;">
<p><img alt="The exported PDF document" class="img-responsive" height="315" src="https://kb.cmwlab.com/assets/cmw_platform_lesson9_10.png" width="751"/></p>
<p class="caption" style="font-size: 15px !important;">The exported PDF document</p>
</div>
<h2 id="mcetoc_1gtljk1n11">Results</h2>
<p>Congrats! You have learned how to automatically generate and export documents based on templates, substituting data from a business application.</p>
<p>Proceed to <samp data-name="aid" data-title="" data-value="2159"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.cmwlab.com/images/marker.png" style="vertical-align: middle;"/>{Article-ID:2159}</span></samp> to learn how to work with the files.</p>
<p><a class="md-top md-icon mkdocs_imported_link" href="#"> <em class="fa-light fa-arrow-up">‌</em> Back to top</a></p>