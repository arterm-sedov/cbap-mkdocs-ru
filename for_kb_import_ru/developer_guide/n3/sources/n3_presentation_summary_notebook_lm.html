<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="" kb-tags="" kb-title="">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#урок-1-онтологии-в-реальном-мире">
<span class="md-ellipsis">
      Урок 1. Онтологии в реальном мире
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#урок-2-введение-в-графы">
<span class="md-ellipsis">
      Урок 2. Введение в графы
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#урок-3-n-triples--что-это-такое">
<span class="md-ellipsis">
      Урок 3. N-Triples — что это такое?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#урок-4-comindware-elastic-data">
<span class="md-ellipsis">
      Урок 4. Comindware Elastic Data
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#урок-5-запросы-n-triples-и-как-они-работают">
<span class="md-ellipsis">
      Урок 5. Запросы N-Triples и как они работают
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#урок-6-использование-n-triples-в-платформе">
<span class="md-ellipsis">
      Урок 6. Использование N-Triples в платформе
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<p>Презентация "N-Triples EDITED by ARTEM SEDOV 24.07.2023" представляет собой обзорный курс по N-Triples и его использованию в платформе Comindware. Курс состоит из шести уроков, охватывающих концепции онтологий, графов, N-Triples, работу с данными Comindware Elastic Data, запросы N-Triples и их применение в платформе.</p>
<h3 id="урок-1-онтологии-в-реальном-мире">Урок 1. Онтологии в реальном мире</h3>
<p><strong>Онтология</strong> определяется как учение о сущем, бытии и связях между ними, раздел философии, изучающий фундаментальные принципы бытия. В контексте информационных технологий, онтология — это описание множества объектов, их свойств и связей между собой. Окружающий мир состоит из объектов, которые имеют различные характеристики и взаимодействуют между собой.</p>
<p><strong>Основные принципы онтологического представления:</strong>
*   Объекты представляются <strong>классами</strong>.
*   Классы имеют <strong>свойства</strong>.
*   Классы <strong>взаимодействуют</strong> между собой.
*   Классы имеют <strong>экземпляры</strong>.</p>
<p>В качестве примера приводится человек, владеющий автомобилем. Другой пример – <strong>яблоко</strong> как класс со свойствами "цвет" и "вкус". Человек может "любить" или "иметь" яблоки, что демонстрирует взаимодействие классов. Конкретные яблоки (Яблоко 1, Яблоко 2) и люди (Иван Иванович) являются экземплярами классов.</p>
<p><strong>Задание 1</strong> предлагает разложить предметы реального мира ("карандаши в пенале") на классы и их свойства. В ходе обсуждения были определены классы "Пенал" и "Карандаш". Свойства для "Пенала" — "материал", "вместимость", "ёмкость"; для "Карандаша" — "цвет", "состояние" (например, острый/тупой), "твёрдость". Определена связь "содержит", где пенал может содержать карандаши, а карандаш принадлежит одному пеналу.</p>
<h3 id="урок-2-введение-в-графы">Урок 2. Введение в графы</h3>
<p><strong>Граф</strong> — это абстрактная фигура, состоящая из <strong>вершин</strong> и <strong>рёбер</strong>, связывающих вершины. Существует множество разновидностей графов: связанные, изолированные, направленные, ненаправленные, полные, неполные, древовидные (планарные). Графы помогают описывать онтологические модели реального мира, разбивая их на парные рёбра, содержащие пару вершин и ребро.</p>
<p>Пример с человеком и автомобилем используется для демонстрации графа:
*   Человек владеет автомобилем (класс).
*   Иван Иванович является Человеком.
*   Volvo является Автомобилем.
*   Иван Иванович владеет Volvo (конкретный экземпляр).
На этом примере <strong>подчеркивается роль направления связи</strong> (например, "владеет" от человека к автомобилю, а не наоборот). Также отмечается, что вершины графа могут представлять как классы, так и конкретные экземпляры, и с точки зрения базы данных, они лежат на одном уровне.</p>
<p><strong>Задание 2</strong> предлагает создать граф по предметам из предыдущего задания ("карандаши в пенале"). В графе "Пенал" содержит "Карандаш", а конкретный "Синий карандаш" является "Карандашом", и "Пластмассовый пенал" является "Пеналом". Связь "содержится" устанавливается от пенала к карандашу, а также от конкретного пластмассового пенала к конкретному синему карандашу, при этом указывается, что экземпляры "являются" классами.</p>
<h3 id="урок-3-n-triples--что-это-такое">Урок 3. N-Triples — что это такое?</h3>
<p><strong>N-Triples</strong> — это <strong>упрощенное текстовое представление графов</strong> в модели <strong>RDF (Resource Description Framework)</strong>. RDF рекомендована Консорциумом всемирной паутины (W3C) для описания данных и метаданных и является частью концепции Семантической паутины, предназначенной для машинной обработки. N-Triples является упрощенным подмножеством нотаций Turtle и Notation3, представляющих модели RDF в компактном и удобном для чтения виде.</p>
<p>Любой триплет представляет собой <strong>тройку: Субъект, Предикат, Объект</strong>. Эта тройка выражает любой блок графа, ограниченный двумя вершинами и направленным ребром.</p>
<p><strong>Пример преобразования графа в триплеты:</strong>
Граф "Человек владеет Автомобилем" и "Иван Иванович владеет Volvo" преобразуется в N-Triples:
*   <code>&lt;http://uri/#Человек&gt; &lt;http://uri/#владеет&gt; &lt;http://uri/#Автомобиль&gt;</code>
*   <code>&lt;Иван Иванович&gt; &lt;http://uri/#является&gt; &lt;http://uri/#Человек&gt;</code>
*   <code>&lt;Вольво&gt; &lt;http://uri/#является&gt; &lt;http://uri/#Автомобиль&gt;</code>
*   <code>&lt;Иван Иванович&gt; &lt;http://uri/#владеет&gt; &lt;Вольво&gt;</code>
Здесь <code>http://uri/#</code> используется как универсальный идентификатор ресурса (URI/IRI), а "Иван Иванович" и "Вольво" представлены как литералы или конкретные экземпляры. <strong>Направленность предиката критически важна</strong>: он определяет, кто является субъектом, а кто — объектом.</p>
<p><strong>Задание 3</strong> предлагает преобразовать граф "карандаши в пенале" в набор триплетов:
*   <code>пенал содержит карандаш</code>
*   <code>синий карандаш является карандаш</code>
*   <code>пластмассовый пенал является пенал</code>
*   <code>пластмассовый пенал содержит синий карандаш</code></p>
<h3 id="урок-4-comindware-elastic-data">Урок 4. Comindware Elastic Data</h3>
<p>База данных Comindware представляет собой <strong>RDF-граф в нотации N-Triple</strong>. Все данные Comindware Elastic Data хранятся в виде <strong>набора триплетов</strong>. Системные метаданные (определения системных классов) хранятся в виде файлов с расширением <strong>.n3</strong>. Прикладные метаданные (ваши шаблоны записей, процессов) и данные (экземпляры) хранятся в единой базе данных в виде набора файлов. Все ссылочные данные проиндексированы для выполнения быстрого поиска.</p>
<p>Презентация приводит примеры внутренних описаний классов Comindware, таких как <code>UserTask</code> и <code>Account</code>. Эти описания, написанные в N-Triples, показывают, как определяются классы, их свойства (<code>objectProperty</code>, <code>cmw:property</code>), системные алиасы и методы (функторы), которые вычисляются на лету.</p>
<h3 id="урок-5-запросы-n-triples-и-как-они-работают">Урок 5. Запросы N-Triples и как они работают</h3>
<p>Запросы N-Triples пишутся аналогично фактам в виде набора триплетов. У запроса есть входные и выходные данные. Запрос выполняется <strong>последовательно сверху вниз по каждому триплету, в итеративном порядке</strong>. Если запрос ничего не вернул, это считается пустым результатом (null). <strong>Ризонер (Reasoner)</strong> — это специальный механизм, выполняющий запросы.</p>
<p><strong>Основные элементы синтаксиса запросов:</strong>
*   <strong><code>#</code></strong> — комментарий.
*   <strong><code>a</code></strong> — принадлежность субъекта к объекту (зарезервированный предикат).
*   <strong><code>-&gt;</code></strong> — присваивание значения.
*   <strong><code>@prefix</code></strong> — объявление префиксов для длинных URI, делая запросы более читаемыми.
*   <strong><code>?</code></strong> — объявление переменных.
*   <strong><code>.</code></strong> — терминатор триплета (каждый триплет должен заканчиваться точкой).
*   <strong><code>{}</code></strong> — объявление формулы (группирует триплеты, которые выполняются как единое целое и выдают один результат).
*   <strong><code>()</code></strong> — объявление списка/массива.
*   <strong><code>[]</code></strong> — неявное использование субъекта.</p>
<p><strong>Четыре вида запросов:</strong>
1.  <code>субъект предикат ?</code> — поиск объекта по заданному предикату и субъекту.
2.  <code>? предикат объект</code> — поиск субъекта по заданному предикату и объекту.
3.  <code>субъект предикат объект</code> — проверка наличия факта по заданным аргументам (возвращает true/false).
4.  <code>? предикат ?</code> — поиск субъекта и объекта по заданному предикату.</p>
<p><strong>Механизм выполнения запросов:</strong>
Исполнение запроса происходит построчно, сверху вниз. Переменные, определенные в предыдущих строках, принимают значения из <strong>итератора</strong>. Если итератор содержит несколько значений, каждая последующая строка запроса будет выполняться для каждого значения из итератора по очереди. Это напоминает <strong>Loop Join</strong> в реляционных базах данных. <strong>Оптимизация запросов</strong> предполагает начинать с наиболее ограничивающих условий, чтобы минимизировать размер итераторов на ранних этапах выполнения скрипта.</p>
<p><strong>Полезные конструкции и встроенные функции:</strong>
*   <code>("tempAlias" "attrAlias") object:findProperty ?p</code> — возвращает ID атрибута.
*   <code>once {}</code> — выходит после первой успешной итерации. Если обернуть весь запрос, он вернет результат, как только будет найден один удовлетворяющий условию.
*   <code>or {} or {}</code> — логический оператор ИЛИ. Выполняет выражения последовательно, переключаясь на следующее, если предыдущее не вернуло результат, и выходит после первого успешного выполнения.
*   <code>if {} then {} else {}</code> — условный оператор. Важно, что если блок <code>if</code> не выполнился, и нет блока <code>else</code>, запрос прерывается, и результат будет null.
*   <code>from {} select ?v -&gt; ?VList</code> — получение типа Список (собирает значения в массив, который обрабатывается как единое целое, а не итератор).
*   <code>?list math:sum ?sum</code> — получение суммы.
*   <code>assert:count ?c</code> — выводит количество записей.
*   <code>{...} assert:union true</code> — объединение итераторов в один. Если <code>true</code> (или любое другое значение кроме <code>false</code>) используется как объект, это аналог <code>UNION ALL</code>. Для получения уникальных значений используется <code>assert:distinct</code>.
*   Функции для работы со строками, такие как <code>stringComparer sort:stringComparer</code> для сортировки и <code>cmwstring:join</code> для объединения списка в строку, также доступны.</p>
<p><strong>Примеры запросов:</strong>
*   Получение всех задач на исполнение и сравнение их с искомым литералом (<code>ivanov_ii</code>).
*   Использование <code>once</code> для нахождения первого магазина в регионе.
*   Использование <code>or</code> для получения задач, где пользователь является возможным или назначенным исполнителем.
*   Использование <code>if</code> для проверки просроченных задач.
*   Расчёт суммы позиций накладной с помощью <code>from</code> и <code>sum</code>.
*   Подсчёт уникальных продуктов в позициях накладной с помощью <code>distinct</code> и <code>count</code>.
*   Объединение контрагентов (грузоотправителя и грузополучателя) с помощью <code>union</code>.</p>
<p><strong>Задание 4</strong> демонстрирует сравнение двух атрибутов с множественными данными. Решение предполагает получение значений каждого атрибута, преобразование их в отсортированные строки и затем сравнение этих строк для определения совпадения всех значений.</p>
<p><strong>Задание 5</strong> — написать запрос, который показывает количество уникальных контрагентов, указанных в накладной. Решение предполагает объединение всех атрибутов-контрагентов (Плательщик, Грузополучатель, Заказчик) с помощью <code>union</code>, затем применение <code>distinct</code> для получения уникальных значений и <code>count</code> для их подсчета.</p>
<h3 id="урок-6-использование-n-triples-в-платформе">Урок 6. Использование N-Triples в платформе</h3>
<p>Запросы N-Triples широко используются в различных разделах платформы Comindware для определения логики и поведения. Входные (<code>?item</code>) и выходные (<code>?value</code>) параметры запросов меняются в зависимости от контекста использования:
*   <strong>Вычисляемый атрибут:</strong> Вход <code>?item</code> (ID текущей записи), выход <code>?value</code> (значение атрибута).
*   <strong>Системный фильтр таблицы:</strong> Выход <code>?item</code> (ID записей для вывода в таблицу).
*   <strong>Условие отображения кнопки:</strong> Вход <code>?item</code> (ID текущей записи), выход <code>?value</code> (true/false).
*   <strong>Фильтр на поле формы:</strong> Вход <code>?item</code> (ID текущей записи), выход <code>?value</code> (искомые записи ID).
*   <strong>Условие применения роли/разрешения:</strong> Вход <code>?item</code> (ID текущей записи), выход <code>?value</code> (true/false).
*   <strong>Фильтр аккаунтов для переназначения:</strong> Вход <code>?value</code> (ID текущего аккаунта), выход <code>?item</code> (список ID аккаунтов).
*   <strong>Вычисляемое значение для действия по правилу формы:</strong> Вход <code>?item</code>, выход <code>?value</code>.
*   <strong>Условие выполнения правила/действия формы:</strong> Вход <code>?item</code>, выход <code>?value</code> (true/false, или пусто).
*   <strong>Сценарии (изменение контекста, дублирование записей, проверка выражений, изменение значений атрибутов/переменных, повторы):</strong> Вход <code>?item</code>, выход <code>?value</code> (записи для перехода/дублирования, true/false, значение атрибута/переменной, количество итераций, список объектов).</p>
<p><strong>Обсуждаемые возможности и ограничения:</strong>
*   <strong>Глобальные функции:</strong> Возможно вызывать из N-Triples для выполнения сложных вычислений (например, преобразование числа в пропись) или интеграции с внешними сервисами. Такие функции могут принимать параметры и возвращать значения, при этом их внутренняя реализация (например, на C#) не важна для N-Triples.
*   <strong>Вычисляемые атрибуты:</strong> <strong>Не хранятся в базе данных</strong>. Их значения вычисляются динамически в момент обращения к ним. На изменения вычисляемых атрибутов нельзя подписаться напрямую; подписываться следует на изменения исходных хранимых атрибутов, от которых они зависят.
*   <strong>Экспортные шаблоны:</strong> Есть два механизма: лоукодный (использующий фигурные скобки как теги) и через C#. При использовании C# необходимо определить структуру класса, который будет передаваться в шаблон, и наполнить его данными с помощью API.
*   <strong>Будущее развитие платформы:</strong>
    *   Планируется внедрение <strong>DMN-таблиц (Decision Model and Notation)</strong>, которые появятся во всех точках применения выражений.
    *   Ведётся работа над улучшением <strong>визуализации процессов (BPMN-редактор)</strong>.
    *   В перспективе рассматривается функционал по <strong>статистике процессов и дашбордам</strong>.
    *   Актуализируется и дополняется <strong>документация</strong>.</p>
<p>В целом, презентация и сопутствующие обсуждения детально раскрывают, как Comindware Elastic Data использует N-Triples как основу для своей графовой базы данных, как строить запросы на этом языке, и где эти запросы применяются в различных компонентах платформы, а также обсуждаются текущие возможности и планы по развитию.</p>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>