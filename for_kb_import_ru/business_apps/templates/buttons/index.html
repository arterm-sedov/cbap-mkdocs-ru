<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4790">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#definitions">
<span class="md-ellipsis">
      Определения
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#button_configure">
<span class="md-ellipsis">
      Настройка кнопки
    </span>
</a>
<nav aria-label="Настройка кнопки" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#свойства">
<span class="md-ellipsis">
      Свойства
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#скрипт">
<span class="md-ellipsis">
      Скрипт
    </span>
</a>
<nav aria-label="Скрипт" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#заготовка-скрипта">
<span class="md-ellipsis">
      Заготовка скрипта
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#входные-данные">
<span class="md-ellipsis">
      Входные данные
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#выходные-данные">
<span class="md-ellipsis">
      Выходные данные
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#условие-отображения">
<span class="md-ellipsis">
      Условие отображения
    </span>
</a>
<nav aria-label="Условие отображения" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#примеры-условий-отображения-кнопки">
<span class="md-ellipsis">
      Примеры условий отображения кнопки
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#button_local_variables">
<span class="md-ellipsis">
      Локальные переменные
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связи">
<span class="md-ellipsis">
      Связи
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#удаление-кнопки">
<span class="md-ellipsis">
      Удаление кнопки
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<div class="notice notice-success">
<h2 class="admonition-title" id="definitions">Определения</h2>
<ul>
<li><strong>Кнопка</strong> представляет собой визуальный элемент на форме, при нажатии которого выполняется предварительно настроенная операция.</li>
<li>Для каждого шаблона предусмотрен отдельный набор кнопок.</li>
<li>Названия, цвета и значки кнопок <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4791">настраиваются в <strong>области кнопок</strong></a>.</li>
<li>Для каждой формы или таблицы можно настроить особые названия, значки и цвета кнопок.</li>
</ul>
</div>
<h2 id="button_configure">Настройка кнопки</h2>
<p>Конструктор кнопки позволяет настроить её внешний вид, поведение и операцию, выполняющуюся при её нажатии.</p>
<p>Цвет и значок кнопки <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4791">настраиваются в <strong>области кнопок</strong></a>.</p>
<ol class="colored_numbers_list">
<li>Откройте шаблон.</li>
<li>Выберите вкладку «<strong>Кнопки</strong>».</li>
<li>Отобразится список кнопок в составе шаблона.</li>
<li>Нажмите кнопку «<strong>Создать</strong>» или дважды нажмите кнопку в списке.</li>
<li>Отобразится конструктор кнопки.</li>
<li>
<p>Настройте параметры кнопки на следующих вкладках:</p>
<ul>
<li><a class="mkdocs_imported_link" href="#свойства"><strong>Свойства</strong></a></li>
<li><a class="mkdocs_imported_link" href="#скрипт"><strong>Скрипт</strong></a></li>
<li><a class="mkdocs_imported_link" href="#условие-отображения"><strong>Условие отображения</strong></a></li>
<li><a class="mkdocs_imported_link" href="#button_local_variables"><strong>Локальные переменные</strong></a></li>
<li><a class="mkdocs_imported_link" href="#связи"><strong>Связи</strong></a></li>
</ul>
</li>
<li>
<p>Нажмите кнопку «<strong>Сохранить</strong>».</p>
</li>
</ol>
<figure class="screenshot_with_caption">
<p><img alt="Список кнопок в составе шаблона" src="/platform/v5.0/business_apps/templates/buttons/img/button_list.png"/><figcaption class="caption">Список кнопок в составе шаблона</figcaption></p>
</figure>
<h3 id="свойства">Свойства</h3>
<p>На вкладке «<strong>Свойства</strong>» можно настроить основные параметры кнопки.</p>
<figure class="screenshot_with_caption">
<p><img alt="Конструктор кнопки — вкладка «Свойства»" src="/platform/v5.0/business_apps/templates/buttons/img/button_designer.png"/><figcaption class="caption">Конструктор кнопки — вкладка «Свойства»</figcaption></p>
</figure>
<ul>
<li><strong>Отображаемое название</strong> — подпись, которая будет отображаться на кнопке. Изменение отображаемого названия кнопки в <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4791">области кнопок</a>, на форме или в таблице не повлияет на название исходной кнопки в шаблоне.</li>
<li><strong>Системное имя</strong> — уникальное имя кнопки для использования в сценариях, выражениях и скриптах.</li>
<li><strong>Описание</strong> — наглядное описание назначения кнопки. Описание кнопки отображается как подсказка при наведении указателя мыши на кнопку. Изменение описания кнопки в <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4791">области кнопок</a>, на форме или в таблице не повлияет на описание исходной кнопки в шаблоне.</li>
<li id="operationContext"><strong>Контекст операции</strong> — определяет набор доступных операций, контекст выполнения операции и возможность использования кнопки на соответствующих формах и таблицах.<ul>
<li><strong>Аккаунт</strong> — запись в <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4757">шаблоне аккаунта</a></strong>.</li>
<li><strong>Диаграмма</strong> — диаграмма процесса.</li>
<li><strong>Запись</strong> в <strong>шаблоне <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4759">записи</a></strong>, <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4757">аккаунта</a></strong>, <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4760">роли</a></strong> или <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4755">организационной единицы</a></strong>.</li>
<li><strong>Пользовательская задача</strong> — элемент диаграммы процесса.</li>
<li><strong>Процесс</strong> — экземпляр или <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4758">шаблон процесса</a></strong>.</li>
</ul>
</li>
<li>
<p><strong>Операция</strong> — набор доступных операций зависит от выбранного <a class="mkdocs_imported_link" href="#operationContext"><strong>контекста операции</strong></a>. Операции выполняются с <strong>записями</strong> в <strong>шаблонах <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4758">записей</a></strong>. Предусмотрены следующие операции:</p>
<ul>
<li><strong>Архивировать</strong> — архивирование выбранных записей или экземпляров процесса: установка для системного атрибута <strong>_isDisabled</strong>значения <code>true</code>.</li>
<li><strong>Вызвать событие «Нажата кнопка»</strong> — при нажатии кнопки сработает событие «<strong>Нажата кнопка</strong>», по которому может быть запущен сценарий в приложении.</li>
<li id="launchProcess"><strong>Запустить процесс</strong> — запуск экземпляра выбранного шаблона процесса по текущей записи или по новой записи.</li>
<li id="launchLinkedProcess"><strong>Запустить процесс по связанному шаблону</strong> — запуск экземпляра процесса по выбранному шаблону записи, связанному с текущим шаблоном записи посредством атрибута типа «<strong>Запись</strong>». В отличие от операции «<strong>Запустить процесс</strong>», после запуска процесса в указанный атрибут будет помещена ссылка на созданную запись. После выбора шаблона становится доступно поле выбора формы для создания записи.</li>
<li><strong>Мигрировать</strong> — обновление экземпляра процесса до последней версии диаграммы процесса. (Эта операция работает не во всех версиях <strong>Comindware Platform</strong>.)</li>
<li id="csharpScript"><strong>Скрипт C#</strong> — выполнение скрипта C#. Скрипт может выполнять любые действия с использованием API и библиотек, доступных в <strong>Comindware Platform</strong>. См. <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4864"><em>«Написание скриптов на языке C#. Скрипт операции»</em></a>.</li>
<li id="createRecord"><strong>Создать</strong> — создание записи в выбранном шаблоне. После выбора шаблона становится доступно поле выбора формы для создания записи.</li>
<li id="createLinkedRecord"><strong>Создать связанную запись</strong> — создание записи в шаблоне записи, связанном с текущим шаблоном посредством атрибута типа «<strong>Запись</strong>». В отличие от операции «<strong>Создать</strong>», после создания записи ссылка в указанный атрибут будет помещена ссылка на созданную запись. После выбора шаблона становится доступно поле выбора формы для создания записи.</li>
<li><strong>Создать токен</strong> — создание нового токена на выбранном элементе диаграммы экземпляра процесса.</li>
<li><strong>Сохранить</strong> — сохранение текущей записи.</li>
<li><strong>Остановить процесс</strong> — остановка текущего экземпляра процесса.</li>
<li><strong>Открыть заново</strong> — назначение задаче статуса «<strong>Выполняется</strong>».</li>
<li><strong>Завершить задачу</strong> — завершение текущей задачи бизнес-процесса.</li>
<li><strong>Отвязать от шаблона</strong> — исключение выбранного аккаунта из текущего шаблона аккаунта.</li>
<li><strong>Отложить выполнение</strong> — эта операция будет реализована в последующих версиях продукта.</li>
<li><strong>Привязать к шаблону</strong> — добавление выбранных аккаунтов в текущий шаблон аккаунта.</li>
<li><strong>Принять</strong> — назначение текущего аккаунта исполнителем задачи.</li>
<li><strong>Разархивировать</strong> — разархивирование выбранных записей или экземпляров процесса: установка для системного атрибута <strong>_isDisabled</strong>значения <code>false</code>.</li>
<li><strong>Редактировать</strong> — изменение диаграммы процесса.</li>
<li><strong>Удалить</strong> — безвозвратное удаление записи или экземпляра процесса.</li>
<li id="exportRecord"><strong>Экспорт записи</strong> — экспорт записи посредством <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4797">шаблона экспорта</a> в формате DOCX, XLSX или PDF.</li>
<li id="exportTable"><strong>Экспорт таблицы</strong> — экспорт данных из таблицы в формате XLSX с использованием текущих параметров фильтрации, сортировки, группировки и агрегации.</li>
</ul>
</li>
<li>
<p><strong>Сохранять запись после выполнения</strong> — установите этот флажок, чтобы сохранять текущую запись после выполнения операции по нажатию кнопки.</p>
</li>
<li><strong>Пропускать проверки</strong> — установите этот флажок, чтобы вводе и сохранении данных записи не выполнялись проверки данных и не выводились сообщения об ошибках проверки.</li>
<li>
<p><strong>Результат выполнения</strong> — выберите действие, которое необходимо осуществить после выполнения операции:</p>
<ul>
<li><strong>Обновить данные</strong> — перезагрузка данных формы или таблицы.</li>
<li><strong>Скачать документ</strong> — браузер загрузит файл, сформированный операцией «<a class="mkdocs_imported_link" href="#exportRecord"><strong>Экспорт записи</strong></a>», «<a class="mkdocs_imported_link" href="#exportTable"><strong>Экспорт таблицы</strong></a>» или «<a class="mkdocs_imported_link" href="#csharpScript"><strong>Скрипт C#</strong></a>».</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Для операции «<strong>Скрипт C#</strong>» скачиваемый файл задаётся выходным параметром <code>File</code> скрипта. См. <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4864">Написание скриптов на языке C#. Скрипт операции</a>»</em>.</p>
</div>
<ul>
<li><strong>Навигация</strong> — переход к объекту, указанному в поле «<strong>Переход к</strong>»:<ul>
<li><strong>Диаграмма</strong> — переход к диаграмме экземпляра процесса.</li>
<li><strong>Задача запущенного процесса</strong> — переход к текущей **<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4730">пользовательской задаче</a>.</li>
<li><strong>Предыдущая страница</strong> — переход к предыдущей странице, открытой в браузере.</li>
<li><strong>Рабочий стол</strong>— переход <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4813">рабочему столу</a></strong> для текущего аккаунта.</li>
<li><strong>Связанная запись</strong> — переход к созданной записи (для операций «<a class="mkdocs_imported_link" href="#createRecord"><strong>Создать запись</strong></a>» и «<a class="mkdocs_imported_link" href="#createLinkedRecord"><strong>Создать связанную запись</strong></a>»).</li>
<li><strong>Следующая задача в списке</strong> — переход к следующей (по ID) <strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4730">пользовательской задаче</a></strong>экземпляра процесса, назначенной текущему аккаунту.</li>
<li><strong>Список задач</strong> — переход к странице «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4812">Мои задачи</a></strong>» для текущего аккаунта.</li>
<li><strong>Таблица</strong> — переход к таблице с записями шаблона или экземплярами процесса.</li>
<li><strong>Экземпляр процесса</strong> — переход к <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4723">диаграмме экземпляра процесса</a>.</li>
</ul>
</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Для операции «<a class="mkdocs_imported_link" href="#csharpScript"><strong>Скрипт C#</strong></a>» объект навигации задаётся выходным параметром <code>NavigationResult</code> скрипта. См. <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4864">Написание скриптов на языке C#. Скрипт операции</a>»</em>.</p>
</div>
</li>
<li>
<p id="setAccessMode"><strong>Установить режим доступа к форме</strong> — задайте режим доступа</p>
<ul>
<li><strong>Чтение</strong> — при нажатии кнопки форма станет доступна только для чтения. При этом на форме обязательно должна быть кнопка, устанавливающая режим доступа к форме «<strong>Редактирование</strong>», в противном случае переключение режима переходить не будет. Кроме того, при такой настройке форма по умолчанию будет отображаться в режиме «<strong>Чтение</strong>».</li>
<li><strong>Редактирование</strong> — нажав кнопку, пользователь сможет вводить данные в форму (при наличии соответствующих разрешений).</li>
<li><strong>Не изменять</strong> — использование исходного режима доступа к форме.</li>
</ul>
</li>
<li><strong>Показывать кнопку</strong> — задайте видимость кнопки на форме (этот пункт следует использовать в сочетании с пунктом «<a class="mkdocs_imported_link" href="#setAccessMode"><strong>Установить режим доступа к форме</strong></a>»).<ul>
<li><strong>В режиме редактирования</strong> — кнопка будет отображаться только в режиме ввода данных в форму.</li>
<li><strong>В режиме чтения</strong> — кнопка будет отображаться, когда форма доступна только для чтения (в том числе, запрещено одновременное редактирование формы несколькими пользователями).</li>
<li><strong>Всегда</strong> — кнопка будет отображаться в режиме ввода данных и только чтения.</li>
</ul>
</li>
<li><strong>Отображать диалоговое окно</strong> — если установлен этот флажок, при нажатии кнопки откроется предварительно настроенное окно подтверждения операции.<ul>
<li><strong>Настроить диалоговое окно</strong> — переход к <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4790"><strong>конструктору формы</strong></a> операции, на которое можно перетащить локальные переменные.</li>
</ul>
</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Конструктор диалогового окна операции с локальной переменной" src="/platform/v5.0/business_apps/templates/buttons/img/button_designer_dialogue_designer.png"/><figcaption class="caption">Конструктор диалогового окна операции с локальной переменной</figcaption></p>
</figure>
<h3 class="pageBreakBefore" id="скрипт">Скрипт</h3>
<p>На вкладке «<strong>Скрипт</strong>» можно ввести скрипт на языке C#, который будет выполняться при нажатии кнопки.</p>
<p>Скрипт на C# может выполнять любые действия для контроля, чтения, изменения и удаления данных внутри системы, а также для вызова внешних сервисов в ограниченном пространстве подключаемых библиотек.</p>
<p>Скрипт на С# можно использовать для операции «<strong>Экспорт записи</strong>» с целью подготовки данных для шаблона экспорта. Cм. <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4793"><em>«Настройка шаблона экспорта с использованием C#»</em></a> и <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4796"><em>«Подготовка файла шаблона экспорта»</em></a>.</p>
<p>Чтобы сформировать заготовку скрипта C# нажмите кнопку «<strong>Сформировать шаблон C#</strong>».</p>
<h4 id="заготовка-скрипта">Заготовка скрипта</h4>
<div class="highlight"><code><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Script</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">UserCommandResult</span><span class="w"> </span><span class="nf">Main</span><span class="w"> </span><span class="p">(</span><span class="n">UserCommandContext</span><span class="w"> </span><span class="n">userCommandContext</span><span class="p">,</span><span class="w"> </span><span class="n">Comindware</span><span class="p">.</span><span class="n">Entities</span><span class="w"> </span><span class="n">entities</span><span class="p">)</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">    </span><span class="c1">// Тело скрипта</span></code> <br/><code><span class="w">  </span><span class="p">}</span></code> <br/><code><span class="p">}</span></code> <br/></pre></code></div>
<h4 id="входные-данные">Входные данные</h4>
<p>Скрипт получает на вход в данные контекста в объектах <code>userCommandContext</code> и <code>entities</code>:</p>
<div class="highlight"><code><pre><span></span><code><span class="n">UserCommandContext</span><span class="w"> </span><span class="n">userCommandContext</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">  </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">ObjectIds</span><span class="p">,</span><span class="w"> </span><span class="c1">// массив ID выбранных записей в списке</span></code> <br/><code><span class="w">           </span><span class="c1">// (пустой массив, если записи не выбраны)</span></code> <br/><code><span class="w">           </span><span class="c1">// или массив из одного элемента с ID записи на форме</span></code> <br/><code><span class="w">  </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">SelectedIds</span><span class="p">,</span><span class="w"> </span><span class="c1">// массив ID записей, выбранных в таблице на форме</span></code> <br/><code><span class="w">           </span><span class="c1">// (пустой массив, если записи не выбраны)</span></code> <br/><code><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="n">CurrentUserId</span><span class="p">,</span><span class="w"> </span><span class="c1">// ID аккаунта текущего пользователя</span></code> <br/><code><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="n">DocumentTemplateId</span><span class="p">,</span><span class="w"> </span><span class="c1">// ID шаблона, к которому относится команда</span></code> <br/><code><span class="w">  </span><span class="n">dateTime</span><span class="w"> </span><span class="n">CurrentRequestTime</span><span class="p">,</span><span class="w"> </span><span class="c1">// дата и время текущего запроса</span></code> <br/><code><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">ExportAsPdf</span><span class="p">,</span><span class="w"> </span><span class="c1">// флаг экспорта в PDF</span></code> <br/><code><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="n">FileName</span><span class="p">,</span><span class="w"> </span><span class="c1">// имя файла при выгрузке данных по шаблону экспорта</span></code> <br/><code><span class="w">  </span><span class="n">DatasetQuery</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="c1">// список, с которого произошел запуск операции</span></code> <br/><code><span class="p">},</span></code> <br/><code><span class="n">Comindware</span><span class="p">.</span><span class="n">Entities</span><span class="w"> </span><span class="n">entities</span><span class="w"> </span><span class="c1">// используется для доступа к данным шаблонов записей</span></code> <br/></pre></code></div>
<h4 class="pageBreakBefore" id="выходные-данные">Выходные данные</h4>
<p>Метод <code>Main</code> должен возвращать объект <code>UserCommandResult</code>:</p>
<div class="highlight"><code><pre><span></span><code><span class="n">UserCommandResult</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">Success</span><span class="p">,</span><span class="w"> </span><span class="c1">// флаг успешного завершения операции</span></code> <br/><code><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">Commited</span><span class="p">,</span><span class="w"> </span><span class="c1">// флаг необходимости сохранения результатов работы операции</span></code> <br/><code><span class="w">  </span><span class="k">enum</span><span class="w"> </span><span class="n">UserCommandResultType</span><span class="w"> </span><span class="n">ResultType</span><span class="p">,</span><span class="w"> </span><span class="c1">// тип возвращаемого результата.</span></code> <br/><code><span class="w">  </span><span class="c1">// В зависимости от значения производятся действия:</span></code> <br/><code><span class="w">      </span><span class="c1">// DataChange — обновление данных</span></code> <br/><code><span class="w">      </span><span class="c1">// Notificate — сообщение пользователю</span></code> <br/><code><span class="w">      </span><span class="c1">// Navigate — переход на страницу</span></code> <br/><code><span class="w">      </span><span class="c1">// File — скачивание файла</span></code> <br/><code></code> <br/><code><span class="w">  </span><span class="c1">// набор данных для перехода на другую страницу</span></code> <br/><code><span class="w">  </span><span class="n">UserCommandNavigationResult</span><span class="w"> </span><span class="n">NavigationResult</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">Title</span><span class="p">,</span><span class="w"> </span><span class="c1">// заголовок</span></code> <br/><code><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">,</span><span class="w"> </span><span class="c1">// ID объекта</span></code> <br/><code><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">ContainerId</span><span class="p">,</span><span class="w"> </span><span class="c1">// ID контейнера</span></code> <br/><code><span class="w">    </span><span class="n">ContextType</span><span class="w"> </span><span class="n">Context</span><span class="w"> </span><span class="c1">// тип отображения</span></code> <br/><code><span class="w">      </span><span class="c1">// Undefined, Void, Any, Task, Case, Record, Process, List, Form, Page, Container</span></code> <br/><code><span class="w">  </span><span class="p">},</span></code> <br/><code></code> <br/><code><span class="w">  </span><span class="c1">// объект выгружаемого файла</span></code> <br/><code><span class="w">  </span><span class="n">UserCommandFileResult</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="c1">// имя файла</span></code> <br/><code><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span></code> <br/><code><span class="w">    </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">Content</span><span class="w"> </span><span class="c1">// тело файла</span></code> <br/><code><span class="w">  </span><span class="p">},</span></code> <br/><code></code> <br/><code><span class="w">  </span><span class="c1">// сообщение для пользователя об окончании операции</span></code> <br/><code><span class="w">  </span><span class="n">UserCommandMessage</span><span class="p">[]</span><span class="w"> </span><span class="n">Messages</span><span class="w"> </span><span class="p">{</span></code> <br/><code><span class="w">    </span><span class="k">enum</span><span class="w"> </span><span class="n">Severity</span><span class="p">,</span><span class="w"> </span><span class="c1">// уровень важности сообщения</span></code> <br/><code><span class="w">      </span><span class="c1">// SeverityLevel (Critical, Fatal, Low, Major, None, Normal)</span></code> <br/><code><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">Text</span></code> <br/><code><span class="w">  </span><span class="p">}</span></code> <br/><code><span class="p">}</span></code> <br/></pre></code></div>
<figure class="screenshot_with_caption">
<p><img alt="Конструктор кнопки — вкладка «Скрипт» с заготовкой скрипта C#" src="https://kb.comindware.ru/assets/button_designer_script_copy1.png"/><figcaption class="caption">Конструктор кнопки — вкладка «Скрипт» с заготовкой скрипта C#</figcaption></p>
</figure>
<h3 class="pageBreakBefore" id="условие-отображения">Условие отображения</h3>
<p>На вкладке «<strong>Условие отображения</strong>» можно задать формулу или выражение на N3. Кнопка будет отображаться, если формула или выражение на N3 вернёт <code>true</code>. В противном случае кнопка будет скрыта.</p>
<p>Если задано <strong>условие отображения</strong>, то для отображения кнопки в таблице должна быть выбрана хотя бы одна запись и <strong>условие отображения</strong> должно возвращать <code>true</code> для всех выбранных записей. То есть кнопка не будет отображаться в таблице, если в ней не выбрана ни одна запись или для любой из выбранных записей <strong>условие отображения</strong> возвращает <code>false</code>.</p>
<figure class="screenshot_with_caption">
<p><img alt="Конструктор кнопки — вкладка «Условие отображение» с формулой" src="/platform/v5.0/business_apps/templates/buttons/img/button_designer_display_condition.png"/><figcaption class="caption">Конструктор кнопки — вкладка «Условие отображение» с формулой</figcaption></p>
</figure>
<h4 id="примеры-условий-отображения-кнопки">Примеры условий отображения кнопки</h4>
<p>Ниже представлены примеры условий отображения кнопки на <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4999">языке формул Comindware</a>.</p>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>При составлении выражений учитывайте <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4892">контекст</a> их вычисления.</p>
</div>
<ol class="colored_numbers_list">
<li>
<p>Формула для отображения кнопки на форме или в таблице шаблона записи при условии, что <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4778">логический атрибут</a> имеет значение <code>true</code>:</p>
<div class="highlight"><code><pre><span></span><code><span class="err">$</span><span class="n">LogicAttributeSystemName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">true</span></code> <br/></pre></code></div>
<p><strong>Здесь:</strong> <code>LogicAttributeSystemName</code> — системное имя логического атрибута.</p>
</li>
<li>
<p>Формула для отображения кнопки в таблице любого шаблона при условии, что в таблице выбрана хотя бы одна запись (то есть установлены флажки выбора в первом столбце таблицы):</p>
<div class="highlight"><code><pre><span></span><code><span class="k">true</span></code> <br/></pre></code></div>
</li>
<li>
<p>Формула для отображения кнопки на <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4726">стартовой форме или форме пользовательской задачи</a> при условии, что логический атрибут записи, связанной с экземпляром процесса, имеет значение <code>true</code>:</p>
<div class="highlight"><code><pre><span></span><code><span class="err">$</span><span class="n">cmw</span><span class="p">.</span><span class="n">task</span><span class="p">.</span><span class="n">objectId</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">op</span><span class="mf">.1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">true</span></code> <br/></pre></code></div>
<p><strong>Здесь:</strong></p>
<ul>
<li><code>$cmw.task.objectId</code> — идентификатор связанной с экземпляром процессом записи, где хранится логический атрибут;</li>
<li><code>op.1</code> — идентификатор логического атрибута в шаблоне записи, связанном с шаблоном процесса.</li>
</ul>
</li>
</ol>
<h3 class="pageBreakBefore" id="button_local_variables">Локальные переменные</h3>
<p>На вкладке «<strong>Локальные переменные</strong>» можно создать переменные для использования в скрипте C# или сценарии, выполняемом при нажатии кнопки.</p>
<p>В сценарии по нажатию кнопки локальные переменные будут доступны в объекте <code>dialogVariables</code>. См. <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4719">Переменные в сценарии</a>»</em>.</p>
<p>Локальные переменные представляют собой <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4772">атрибуты</a>.</p>
<p>Пример использования локальной переменной см. в статье <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4909">Использование локальной переменной для массовой обработки записей</a>»</em>.</p>
<p>Для каждой переменной можно задать:</p>
<ul>
<li><strong>Отображаемое название</strong> — наглядное название переменной;</li>
<li><strong>Тип данных</strong> — для переменных предусмотрены <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4772">такие же типы, как для атрибутов</a>;</li>
<li><strong>Формат отображения</strong> — для переменных предусмотрены <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4772">такие же форматы отображения, как для атрибутов</a>;</li>
<li><strong>Системное имя</strong> — уникальное имя переменной для использования в сценариях, выражениях и скриптах;</li>
<li><strong>Описание</strong> — наглядное описание назначения переменной;</li>
<li><strong>Шаблон</strong> — можно задать для переменных следующих типов: «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4780">Запись</a></strong>», «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4774">Аккаунт</a></strong>», «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4783">Роль</a></strong>», «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4767">Организационная единица</a></strong>»;</li>
<li><strong>Хранить несколько значений</strong> — этот флажок можно установить для переменных следующих типов: «<strong>Файл</strong>» (см. типы атрибутов «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4782">Документ</a></strong>» и «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4771">Изображение</a></strong>»), «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4780">Запись</a></strong>», «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4774">Аккаунт</a></strong>», «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4783">Роль</a></strong>», «<strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4767">Организационная единица</a></strong>».</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Конструктор кнопки — вкладка «Локальные переменные»" src="/platform/v5.0/business_apps/templates/buttons/img/button_designer_local_variables.png"/><figcaption class="caption">Конструктор кнопки — вкладка «Локальные переменные»</figcaption></p>
</figure>
<h3 class="pageBreakBefore" id="связи">Связи</h3>
<p>На вкладке «<strong>Связи</strong>» отображается список всех объектов и ресурсов приложения, связанных с кнопкой.</p>
<figure class="screenshot_with_caption">
<p><img alt="Конструктор кнопки — вкладка «Связи»" src="/platform/v5.0/business_apps/templates/buttons/img/button_designer_relations.png"/><figcaption class="caption">Конструктор кнопки — вкладка «Связи»</figcaption></p>
</figure>
<h2 id="удаление-кнопки">Удаление кнопки</h2>
<ol class="colored_numbers_list">
<li>Откройте шаблон.</li>
<li>Выберите вкладку «<strong>Кнопки</strong>».</li>
<li>Отобразится список кнопок в составе шаблона.</li>
<li>Выберите одну кнопку, установив для неё флажок в первом столбце списка.</li>
<li>Нажмите кнопку «<strong>Удалить</strong>».</li>
<li>Подтвердите удаление.</li>
</ol>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4791">Области кнопок. Определение, настройка, клонирование, удаление</a></em> </li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>