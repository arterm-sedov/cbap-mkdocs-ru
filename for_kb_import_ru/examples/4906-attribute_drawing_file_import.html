<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4906" kb-tags="" kb-title="Чертёж. Подготовка и импорт файла DWG">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#подготовка-чертежа">
<span class="md-ellipsis">
      Подготовка чертежа
    </span>
</a>
<nav aria-label="Подготовка чертежа" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#обязательные-требования-к-чертежу">
<span class="md-ellipsis">
      Обязательные требования к чертежу
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#подготовка-чертежа-в-autocad">
<span class="md-ellipsis">
      Подготовка чертежа в AutoCAD
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#импорт-чертежа">
<span class="md-ellipsis">
      Импорт чертежа
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p>На форме можно разместить чертёж с планом помещений, на котором будут отображаться данные из шаблонов записей с привязкой к объектам на чертеже.</p>
<p>Для использования чертежа в <strong>Comindware Platform</strong> потребуется <a class="mkdocs_imported_link" href="#mcetoc_1hlspkjds0">подготовить файл DWG</a>, создать несколько шаблонов и атрибутов определённых типов, поместить поле атрибута типа «<strong>Чертёж</strong>» на форму и привязать его к шаблонам записей. Конечный пользователь, в свою очередь, должен импортировать файл чертежа в формате DWG и привязать слои полигонов и маркеров к атрибутам, заданным при настройке поля.</p>
<p>См. также статью <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4761">Чертёж. Настройка шаблонов, атрибутов, форм и полей</a>».</em></p>
<h2 id="подготовка-чертежа">Подготовка чертежа</h2>
<h3 id="обязательные-требования-к-чертежу">Обязательные требования к чертежу</h3>
<p>Перед импортом в систему чертеж необходимо подготовить согласно следующим требованиям, в противном случае процедура импорта будет неудачной либо чертеж будет отображаться некорректно:</p>
<ul>
<li>Контур каждого объекта должен быть построен в одним единым замкнутым полигоном (например, одно помещение — один полигон).</li>
<li>Полигоны должны быть построены инструментом «Полилиния» и должны состоять из прямых отрезков. Кривые не поддерживаются, поэтому для построения криволинейных полигонов следует использовать несколько прямых отрезков.</li>
<li>Внутри каждого полигона должно находиться его текстовое наименование (например, ID помещения), соответствующее значению текстового атрибута записи в <strong>Comindware Platform</strong>.</li>
<li>Полигоны не должны пересекаться ни одной своей частью с другим замкнутым полигоном.</li>
<li>Полигоны должны находится на отдельном слое, на котором кроме замкнутых полигонов не должно быть никаких других объектов.</li>
<li>Вложенные полигоны должны находиться на разных слоях.</li>
<li>Текстовые блоки с наименованиями полигонов должны находится на отдельном слое, на котором кроме текстов с наименованиями полигонов не должно быть никаких других объектов.</li>
<li>Текстовые блоки должны быть однострочными, типа ТЕКСТ.</li>
<li>Текстовый блок с наименованием полигона должен находиться внутри соответствующего замкнутого полигона.</li>
<li>На каждый слой полигонов должен быть отдельный слой с текстовыми наименованиями.</li>
<li>Полигоны и текстовые наименования должны находиться на любом слое, кроме <em>Слоя 0</em>.</li>
<li><em>Слой 0</em> должен быть пустым.</li>
</ul>
<figure class="screenshot_with_caption">
<p><img alt="Пример чертежа в AutoCAD" src="https://kb.comindware.ru/assets/img_65c6415e30a02.png"/><figcaption class="caption">Пример чертежа в AutoCAD</figcaption></p>
</figure>
<p>Примечание</p>
<p>Определения инструментов и сущностей, такие как <em>«полилиния»</em>,  <em>«слой»</em>, взяты из программе AutoCAD и относятся к данной программе.</p>
<h3 id="подготовка-чертежа-в-autocad">Подготовка чертежа в AutoCAD</h3>
<ol class="colored_numbers_list">
<li>Откройте Диспетчер слоев и создайте новый слой.</li>
</ol>
<p><img alt="Диспетчер слоев AutoCAD" src="https://kb.comindware.ru/assets/img_65c64171d5529.png"/></p>
<p>Диспетчер слоев AutoCAD
2. Назовите новый слой, например, cmw_room.
3. Задайте для линий, например, синий цвет и вес 0,3 мм.</p>
<p><img alt="Диспетчер слоев AutoCAD" src="https://kb.comindware.ru/assets/img_65c6418a2a3a4.png"/></p>
<p>Диспетчер слоев AutoCAD
4. Также создадим отдельный слой для точек с текстом наименований полигонов аналогичным способом, в нашем примере это «cmw_room_attribute». Приступим к отрисовке полигонов для объектов.</p>
<p>Примечание</p>
<ul>
<li>Каждый объект должен быть отрисован в AutoCAD одним единым замкнутым <em>полигоном из прямых полилиний</em> (например, одно помещение = один полигон).</li>
<li>На каждый полигон должен быть выведен текст с наименованием полигона (например, ID помещения) в соответствии с загруженным реестром.</li>
<li>Текст с наименованием полигона должен находится внутри замкнутого полигона.</li>
<li>На каждый слой полигонов иметься отдельный слой с текстовыми наименованиями.</li>
<li>Полигоны и точки с текстовыми наименованиями должны находиться на любом слое, кроме <em>Слоя 0.</em>
5. Полигон можно создать инструментом «Полилиния»  <img alt="" src="https://kb.comindware.ru/assets/img_65c63bc4cb8aa.png"/>  на активном слое с полигонами, в нашем примере это <em>cmw_room</em>.</li>
</ul>
<p><img alt="Создание контура помещения AutoCAD" src="https://kb.comindware.ru/assets/img_65c63baf8d99c.png"/></p>
<p>Создание контура помещения AutoCAD
6. Прорисовку следует выполнять по контуру объекта чертежа.</p>
<p>Примечание</p>
<p>Полилиния замыкается командой «Замкнуть» по щелчку правой кнопкой мыши.
7. После создания всех полигонов необходимо перейти к созданию точек с текстом наименований полигонов. Сначала выберем активный слой, на который будут наноситься точки, в нашем случае это <em>cmw_room_attribute</em>, и используем инструмент «Текст» с вкладки ленточного меню «Главная».</p>
<p><img alt="Создание точки с текстом" src="https://kb.comindware.ru/assets/img_65c63c07f16dd.png"/></p>
<p>Создание точки с текстом
8. Если необходимо импортировать несколько уровней полигонов, для каждого из уровней необходимо выполнить вышеуказанные действия, возможно создание максимум трех уровней. В нашем примере были созданы:
   - слой полигонов <em>cmw_room</em>, на котором находятся полигоны помещений;
   - слой точек с наименованиями полигонов <em>cmw_room_attribute</em>, на котором находятся наименования помещений;
   - слой полигонов <em>cmw_workspace</em>, на котором находятся полигоны рабочих мест;
   - слой точек с наименованиями полигонов <em>cmw_workspace_attribute</em>, на котором находятся наименования рабочих мест.
9. По окончании подготовки чертежа можно переходить к импорту подготовленного DWG-файла в <strong>Comindware Platform</strong> для установления связей объектов чертежа с объектами системы.</p>
<h2 id="импорт-чертежа">Импорт чертежа</h2>
<p>Предусловие: должны быть созданы экземпляры шаблонов записей, которые необходимо связать с полигонами на чертеже, должен быть создан и вынесен на форму атрибут «Чертеж».</p>
<p>Примечание: для каждого уровня связи должен быть создан отдельный ШЗ.</p>
<ol class="colored_numbers_list">
<li>В поле атрибута типа <em>«</em><strong>Чертёж</strong><em>»</em> на форме нажмите кнопку «<strong>Загрузка файла</strong>».</li>
<li>На шаге 1 «<strong>Загрузка файла</strong>» в мастере «<strong>Настройка плана</strong>» выберите подготовленный DWG-файл.</li>
</ol>
<figure class="screenshot_with_caption" markdown="block">![](https://kb.comindware.ru/assets/img_65c640abd145d.png)&lt;figcaption&gt;&lt;/figcaption&gt;</figure>
<p>Шаг 1. Загрузка файла
3. В случае ошибочной загрузки файла его можно удалить и загрузить другой DWG-файл.
4. Нажмите кнопку «<strong>Далее</strong>» для перехода к следующему шагу.
5. На шаге 2 «<strong>Настройка связей</strong>» установите связи слоев DWG-файла с записями в приложении. Первыми привязывайте слои наружных полигонов — следуйте от больших областей к меньшим (вложенным).</p>
<ul>
<li>В поле «<strong>Слой полигонов</strong>» выберите слой с полигонами.</li>
<li>В поле «<strong>Слой наименований</strong>» выберите слой, на котором находятся текстовые наименования полигонов.</li>
<li>В поле «<strong>Шаблон записи</strong>» будет указан шаблон записи, заданный для уровня связи в свойствах поля атрибута «<strong>Чертёж</strong>». В этом шаблоне будут храниться записи, связанные с полигонами на чертеже.</li>
<li>
<p>В поле «<strong>Атрибут</strong>» будет указан ключевой атрибут имен объектов, заданный для уровня связи в свойствах поля атрибута «<strong>Чертёж</strong>». Этот атрибут будет использоваться для привязки полигонов по их наименованиям к записям в указанном шаблоне.</p>
<p><img alt="Шаг 2. Привязка слоёв чертежа к шаблонам и атрибутам" src="https://kb.comindware.ru/assets/img_65c640914bb78.png"/></p>
<p>Шаг 2. Привязка слоёв чертежа к шаблонам и атрибутам</p>
</li>
</ul>
<h2 id="связанные-статьи">Связанные статьи</h2>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4761">Чертёж. Настройка шаблонов, атрибутов, форм и полей</a></strong></p>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4785">Чертёж. Настройка поля на форме</a></strong></p>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>