<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4890" kb-tags="" kb-title="Шевроны. Правила окрашивания. Пример настройки">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#введение">
<span class="md-ellipsis">
      Введение
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#прикладная-задача">
<span class="md-ellipsis">
      Прикладная задача
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#исходные-данные">
<span class="md-ellipsis">
      Исходные данные
    </span>
</a>
<nav aria-label="Исходные данные" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#шаблон-записи-этапы-заявок">
<span class="md-ellipsis">
      Шаблон записи «Этапы заявок»
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#шаблон-записи-заявки">
<span class="md-ellipsis">
      Шаблон записи «Заявки»
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#проверка-работы-приложения">
<span class="md-ellipsis">
      Проверка работы приложения
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="введение">Введение</h2>
<p>В этой статье представлен пример настройки правил окраски шевронов в зависимости от статуса их выполнения.</p>
<p>Определения</p>
<ul>
<li><strong>Шевроны</strong> служат для визуального отображения этапов.</li>
<li>Шевроны являются представлением атрибута типа «<strong>Запись</strong>», хранящего несколько значений.</li>
<li>Шевроны отображаются как последовательность цветных плашек с заголовками записей связанного шаблона.</li>
<li>Цвет шеврона можно задать двумя способами:</li>
<li>с помощью системного атрибута «<strong>Цвет</strong>» связанной записи;</li>
<li>с помощью <strong>правил окраски</strong> шевронов.</li>
<li>Если не настроены правила окраски шевронов или не сработает ни одно правило, они будут окрашиваться цветом, указанным в системном атрибуте «<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4785"><strong>Цвет</strong></a>» в соответствующих записях. Если при этом для записи атрибут «<strong>Цвет</strong>» не задан, то шеврон будет окрашен в зелёный цвет.</li>
<li>Если для одной записи одновременно сработают несколько правил, возвращающих разные цвета, то шеврон будет окрашен в цвет, заданный последним сработавшим правилом.</li>
<li>Правил окраски шевронов может быть неограниченное количество, но для оптимальной работы платформы рекомендуется задавать не более 8 условий.</li>
<li>При составлении правил окраски рекомендуется использовать атрибуты из связанного шаблона, хранящего данные этапов, а не атрибуты шаблона, на форме которого настраиваются шевроны.</li>
<li>Подробные сведения о настройке шевронов см. в параграфе <em>«<a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4785">Динамические элементы формы. Настройка шевронов</a>»</em>.</li>
</ul>
<h2 id="прикладная-задача">Прикладная задача</h2>
<p>Имеется приложение оформления заявок. Требуется окрашивать шевроны в соответствии со статусом этапов выполнения заявки:</p>
<ul>
<li>оранжевый #efbb3a — этап начался, если указана дата начала, но не указана дата завершения;</li>
<li>зеленый #338320 — этап завершился, если указаны даты начала и завершения;</li>
<li>серый #a8a8a8 — этап не начался, если не указаны ни дата начала, ни дата завершения.</li>
</ul>
<h2 id="исходные-данные">Исходные данные</h2>
<p>Создайте приложение <em>«Управление заявками»</em> и настройте в нём перечисленные ниже шаблоны.</p>
<h3 id="шаблон-записи-этапы-заявок">Шаблон записи «Этапы заявок»</h3>
<ol class="colored_numbers_list">
<li>Создайте <strong>шаблон записи</strong> <em>«Этапы»</em>.</li>
<li>Создайте следующие атрибуты в этом шаблоне:</li>
</ol>
<table style="width: 100%;">
<thead>
<tr>
<th>Название атрибута</th>
<th>Свойства</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Номер этапа</em></td>
<td><strong>Тип данных: число</strong> <strong>Количество знаков после запятой: 0</strong></td>
</tr>
<tr>
<td><em>Название этапа</em></td>
<td><strong>Тип данных: текст</strong> <strong>Формат отображения:</strong> <strong>обычный текст</strong> <strong>Использовать как заголовок записей:</strong> флажок установлен</td>
</tr>
<tr>
<td><em>Дата начала</em></td>
<td><strong>Тип данных: дата и время</strong></td>
</tr>
<tr>
<td><em>Дата завершения</em></td>
<td><strong>Тип данных: дата и время</strong></td>
</tr>
</tbody>
</table>
<h3 id="шаблон-записи-заявки">Шаблон записи «Заявки»</h3>
<ol class="colored_numbers_list">
<li>Создайте ним <strong>шаблон записи</strong><em>«Заявки»</em>.</li>
<li>В шаблоне записи <em>«Заявки»</em> создайте следующие атрибуты:</li>
</ol>
<table style="width: 100%;">
<thead>
<tr>
<th>Название атрибута</th>
<th>Свойства</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Этапы</em></td>
<td><strong>Тип данных: запись</strong> <strong>Связанный шаблон:</strong> <em>Этапы заявок</em> <strong>Хранить несколько значений:</strong> флажок установлен  <strong>Взаимная связь с атрибутом:</strong>  <strong>с новым</strong> <strong>Свойства нового атрибута:</strong>  - <strong>Название</strong>: <em>Заявка</em> - <strong>Хранить несколько значений</strong><strong><em>*:</em></strong>*  флажок снят</td>
</tr>
<tr>
<td>3. Откройте конструктор основной формы шаблона <em>«Заявки».</em></td>
<td></td>
</tr>
<tr>
<td>4. Вынесите на форму атрибут <em>«Название заявки».</em></td>
<td></td>
</tr>
<tr>
<td>5. Вынесите на форму атрибут <em>«Этапы»</em></td>
<td></td>
</tr>
<tr>
<td>6. На панели «<strong>Свойства поля</strong>» выберите <strong>представление</strong> «<strong>Таблица</strong>».</td>
<td></td>
</tr>
<tr>
<td>7. В поле «<strong>Сортировка</strong>» на панели «<strong>Свойства таблицы</strong>» выберите атрибут <em>«Номер этапа»</em>.</td>
<td></td>
</tr>
<tr>
<td>8. Поместите в таблицу <em>«Этапы»</em> атрибуты из шаблона <em>«Этапы»</em> в качестве столбцов<em>:</em></td>
<td></td>
</tr>
<tr>
<td>- <em>Номер этапа</em></td>
<td></td>
</tr>
<tr>
<td>- <em>Название этапа</em></td>
<td></td>
</tr>
<tr>
<td>- <em>Дата начала</em></td>
<td></td>
</tr>
<tr>
<td>- <em>Дата завершения</em></td>
<td></td>
</tr>
<tr>
<td>9. Добавьте на область кнопок таблицы <em>«Этапы»</em> кнопку <strong>«Создать»</strong>.</td>
<td></td>
</tr>
<tr>
<td>10. Снова вынесите на форму шаблона <em>«Заявки»</em> атрибут <em>«Этапы»</em>.</td>
<td></td>
</tr>
<tr>
<td>11. В панели «<strong>Свойства поля</strong>» выберите <strong>представление</strong> «<strong>Шевроны</strong>».</td>
<td></td>
</tr>
<tr>
<td>12. Настройте свойства шевронов:</td>
<td></td>
</tr>
<tr>
<td>- <strong>Упорядочивание: <em>ID</em></strong></td>
<td></td>
</tr>
<tr>
<td>- <strong>Правила окраски записей:</strong> нажимайте <strong>«Создать»</strong>  и настройте следующие правила:</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><code><pre><span></span><code>  | Цвет | Условие: формула |</code> <br/><code>  | --- | --- |</code> <br/><code>  | Оранжевый  #efbb3a | ``` AND(NOT(EMPTY($Datanachala)),EMPTY($Datazaversheniya)) ``` |</code> <br/><code>  | Зелёный   #338320 | ``` AND(NOT(EMPTY($Datazaversheniya)),NOT(EMPTY($Datanachala)))                ``` |</code> <br/><code>  | Серый   #a8a8a8 | ``` AND(EMPTY($Datanachala),EMPTY($Datazaversheniya))                 ``` |</code> <br/><code></code> <br/><code>  Примечание</code> <br/><code></code> <br/><code>  Следует помнить, что условие окрашивания шеврона вычисляется в контексте шаблона, связанного с текущим шаблоном посредством с атрибута типа «**Запись**». Поэтому обратиться к атрибутам текущего шаблона, на форме которого размещены шевроны, можно только посредством обратной ссылки. Например, к атрибуту **ID** заявки можно обратиться посредством атрибута *«Заявка»* из связанного шаблона, который ссылается на текущий шаблон*:* `$Zayavka-&gt;id`.</code> <br/></pre></code></div>
<ol class="colored_numbers_list" start="13">
<li>Сохраните форму.</li>
</ol>
<h2 id="проверка-работы-приложения">Проверка работы приложения</h2>
<ol class="colored_numbers_list">
<li>Откройте шаблон процесса <em>«Заявки»</em>.</li>
<li>Нажмите кнопку «<strong>Перейти к экземплярам</strong>».</li>
<li>Отобразится таблица «<strong>Все записи</strong>» со списком заявок.</li>
<li>Создайте и заполните несколько строк в таблице <em>«Этапы»</em> на форме заявки:
   - введите <em>название этапа;</em>
   - у некоторых этапов введите только <em>дату начала</em> или только <em>дату завершения</em>;
   - у некоторых этапов не указывайте ни одну из дат.</li>
<li>После заполнения каждой строки в таблице <em>«Этапы»</em> сохраняйте запись, чтобы применить изменения.</li>
<li>Для каждой строки в таблице <em>«Этапы»</em> должен появляться шеврон с <em>названием этапа</em>.</li>
<li>Цвета шевронов должны меняться в зависимости от значений в столбцах <em>«Дата начала»</em> и <em>«Дата завершения»</em> таблицы <em>«Этапы».</em></li>
</ol>
<figure class="screenshot_with_caption">
<p><img alt="Прогресс выполнения заявки в виде шевронов" src="https://kb.comindware.ru/assets/img_660a9e23f3b6c.png"/><figcaption class="caption">Прогресс выполнения заявки в виде шевронов</figcaption></p>
</figure>
<h2 id="связанные-статьи">Связанные статьи</h2>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4915">Шевроны. Визуализация этапов процесса. Пример настройки</a></strong></p>
<p><strong><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4785">Динамические элементы формы. Настройка шевронов</a></strong></p>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>