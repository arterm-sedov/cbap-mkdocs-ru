<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4623">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#описание-подсистемы-журналирования">
<span class="md-ellipsis">
      Описание подсистемы журналирования
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#типы-журналов">
<span class="md-ellipsis">
      Типы журналов
    </span>
</a>
<nav aria-label="Типы журналов" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#logging_engine_rules">
<span class="md-ellipsis">
      Правила формирования журналов
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#типы-событий-в-журналах">
<span class="md-ellipsis">
      Типы событий в журналах
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#logging_engine_audit_log">
<span class="md-ellipsis">
      Журнал аудита
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-интеграции">
<span class="md-ellipsis">
      Журнал интеграции
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-интеграции-с-сырыми-данными">
<span class="md-ellipsis">
      Журнал интеграции с сырыми данными
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-исправности">
<span class="md-ellipsis">
      Журнал исправности
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-обновления">
<span class="md-ellipsis">
      Журнал обновления
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-ошибок">
<span class="md-ellipsis">
      Журнал ошибок
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-процессов">
<span class="md-ellipsis">
      Журнал процессов
    </span>
</a>
<nav aria-label="Журнал процессов" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#рекомендации-по-чтению-журнала-процессов">
<span class="md-ellipsis">
      Рекомендации по чтению журнала процессов
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-резервного-копирования">
<span class="md-ellipsis">
      Журнал резервного копирования
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#журнал-сценариев">
<span class="md-ellipsis">
      Журнал сценариев
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#системный-журнал">
<span class="md-ellipsis">
      Системный журнал
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#logging_engine_adapter_logs">
<span class="md-ellipsis">
      Журналы адаптеров
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#связанные-статьи">
<span class="md-ellipsis">
      Связанные статьи
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="описание-подсистемы-журналирования">Описание подсистемы журналирования</h2>
<p>Подсистема журналирования <strong>Comindware Platform</strong> использует библиотеку <em>NLog</em> (с открытым исходным кодом), которая записывает данные в журналы.</p>
<p>Полная документация по настройке <em>NLog</em> для журналирования представлена по адресу: <em><a class="mkdocs_imported_link" href="https://github.com/NLog/NLog/wiki/File-target">https://github.com/NLog/NLog/wiki/File-target</a></em></p>
<p>ПО позволяет настроить уровень журналирования, правила формирования событий в журналах, место хранения журналов, порядок и набор параметров именования журналов, а также ограничения по размеру и предельному количеству журналов, с помощью конфигурационных файлов.</p>
<p>Подробное описание структуры конфигурационного файла см. в документации <em>NLog</em> по адресу: <em><a class="mkdocs_imported_link" href="https://github.com/NLog/NLog/wiki/Tutorial">https://github.com/NLog/NLog/wiki/Tutorial</a></em></p>
<h2 class="pageBreakBefore" id="типы-журналов">Типы журналов</h2>
<p>ПО ведёт следующие журналы:</p>
<ul>
<li><a class="mkdocs_imported_link" href="#logging_engine_adapter_logs">Адаптеры</a></li>
<li><a class="mkdocs_imported_link" href="#logging_engine_audit_log">Аудит</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-интеграции">Интеграция</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-интеграции-с-сырыми-данными">Интеграция — сырые данные</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-исправности">Исправность ПО</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-обновления">Обновление</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-ошибок">Ошибки</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-процессов">Процессы</a></li>
<li><a class="mkdocs_imported_link" href="#системный-журнал">Системный журнал</a></li>
<li><a class="mkdocs_imported_link" href="#журнал-резервного-копирования">Резервное копирование</a></li>
<li>Трансфер — в составе журнала <a class="mkdocs_imported_link" href="#журнал-ошибок">ошибок</a></li>
</ul>
<p>Каждый журналов содержит структурированный текст с пробелами в качестве разделителей.</p>
<p>В качестве инструментов чтения и анализа журналов можно использовать любой инструмент, представленный на рынке. Например, есть мощный инструмент Kibana <em><a class="mkdocs_imported_link" href="https://www.elastic.co/products/kibana">https://www.elastic.co/products/kibana</a></em>, который обладает широким спектром функций по сбору журналов с различных ресурсов и их глубокому анализу с различными визуальными представлениями, в том числе в виде графиков.</p>
<h4 id="logging_engine_rules">Правила формирования журналов</h4>
<p>Журналы формируются и выводятся в <code>stdout</code> в следующем формате:</p>
<div class="highlight"><code><pre><span></span><code>[CMW.SeviceName][LogName] - LogLevel – LogMessage</code> <br/></pre></code></div>
<p>Здесь <code>[LogName]</code> — имя журнала.</p>
<h4 class="pageBreakBefore" id="типы-событий-в-журналах">Типы событий в журналах</h4>
<p>В журналах предусмотрены следующие типы событий:</p>
<ul>
<li><code>Fatal</code> — критическая ошибка в работе ПО;</li>
<li><code>Error</code> — ошибка в работе ПО;</li>
<li><code>Warn</code> — некорректное поведение, но ПО продолжает свою работу;</li>
<li><code>Info</code> — обычное событие, например отправка письма, обновление данных аккаунта;</li>
<li><code>Debug</code> — выполнение запросов, аутентификация пользователей;</li>
<li><code>Trace</code> — запуск методов, завершение методов.</li>
</ul>
<h4 class="pageBreakBefore" id="logging_engine_audit_log">Журнал аудита</h4>
<p>Журнал аудита содержит перечисленные ниже события:</p>
<ul>
<li>Неуспешные попытки входа в Систему.</li>
<li>Успешный вход в Систему.</li>
<li>Выход из Системы.</li>
<li>Веб-запросы клиента, отправляемые пользователями на сервер (запрос данных или сохранение данных).</li>
<li>Изменения системных ролей и ролей в приложениях.</li>
<li>Попытки несанкционированного доступа для просмотра, создания, редактирования и удаления данных в следующих разделах:<ul>
<li>API</li>
<li>Записи, экземпляры процессов, аккаунты</li>
<li>Прикреплённые к записям файлы</li>
<li>Страницы:<ul>
<li>Администрирование системы<ul>
<li>Темы</li>
<li>Дизайн страницы входа и регистрации</li>
<li>Приложения</li>
<li>Разделы навигации</li>
<li>Шаблоны</li>
<li>Функции</li>
<li>Пути передачи данных</li>
<li>Аккаунты</li>
<li>Группы</li>
<li>Системные роли</li>
<li>Аудит разрешений аккаунтов</li>
<li>Замещение</li>
<li>Регистрация и вход</li>
<li>Мониторинг</li>
<li>Журналы событий</li>
<li>Лицензирование</li>
<li>Резервное копирование</li>
<li>Управление системными службами</li>
<li>Подключения</li>
<li>Производительность</li>
<li>Конфигурация журналирования</li>
<li>Глобальная конфигурация</li>
</ul>
</li>
<li>Администрирование приложения<ul>
<li>Шаблоны</li>
<li>Роли</li>
<li>Разделы навигации</li>
<li>Функции</li>
<li>Переменные</li>
<li>Сценарии</li>
<li>Интернет-магазин</li>
<li>Интеграции</li>
<li>Пути передачи данных</li>
<li>Active Directory</li>
<li>Аудит разрешений аккаунтов</li>
<li>Активность компонентов</li>
<li>Управление версиями</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="pageBreakBefore">Стандартное имя журнала аудита: <code>Audit</code></p>
<p>Журнал сообщений аудита содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>IP-адрес клиента;</li>
<li>адрес сервера;</li>
<li>статус обработки запроса;</li>
<li>длительность обработки запроса;</li>
<li>запрос или текст сообщения;</li>
<li>сведения об изменении роли.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-интеграции">Журнал интеграции</h4>
<p>Журнал интеграции содержит информационные сообщения по событиям, возникающим в ходе работы интеграционных сервисов ПО (таких, как подключения и адаптеры).</p>
<p>Стандартное имя журнала ошибок: <code>Integration</code></p>
<p>Журнал интеграции содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>имя сервера;</li>
<li>порт сервера</li>
<li>IP-адрес клиента;</li>
<li>идентификатор интеграции;</li>
<li>идентификатор подключения;</li>
<li>текст сообщения.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-интеграции-с-сырыми-данными">Журнал интеграции с сырыми данными</h4>
<p>Журнал интеграции с сырыми данными содержит те же сведения, что журнал интеграции, но с полным содержимым сообщений от внешних систем.</p>
<p>Стандартное имя журнала с сырыми данными: <code>Integration_raw</code></p>
<p>Журнал интеграции с сырыми данными содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>адрес сервера;</li>
<li>порт сервера;</li>
<li>IP-адрес клиента;</li>
<li>текст сообщения.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-исправности">Журнал исправности</h4>
<p>Журнал исправности содержит сведения о состоянии экземпляра ПО: дисковом пространстве, использовании подключений, работе сервиса OpenSearch (Elasticsearch), работе подсистем, выполнении экземпляров процессов.</p>
<p>Стандартное имя журнала исправности: <code>Heartbeat</code></p>
<p>Журнал исправности ПО содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>адрес сервера;</li>
<li>порт сервера;</li>
<li>IP-адрес клиента;</li>
<li>текст сообщения.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-обновления">Журнал обновления</h4>
<p>Журнал обновления содержит сведения о результатах обновления версий ПО.</p>
<p>Журнал обновления разделён на два:</p>
<ul>
<li><code>UpgradeOntology</code> — информация об обновлении структуры данных;</li>
<li><code>Update</code> — информация о ходе процесса обновления.</li>
</ul>
<p>Журнал обновления содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>адрес сервера;</li>
<li>порт сервера;</li>
<li>IP-адрес клиента;</li>
<li>текст сообщения.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-ошибок">Журнал ошибок</h4>
<p>Журнал ошибок содержит данные обо всех ошибках, возникающих в ходе работы экземпляра ПО, а также об <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4808">импорте и экспорте версий приложений</a>.</p>
<p>Стандартное имя журнала ошибок: <code>Error</code></p>
<p>Журнал ошибок содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>имя сервера;</li>
<li>порт сервера;</li>
<li>IP-адрес клиента;</li>
<li>идентификатор события;</li>
<li>имя подсистемы, в которой произошло событие;</li>
<li>длительность обработки запроса;</li>
<li>версия ПО;</li>
<li>идентификатор интеграции;</li>
<li>идентификатор подключения;</li>
<li>сообщение об ошибке.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-процессов">Журнал процессов</h4>
<p>Журнал процессов содержит сведения о движении токенов по элементам экземпляров процессов.</p>
<p>Стандартное имя журнала процессов: <code>Process</code></p>
<p>Журнал процессов содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>идентификатор экземпляра процесса;</li>
<li>идентификатор токена;</li>
<li>идентификатор элемента экземпляра процесса;</li>
<li>текст сообщения;</li>
<li>длительность выполнения.</li>
</ul>
<h5 class="pageBreakBefore" id="рекомендации-по-чтению-журнала-процессов">Рекомендации по чтению журнала процессов</h5>
<ul>
<li>В журнале процессов отражается факт создания экземпляра процесса с указанием его идентификатора.</li>
<li>Чтобы журнал процессов содержал более наглядные сведения, при настройке диаграммы процесса давайте элементам понятные системные имена.</li>
<li>Для элемента диаграммы процесса указываются сведения о трёх событиях:<ul>
<li>создание токена или вход токена в элемент — строка с идентификатором элемента вида <code>Enter(psa.XXX) by Flow:psf.XXX</code> (при создании токена не указывается идентификатор потока);</li>
<li>выполнение элемента — строка с идентификатором элемента вида <code>Execute</code> или <code>ContinueExecute</code>;</li>
<li>выход токена из элемента — строка с идентификатором потока вида <code>Exit by Flow:psf.XXX</code>.</li>
</ul>
</li>
<li>В строке события могут быть указаны следующие сведения:<ul>
<li>идентификатор экземпляра процесса вида <code>PID:XXX</code>;</li>
<li>идентификатор токена вида <code>TID:ptkn.XX</code>;</li>
<li>системное имя и идентификатор элемента вида <code>(elementSystemName)psa.XXX</code>;</li>
<li>системное имя и идентификатор потока вида <code>psf.XXX</code>;</li>
<li>идентификатор потока с идентификатором потока вида <code>Flow:psf.XXX</code>;</li>
<li>перечень последующих элементов, начинающийся с ключевого слова <code>NextActions</code>.</li>
</ul>
</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-резервного-копирования">Журнал резервного копирования</h4>
<p>Журнал резервного копирования содержит информационные сообщения по результатам резервного копирования экземпляра ПО.</p>
<p>Стандартное имя журнала резервного копирования: <code>Backup</code></p>
<p>Журнал резервного копирования содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>адрес сервера;</li>
<li>порт сервера;</li>
<li>IP-адрес клиента;</li>
<li>текст сообщения.</li>
</ul>
<h4 class="pageBreakBefore" id="журнал-сценариев">Журнал сценариев</h4>
<p>Журнал сценариев содержит сведения о ходе выполнения сценариев.</p>
<p>Стандартное имя журнала сценариев: <code>Trigger</code></p>
<p>Журнал сценариев содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>инициатор вызова сценария;</li>
<li>идентификатор сценария;</li>
<li>тип события, запустившего сценарий;</li>
<li>идентификатор шаблона записи;</li>
<li>идентификатор записи;</li>
<li>длительность выполнения;</li>
<li>сведения о действиях, исполненных в ходе сценария:<ul>
<li>идентификатор действия сценария;</li>
<li>тип действия;</li>
<li>идентификатор шаблона записи;</li>
<li>идентификатор записи;</li>
<li>длительность выполнения.</li>
</ul>
</li>
</ul>
<h4 class="pageBreakBefore" id="системный-журнал">Системный журнал</h4>
<p>Системный журнал содержит данные о событиях системного уровня в экземпляре ПО.</p>
<p>Стандартное имя системного журнала: <code>System</code></p>
<p>Системный журнал содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>ID сеанса;</li>
<li>имя аккаунта, инициировавшего событие;</li>
<li>адрес сервера;</li>
<li>порт сервера;</li>
<li>IP-адрес клиента;</li>
<li>текст сообщения.</li>
</ul>
<h4 class="pageBreakBefore" id="logging_engine_adapter_logs">Журналы адаптеров</h4>
<p>Журналы адаптеров содержат данные о событиях подключений и путей передачи данных, относящихся к <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4672">адаптерам</a> в экземпляре ПО.</p>
<p>Имена журналов адаптеров формируются следующим образом:</p>
<ul>
<li>сервис встроенных адаптеров: <code>adapter_internal</code></li>
<li>сервис пользовательских адаптеров: <code>adapter_external_system</code></li>
<li>подключение встроенного адаптера: <code>adapter_internal_&lt;имя_подключения&gt;</code></li>
<li>подключение заказного адаптера: <code>adapter_external_&lt;имя_подключения&gt;</code></li>
<li>исправность заказного адаптера: <code>adapter_external_heartbeat</code></li>
<li>подключение заказного адаптера к брокеру сообщений: <code>adapter_external_kafkaClient</code></li>
</ul>
<p>Журнал адаптера содержит следующие сведения:</p>
<ul>
<li>дата события;</li>
<li>время события;</li>
<li>тип сообщения;</li>
<li>описание события;</li>
<li>контекст события;</li>
<li>описание исключения (необязательно);</li>
<li>текст сообщения (необязательно).</li>
</ul>
<div class="relatedTopics">
<h2 id="связанные-статьи">Связанные статьи</h2>
<ul>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4618">Примеры событий в журналах</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4620">Пути и содержимое папок экземпляра ПО</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4672">Адаптеры</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4666">Просмотр показателей мониторинга с помощью страницы «Администрирование»</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4673">Просмотр журналов событий с помощью страницы «Администрирование»</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4669">Просмотр показателей производительности с помощью страницы «Администрирование»</a></em></li>
<li><em><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4667">Конфигурация журналирования. Настройка, скачивание журналов</a></em></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>