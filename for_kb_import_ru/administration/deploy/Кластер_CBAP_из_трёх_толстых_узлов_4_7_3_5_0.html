<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="" kb-tags="" kb-title="">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#используемые-серверы">
<span class="md-ellipsis">
      Используемые серверы
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#создание-nfs-сервера-cbap_test_nfs---10004">
<span class="md-ellipsis">
      Создание NFS-сервера cbap_test_nfs - 10.0.0.4
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#на-каждом-сервере-приложения">
<span class="md-ellipsis">
      На каждом сервере приложения!!!
    </span>
</a>
<nav aria-label="На каждом сервере приложения!!!" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#установка-и-настройка-бинарных-пакетов-приложения-apache-ignite">
<span class="md-ellipsis">
      Установка и настройка бинарных пакетов приложения Apache Ignite
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#установка-nfs-клиента-на-серверы-приложений">
<span class="md-ellipsis">
      Установка NFS-клиента на Серверы приложений
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#конфигурация-окружения-экземпляра-приложения">
<span class="md-ellipsis">
      Конфигурация окружения экземпляра Приложения
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#на-сервере-приложения-cbap-test_1--10001">
<span class="md-ellipsis">
      На сервере Приложения cbap-test_1- 10.0.0.1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#запустить-экземпляр-приложения-на-cbap_test_1">
<span class="md-ellipsis">
      Запустить экземпляр приложения на cbap_test_1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#на-сервере-приложения-cbap_test_2---10002">
<span class="md-ellipsis">
      На сервере Приложения cbap_test_2 - 10.0.0.2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#на-сервере-приложениcbap-test3---10003">
<span class="md-ellipsis">
      На сервере Приложениcbap-test3 - 10.0.0.3
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h3 id="используемые-серверы">Используемые серверы</h3>
<p>cbap-test_1 - 10.0.0.1 - Сервер Приложения, узел 1</p>
<p>cbap-test_2 - 10.0.0.2 - Сервер Приложения, узел 2</p>
<p>cbap-test_3 - 10.0.0.3 - Сервер Приложения, узел 3</p>
<p>cbap_test_nfs - 10.0.0.4 - Сервер Хранения данных, NFS</p>
<h3 id="создание-nfs-сервера-cbap_test_nfs---10004">Создание NFS-сервера cbap_test_nfs - 10.0.0.4</h3>
<div class="highlight"><code><pre><span></span><code>mkdir<span class="w"> </span>/share</code> <br/><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nfs-kernel-server</code> <br/><code>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>nfs-kernel-server.service</code> <br/></pre></code></div>
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/etc/exports</code> <br/></pre></code></div>
<p>добавить строку:
<code>/share &lt;clientIP&gt;/&lt;netMask&gt;(rw,sync,no_subtree_check)</code></p>
<div class="highlight"><code><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>nfs-kernel-server.service</code> <br/><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/share/&lt;instanceName&gt;/Streams</code> <br/><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/share/&lt;instanceName&gt;/Scripts</code> <br/><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/share/&lt;instanceName&gt;/Temp</code> <br/><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/share/&lt;instanceName&gt;/Localtemp</code> <br/><code></code> <br/><code>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">777</span><span class="w"> </span>/share/&lt;instanceName&gt;</code> <br/><code>chown<span class="w"> </span>-R<span class="w"> </span>nobody:nogroup<span class="w"> </span>/share</code> <br/></pre></code></div>
<h3 id="на-каждом-сервере-приложения">На каждом сервере приложения!!!</h3>
<h4 id="установка-и-настройка-бинарных-пакетов-приложения-apache-ignite">Установка и настройка бинарных пакетов приложения Apache Ignite</h4>
<p>Скачать бинарный дистрибутив Apache Ignite, например <a class="mkdocs_imported_link" href="https://downloads.apache.org/ignite/2.16.0/apache-ignite-2.16.0-bin.zip">apache-ignite-2.16.0-bin.zip</a> или более новую версию.
Перейти в режим суперпользователя:
  ```sh
su -
<div class="highlight"><code><pre><span></span><code>или</code> <br/><code>```sh</code> <br/><code>sudo -s</code> <br/></pre></code></div></p>
<p>Распаковать дистрибутив Apache Ignite в домашнюю папку (здесь и далее <code>username</code> — имя текущего пользователя):
<div class="highlight"><code><pre><span></span><code>unzip<span class="w"> </span>apache-ignite-2.16.0-bin.zip<span class="w"> </span>-d<span class="w"> </span>/usr/share/</code> <br/><code>mv<span class="w"> </span>/usr/share/apache-ignite*<span class="w"> </span>/usr/share/ignite</code> <br/></pre></code></div></p>
<p>Задать переменную среды <code>IGNITE_HOME</code>:
<div class="highlight"><code><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">IGNITE_HOME</span><span class="o">=</span>/usr/share/ignite</code> <br/></pre></code></div></p>
<p>Скопировать в папку <code>/usr/share/ignite</code> файл <code>Ignite.config</code> из папки <code>/var/www/&lt;instanceName&gt;</code> (где <code>&lt;instanceName&gt;</code> — имя экземпляра ПО):
<div class="highlight"><code><pre><span></span><code>cp<span class="w"> </span>/var/www/instanceName/Ignite.config<span class="w"> </span>/usr/share/ignite/</code> <br/></pre></code></div></p>
<p>Перейти в папку <code>bin</code> Apache Ignite:
<div class="highlight"><code><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/home/username/ignite/bin</code> <br/></pre></code></div></p>
<p>В файле <code>control.sh</code> изменить директиву <code>DEFAULT_CONFIG</code>:
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>control.sh</code> <br/></pre></code></div></p>
<div class="highlight"><code><pre><span></span><code><span class="n">DEFAULT_CONFIG</span><span class="p">=</span><span class="n">config</span><span class="p">/</span><span class="n">Ignite</span><span class="p">.</span><span class="n">config</span></code> <br/></pre></code></div>
<p>Проверить получение списка узлов, зарегистрированных в базовой топологии:
<div class="highlight"><code><pre><span></span><code>bash<span class="w"> </span>control.sh<span class="w"> </span>--baseline</code> <br/></pre></code></div></p>
<p>При незапущенных экземплярах приложения запрос должен отдать пустую топологию</p>
<h4 id="установка-nfs-клиента-на-серверы-приложений">Установка NFS-клиента на Серверы приложений</h4>
<p>После создания NFS-сервера установить NFS-клиент на серверы Приложений
<div class="highlight"><code><pre><span></span><code>sudo apt install nfs-common</code> <br/><code>nano /etc/fstab</code> <br/></pre></code></div></p>
<p>добавить строку
<code>10.0.0.4:/share  /mnt/share  nfs  defaults,nofail,_netdev,x-systemd.automount  0  0</code></p>
<p>Выполнить монтирование дисков, создать и настроить директории и ссылки
<div class="highlight"><code><pre><span></span><code>mount<span class="w"> </span>-a</code> <br/><code>ls<span class="w"> </span>-lh<span class="w"> </span>/mnt/share</code> <br/><code>mkdir<span class="w"> </span>/db</code> <br/><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/db/&lt;instanceName&gt;/Database/</code> <br/><code>mkdir<span class="w"> </span>/var/lib/comindware</code> <br/><code>ln<span class="w"> </span>-s<span class="w"> </span>/db/&lt;instanceName&gt;<span class="w"> </span>/var/lib/comindware/&lt;instanceName&gt;</code> <br/><code>ln<span class="w"> </span>-s<span class="w"> </span>/mnt/share/&lt;instanceName&gt;/Scripts<span class="w"> </span>/db/&lt;instanceName&gt;/Database/Scripts</code> <br/><code></code> <br/><code>chown<span class="w"> </span>-R<span class="w"> </span>www-data:<span class="w"> </span>/var/lib/comindware<span class="w"> </span>/db/&lt;instanceName&gt;</code> <br/></pre></code></div></p>
<h4 id="конфигурация-окружения-экземпляра-приложения">Конфигурация окружения экземпляра Приложения</h4>
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/etc/sysconfig/comindware&lt;instanceName&gt;-env</code> <br/></pre></code></div>
<p>проверить значения в строке
<div class="highlight"><code><pre><span></span><code><span class="n">JVM_OPTS</span><span class="p">=-</span><span class="n">Xms512m</span><span class="w"> </span><span class="p">-</span><span class="n">Xmx4g</span><span class="w"> </span><span class="p">-</span><span class="n">XX</span><span class="p">:</span><span class="n">MaxDirectMemorySize</span><span class="p">=</span><span class="mi">1</span><span class="n">g</span><span class="p">...</span></code> <br/></pre></code></div></p>
<h3 id="на-сервере-приложения-cbap-test_1--10001">На сервере Приложения cbap-test_1- 10.0.0.1</h3>
<p>в директорию <code>/home/admin</code> скопирована РК <code>&lt;instanceName&gt;.XXX.cdbbz</code>
Установлена версия CBAP, создан экземпляр с именем <code>&lt;instanceName&gt;</code>
распаковать и подложить РК в дитекторию БД
<div class="highlight"><code><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/home/admin</code> <br/><code>unzip<span class="w"> </span>-q<span class="w"> </span>&lt;instanceName&gt;.XXX.cdbbz</code> <br/><code>cp<span class="w"> </span>-r<span class="w"> </span>Scripts/*<span class="w"> </span>/mnt/share/&lt;instanceName&gt;/Scripts/</code> <br/><code>cp<span class="w"> </span>-r<span class="w"> </span>Streams/*<span class="w"> </span>/mnt/share/&lt;instanceName&gt;/Streams/</code> <br/><code>mv<span class="w"> </span>Database/*<span class="w"> </span>/db/&lt;instanceName&gt;/Database/</code> <br/><code>rm<span class="w"> </span>-rf<span class="w"> </span>Database<span class="w"> </span>Scripts<span class="w"> </span>Streams</code> <br/><code>chown<span class="w"> </span>-R<span class="w"> </span>www-data:<span class="w"> </span>/db/&lt;instanceName&gt;</code> <br/></pre></code></div></p>
<p>Изменить конфигурацию Ignite
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/var/www/&lt;instanceName&gt;/Ignite.config</code> <br/></pre></code></div>
заменить значения в <code>"localAddress"</code> - указать IP
прописать IP узлов кластера Apache Ignite
проверить размер выделенной памяти
<div class="highlight"><code><pre><span></span><code><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"discoverySpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.discovery.tcp.TcpDiscoverySpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localAddress"</span><span class="w"> </span><span class="na">value=</span><span class="s">"10.0.0.1"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPort"</span><span class="w"> </span><span class="na">value=</span><span class="s">"47510"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPortRange"</span><span class="w"> </span><span class="na">value=</span><span class="s">"9"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"ipFinder"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.discovery.tcp.ipfinder.vm.TcpDiscoveryVmIpFinder"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"addresses"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;list&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.1:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.2:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.3:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;/list&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"communicationSpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.communication.tcp.TcpCommunicationSpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPort"</span><span class="w"> </span><span class="na">value=</span><span class="s">"47101"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localAddress"</span><span class="w"> </span><span class="na">value=</span><span class="s">"10.0.0.1"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"messageQueueLimit"</span><span class="w"> </span><span class="na">value=</span><span class="s">"1024"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/><code>...</code> <br/><code>...</code> <br/><code><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"dataRegionConfigurations"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;list&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.DataRegionConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"warmUpConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.NoOpWarmUpConfiguration"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"name"</span><span class="w"> </span><span class="na">value=</span><span class="s">"Persistent"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"persistenceEnabled"</span><span class="w"> </span><span class="na">value=</span><span class="s">"true"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"initialSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{1024L * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"maxSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{4L * 1024 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"pageEvictionMode"</span><span class="w"> </span><span class="na">value=</span><span class="s">"RANDOM_2_LRU"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"checkpointPageBufferSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{1024L * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.DataRegionConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"name"</span><span class="w"> </span><span class="na">value=</span><span class="s">"InMemory"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"persistenceEnabled"</span><span class="w"> </span><span class="na">value=</span><span class="s">"false"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"initialSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{10 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"maxSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{256 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;/list&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/></pre></code></div></p>
<p>Выполнить настройку экземпляра Приложения
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/usr/share/comindware/configs/instance/&lt;instanceName&gt;.yml</code> <br/></pre></code></div></p>
<div class="highlight"><code><pre><span></span><code>clusterName: cmwdata</code> <br/><code>nodeName: cmwdata_1</code> <br/><code>configPath: /var/www/cmwdata</code> <br/><code>journal.server: http://localhost:9200</code> <br/><code>journal.name: pik_prod_test</code> <br/><code>fqdn:</code> <br/><code>port: 80</code> <br/><code>version: 4.7.33413.0</code> <br/><code>db.workDir: /var/lib/comindware/cmwdata/Database</code> <br/><code>db.name: pik_test</code> <br/><code>userStorage.type: LocalDisk</code> <br/><code>userStorage.localDisk.path: /mnt/share/cmwdata/Streams</code> <br/><code>tempStorage.type: LocalDisk</code> <br/><code>tempStorage.localDisk.path: /mnt/share/cmwdata/Temp</code> <br/><code>tempWorkingDir: /mnt/share/cmwdata/LocalTemp</code> <br/><code>mq.server: 10.9.10.5:9092</code> <br/><code>mq.group: pik_cmwdata</code> <br/><code>mq.name: cmwdata</code> <br/><code>mq.node: cmwdata_1</code> <br/><code>backup.defaultFolder: /mnt/share/cmwdata/Backup</code> <br/><code>backup.defaultFileName: Backup</code> <br/><code>backup.enabled: true</code> <br/><code>backup.schedulesEnabled: true</code> <br/><code>backup.journalRepository.type: LocalDisk</code> <br/><code>backup.journalRepository.localDisk.path: /mnt/share/elasticsearch</code> <br/></pre></code></div>
<p>перед первым запуском убедиться в отсутствии файла конфигурации служб экземпляра
<div class="highlight"><code><pre><span></span><code>rm<span class="w"> </span>-f<span class="w"> </span>/var/www/npportalid/Workers.config</code> <br/></pre></code></div></p>
<h3 id="запустить-экземпляр-приложения-на-cbap_test_1">Запустить  экземпляр приложения на cbap_test_1</h3>
<p><div class="highlight"><code><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>comindware&lt;instanceName&gt;</code> <br/></pre></code></div>
Выполнить запрос через браузер
В Maintenance Mode выключить ненужные службы.
Дождаться полного запуска и войти в систему</p>
<p>Открыть файл конфигурации работающих служб, проверить статус служб, скопировать/перенести файл конфигурации на узлы 2 и 3.
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/var/www/&lt;instanceName&gt;/Workers.config</code> <br/></pre></code></div></p>
<div class="highlight"><code><pre><span></span><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></code> <br/><code><span class="nt">&lt;WorkerEngine</span><span class="w"> </span><span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-i</span><span class="nt">&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;RebuildThreadWorker&gt;</span>false<span class="nt">&lt;/RebuildThreadWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;BackupSessionsQueue&gt;</span>true<span class="nt">&lt;/BackupSessionsQueue&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SessionManagerWorker&gt;</span>false<span class="nt">&lt;/SessionManagerWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;NotificationWorker&gt;</span>false<span class="nt">&lt;/NotificationWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;EmailListener&gt;</span>false<span class="nt">&lt;/EmailListener&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;IndexTasksQueue&gt;</span>false<span class="nt">&lt;/IndexTasksQueue&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ProcessEngineQueueProcessing&gt;</span>false<span class="nt">&lt;/ProcessEngineQueueProcessing&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ProcessEngineTimerProcessing&gt;</span>false<span class="nt">&lt;/ProcessEngineTimerProcessing&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SyncThread&gt;</span>false<span class="nt">&lt;/SyncThread&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SwitchOnFullTextSearch&gt;</span>false<span class="nt">&lt;/SwitchOnFullTextSearch&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;PerformanceMonitoring&gt;</span>false<span class="nt">&lt;/PerformanceMonitoring&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ConfigurationId&gt;</span>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX<span class="nt">&lt;/ConfigurationId&gt;</span></code> <br/><code><span class="nt">&lt;/WorkerEngine&gt;</span></code> <br/></pre></code></div>
<p>Скопировать и сохранить значение из строки
<code>&lt;ConfigurationId&gt;XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX&lt;/ConfigurationId&gt;</code></p>
<div class="highlight"><code><pre><span></span><code>chown<span class="w"> </span>www-data:<span class="w"> </span>/var/www/&lt;instanceName&gt;/Workers.config</code> <br/></pre></code></div>
<h3 id="на-сервере-приложения-cbap_test_2---10002">На сервере Приложения cbap_test_2 - 10.0.0.2</h3>
<p>Установлена версия CBAP, создан экземпляр с именем <code>&lt;instanceName&gt;</code>
Проверить/изменить конфигурацию Apache Ignite 
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/var/www/&lt;instanceName&gt;/Ignite.config</code> <br/></pre></code></div></p>
<p>заменить значения в <code>"localAddress"</code> - указать IP
прописать IP узлов кластера Apache Ignite
проверить размер выделенной памяти
<div class="highlight"><code><pre><span></span><code><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"discoverySpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.discovery.tcp.TcpDiscoverySpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localAddress"</span><span class="w"> </span><span class="na">value=</span><span class="s">"10.0.0.2"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPort"</span><span class="w"> </span><span class="na">value=</span><span class="s">"47510"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPortRange"</span><span class="w"> </span><span class="na">value=</span><span class="s">"9"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"ipFinder"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.discovery.tcp.ipfinder.vm.TcpDiscoveryVmIpFinder"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"addresses"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;list&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.1:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.2:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.3:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;/list&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"communicationSpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.communication.tcp.TcpCommunicationSpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPort"</span><span class="w"> </span><span class="na">value=</span><span class="s">"47101"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localAddress"</span><span class="w"> </span><span class="na">value=</span><span class="s">"10.0.0.2"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"messageQueueLimit"</span><span class="w"> </span><span class="na">value=</span><span class="s">"1024"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/><code>...</code> <br/><code>...</code> <br/><code><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"dataRegionConfigurations"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;list&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.DataRegionConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"warmUpConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.NoOpWarmUpConfiguration"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"name"</span><span class="w"> </span><span class="na">value=</span><span class="s">"Persistent"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"persistenceEnabled"</span><span class="w"> </span><span class="na">value=</span><span class="s">"true"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"initialSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{1024L * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"maxSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{4L * 1024 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"pageEvictionMode"</span><span class="w"> </span><span class="na">value=</span><span class="s">"RANDOM_2_LRU"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"checkpointPageBufferSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{1024L * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.DataRegionConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"name"</span><span class="w"> </span><span class="na">value=</span><span class="s">"InMemory"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"persistenceEnabled"</span><span class="w"> </span><span class="na">value=</span><span class="s">"false"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"initialSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{10 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"maxSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{256 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;/list&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/></pre></code></div></p>
<p>Выполнить настройку экземпляра Приложения
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/usr/share/comindware/configs/instance/&lt;instanceName&gt;.yml</code> <br/></pre></code></div></p>
<div class="highlight"><code><pre><span></span><code>isFederationAuthEnabled: 0</code> <br/><code>databasePath: /var/lib/comindware/&lt;instanceName&gt;/Database</code> <br/><code># /var/lib/comindware/&lt;instanceName&gt; ==&gt; /db/&lt;instanceName&gt;</code> <br/><code>configPath: /var/www/&lt;instanceName&gt;</code> <br/><code>backup.config.default.repository.type: LocalDisk</code> <br/><code>backup.config.default.repository.localDisk.path: /var/lib/comindware/&lt;instanceName&gt;/Backup</code> <br/><code>userStorage.type: LocalDisk</code> <br/><code>userStorage.localDisk.path: /mnt/share/&lt;instanceName&gt;/Streams</code> <br/><code>tempStorage.type: LocalDisk</code> <br/><code>tempStorage.localDisk.path: /mnt/share/&lt;instanceName&gt;/Temp</code> <br/><code></code> <br/><code>instanceName: &lt;instanceName&gt;</code> <br/><code>databaseName: &lt;instanceName&gt;</code> <br/><code>configName: &lt;instanceName&gt;</code> <br/><code>nodeName: &lt;instanceName&gt;2 ## у каждого узла своё имя</code> <br/><code></code> <br/><code>mq.server: 10.0.0.1:9092 ## all nodes to single kafka</code> <br/><code>mq.group: &lt;instanceName&gt;</code> <br/><code>manageAdapterHost: true</code> <br/><code>elasticsearchUri: http://localhost:9200</code> <br/><code>version: 4.7.2604.0</code> <br/></pre></code></div>
<p>Открыть файл конфигурации работающих служб
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/var/www/&lt;instanceName&gt;/Workers.config</code> <br/></pre></code></div></p>
<p>Проверить установленный статус служб,</p>
<blockquote>
<p>[!note] Обратить внимание на то, что только ОДИН узел в кластере должен иметь включённые службы <code>BackupSessionsQueue</code> или <code>ProcessEngineQueueProcessing</code></p>
</blockquote>
<div class="highlight"><code><pre><span></span><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></code> <br/><code><span class="nt">&lt;WorkerEngine</span><span class="w"> </span><span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-i</span><span class="nt">&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;RebuildThreadWorker&gt;</span>false<span class="nt">&lt;/RebuildThreadWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;BackupSessionsQueue&gt;</span>false<span class="nt">&lt;/BackupSessionsQueue&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SessionManagerWorker&gt;</span>false<span class="nt">&lt;/SessionManagerWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;NotificationWorker&gt;</span>false<span class="nt">&lt;/NotificationWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;EmailListener&gt;</span>true<span class="nt">&lt;/EmailListener&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;IndexTasksQueue&gt;</span>false<span class="nt">&lt;/IndexTasksQueue&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ProcessEngineQueueProcessing&gt;</span>true<span class="nt">&lt;/ProcessEngineQueueProcessing&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ProcessEngineTimerProcessing&gt;</span>false<span class="nt">&lt;/ProcessEngineTimerProcessing&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SyncThread&gt;</span>false<span class="nt">&lt;/SyncThread&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SwitchOnFullTextSearch&gt;</span>false<span class="nt">&lt;/SwitchOnFullTextSearch&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;PerformanceMonitoring&gt;</span>false<span class="nt">&lt;/PerformanceMonitoring&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ConfigurationId&gt;</span>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX<span class="nt">&lt;/ConfigurationId&gt;</span></code> <br/><code><span class="nt">&lt;/WorkerEngine&gt;</span></code> <br/></pre></code></div>
<p>Запустить экземпляр Приложения,
<div class="highlight"><code><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>comindware&lt;instanceName&gt;</code> <br/></pre></code></div></p>
<p>Выполнить запрос через браузер
после выполнения обращения через браузер на втором узле перейти в директорию со скриптами Apache Ignite и выполнить запрос топологии
<div class="highlight"><code><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/home/username/ignite/bin</code> <br/><code>watch<span class="w"> </span>bash<span class="w"> </span>control.sh<span class="w"> </span>--baseline</code> <br/></pre></code></div>
Дождаться включения второго узла в топологию
Дождаться возможности входа в систему через браузер</p>
<h3 id="на-сервере-приложениcbap-test3---10003">На сервере Приложениcbap-test3 - 10.0.0.3</h3>
<p>Установлена версия CBAP, создан экземпляр с именем <code>&lt;instanceName&gt;</code></p>
<p>Проверить/изменить конфигурацию Apache Ignite 
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/var/www/&lt;instanceName&gt;/Ignite.config</code> <br/></pre></code></div></p>
<p>заменить значения в <code>"localAddress"</code> - указать IP
прописать IP узлов кластера Apache Ignite
проверить размер выделенной памяти
<div class="highlight"><code><pre><span></span><code><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"discoverySpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.discovery.tcp.TcpDiscoverySpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localAddress"</span><span class="w"> </span><span class="na">value=</span><span class="s">"10.0.0.3"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPort"</span><span class="w"> </span><span class="na">value=</span><span class="s">"47510"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPortRange"</span><span class="w"> </span><span class="na">value=</span><span class="s">"9"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"ipFinder"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.discovery.tcp.ipfinder.vm.TcpDiscoveryVmIpFinder"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"addresses"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;list&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.1:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.2:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;value&gt;</span>10.0.0.3:47510..47519<span class="nt">&lt;/value&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;/list&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"communicationSpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.spi.communication.tcp.TcpCommunicationSpi"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localPort"</span><span class="w"> </span><span class="na">value=</span><span class="s">"47101"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"localAddress"</span><span class="w"> </span><span class="na">value=</span><span class="s">"10.0.0.3"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"messageQueueLimit"</span><span class="w"> </span><span class="na">value=</span><span class="s">"1024"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/><code>...</code> <br/><code>...</code> <br/><code><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"dataRegionConfigurations"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;list&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.DataRegionConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"warmUpConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">                </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.NoOpWarmUpConfiguration"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"name"</span><span class="w"> </span><span class="na">value=</span><span class="s">"Persistent"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"persistenceEnabled"</span><span class="w"> </span><span class="na">value=</span><span class="s">"true"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"initialSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{1024L * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"maxSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{4L * 1024 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"pageEvictionMode"</span><span class="w"> </span><span class="na">value=</span><span class="s">"RANDOM_2_LRU"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"checkpointPageBufferSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{1024L * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">"org.apache.ignite.configuration.DataRegionConfiguration"</span><span class="nt">&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"name"</span><span class="w"> </span><span class="na">value=</span><span class="s">"InMemory"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"persistenceEnabled"</span><span class="w"> </span><span class="na">value=</span><span class="s">"false"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"initialSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{10 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">              </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"maxSize"</span><span class="w"> </span><span class="na">value=</span><span class="s">"#{256 * 1024 * 1024}"</span><span class="w"> </span><span class="nt">/&gt;</span></code> <br/><code><span class="w">            </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">          </span><span class="nt">&lt;/list&gt;</span></code> <br/><code><span class="w">        </span><span class="nt">&lt;/property&gt;</span></code> <br/><code><span class="w">      </span><span class="nt">&lt;/bean&gt;</span></code> <br/><code><span class="w">    </span><span class="nt">&lt;/property&gt;</span></code> <br/></pre></code></div></p>
<p>Проверить установленный статус служб,</p>
<blockquote>
<p>[!note] Обратить внимание на то, что только ОДИН узел в кластере должен иметь включённые службы <code>BackupSessionsQueue</code> или <code>ProcessEngineQueueProcessing</code></p>
</blockquote>
<div class="highlight"><code><pre><span></span><code>nano<span class="w"> </span>/var/www/&lt;instanceName&gt;/Workers.config</code> <br/></pre></code></div>
<div class="highlight"><code><pre><span></span><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></code> <br/><code><span class="nt">&lt;WorkerEngine</span><span class="w"> </span><span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-i</span><span class="nt">&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;RebuildThreadWorker&gt;</span>false<span class="nt">&lt;/RebuildThreadWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;BackupSessionsQueue&gt;</span>false<span class="nt">&lt;/BackupSessionsQueue&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SessionManagerWorker&gt;</span>false<span class="nt">&lt;/SessionManagerWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;NotificationWorker&gt;</span>false<span class="nt">&lt;/NotificationWorker&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;EmailListener&gt;</span>true<span class="nt">&lt;/EmailListener&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;IndexTasksQueue&gt;</span>false<span class="nt">&lt;/IndexTasksQueue&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ProcessEngineQueueProcessing&gt;</span>false<span class="nt">&lt;/ProcessEngineQueueProcessing&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ProcessEngineTimerProcessing&gt;</span>false<span class="nt">&lt;/ProcessEngineTimerProcessing&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SyncThread&gt;</span>false<span class="nt">&lt;/SyncThread&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;SwitchOnFullTextSearch&gt;</span>false<span class="nt">&lt;/SwitchOnFullTextSearch&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;PerformanceMonitoring&gt;</span>false<span class="nt">&lt;/PerformanceMonitoring&gt;</span></code> <br/><code><span class="w">  </span><span class="nt">&lt;ConfigurationId&gt;</span>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX<span class="nt">&lt;/ConfigurationId&gt;</span></code> <br/><code><span class="nt">&lt;/WorkerEngine&gt;</span></code> <br/></pre></code></div>
<p>Запустить экземпляр Приложения,
<div class="highlight"><code><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>comindware&lt;instanceName&gt;</code> <br/></pre></code></div></p>
<p>Выполнить запрос через браузер
после выполнения обращения через браузер на втором узле перейти в директорию со скриптами Apache Ignite и выполнить запрос топологии
<div class="highlight"><code><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/home/username/ignite/bin</code> <br/><code>watch<span class="w"> </span>bash<span class="w"> </span>control.sh<span class="w"> </span>--baseline</code> <br/></pre></code></div>
Дождаться включения второго узла в топологию
Дождаться возможности входа в систему через браузер</p>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>