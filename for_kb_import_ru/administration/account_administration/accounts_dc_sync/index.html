<div class="md-body" data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="comindware" dir="ltr" kb-id="4655" kb-tags="Active Directory,LDAP,Аккаунты,Администрирование,Каталоги,Сервер каталогов,Синхронизация" kb-title="Синхронизация с сервером каталогов (Active Directory)">
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<nav aria-label="Содержание" class="md-nav md-nav--secondary">
<div class="mce-toc">
<h2 class="toc-heading">
      Содержание
      </h2>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#accounts_dc_sync_mechanism">
<span class="md-ellipsis">
      Механизм синхронизации с сервером каталогов (Active Directory)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#accounts_dc_sync_attributes">
<span class="md-ellipsis">
      Сопоставление атрибутов Comindware Platform и Сервера каталогов
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#accounts_dc_sync_authorization">
<span class="md-ellipsis">
      Механизм авторизации через сервер каталогов (Active Directory)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link mkdocs_imported_link" href="#accounts_dc_sync_setup">
<span class="md-ellipsis">
      Настройка подключения к серверу каталогов (Active Directory)
    </span>
</a>
</li>
</ul>
</div>
</nav>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h2 id="accounts_dc_sync_mechanism">Механизм синхронизации с сервером каталогов (Active Directory)</h2>
<p>Для подключения к серверу каталогов (например, Active Directory (AD)) используется заданное имя или IP адрес сервера.</p>
<p>При необходимости возможно указать номер порта через двоеточие в строке адреса сервера. <strong>Comindware Platform</strong> задаёт авторизованные (IANA) порты для безопасного и небезопасного соединения.</p>
<p>Если сервер поддерживает безопасную передачу данных, укажите LDAPS (LDAP с шифрованием по SSL или TLS) порт 636 для установления данного соединения, в противном случае сервером будет выбран LDAP порт 389.</p>
<p>Так же необходимо указать базовое имя (DN) – запись в директории, из которой будут выполняться поисковые запросы. Базовое DN LDAP похоже на путь в файловой системе, но указывается в следующем порядке: первым – относительное отличительное имя (RDN) и далее поднимается по дереву слева направо. Например, базовое имя (DN) может выглядеть следующим образом: <code>CN=Иван Иванов, OU=Users, DC=example, DC=com</code>. Базовое имя ограничивает доступ к серверу каталогов.</p>
<p><strong>Режимы синхронизации:</strong></p>
<ul>
<li>принудительный — режим, при котором краткосрочные соединения создаются пользователем при нажатии кнопок «<strong>Проверить соединение</strong>», «<strong>Синхронизировать</strong>», «<strong>Получить перечень групп из AD</strong>»;</li>
<li>событийный — режим, при котором фоновое соединение создаётся один раз при нажатии кнопки «<strong>Сохранить</strong>» и остаётся открытым до следующего изменения настроек. Любое изменение группы на сервере AD (то есть событие) приводит к синхронизации с Системой.</li>
<li>по расписанию — режим, при котором соединение создаётся каждый раз согласно указанному расписанию.</li>
</ul>
<p>Все изменения пользователей на сервере AD синхронизируются с Системой только принудительно или по расписанию.</p>
<div class="admonition примечание">
<p class="admonition-title">Примечание</p>
<ul>
<li>После смены домена Active Directory во время синхронизации обновятся данные аккаунтов, при этом сохранится привязка аккаунтов к <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4803">ролям в приложении</a> и <a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4662">системным ролям</a>.</li>
<li>Если на стороне Active Directory у аккаунта сменилось имя пользователя, в Системе будет создан новый аккаунт.</li>
</ul>
</div>
<p>Система хранит данные о версии загружаемого объекта. При создании повторного соединения, система запрашивает данные, проверяет версию каждого объекта, если она изменилась, то данные синхронизируются.</p>
<p><strong>Типы синхронизации:</strong></p>
<ul>
<li>синхронизация всех пользователей — в Системе создаются все пользователи, которые состоят в RDN;</li>
<li>выбор групп для синхронизации — можно выбрать группы, которые состоят в RDN; в Системе создаются группы, подгруппы и аккаунты, состоящие в выбранных группах; в Системе не отображается, что подгруппа состоит в группе.</li>
</ul>
<h2 class="pageBreakBefore" id="accounts_dc_sync_attributes">Сопоставление атрибутов Comindware Platform и Сервера каталогов</h2>
<div class="notice notice-warning">
<p class="admonition-title">Обязательные атрибуты</p>
<p>Для корректной синхронизации аккаунтов с <strong>Comindware Platform</strong> на стороне сервера каталогов должны быть обязательно заданы значения следующих атрибутов (они не должны быть пустыми и не должны иметь значение <code>Null</code>):</p>
<ul>
<li><code>sAMAccountName</code> (Имя пользователя)</li>
<li><code>userAccountControl</code> (Включён)</li>
<li><code>mail</code> (Адрес эл. почты)</li>
<li><code>objectSid</code> (SID)</li>
<li><code>uSNChanged</code> (Версия объекта)</li>
<li><code>distinguishedName</code> (Уникальное имя)</li>
</ul>
</div>
<table style="width: 100%;">
<thead>
<tr>
<th>Comindware Platform</th>
<th>Active Directory</th>
</tr>
<tr>
<th>Название</th>
<th>Системное имя</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Имя пользователя</strong></td>
<td><strong>sAMAccountName</strong></td>
</tr>
<tr>
<td><strong>Включён</strong></td>
<td><strong>userAccountControl</strong></td>
</tr>
<tr>
<td><strong>Адрес эл. почты</strong></td>
<td><strong>mail</strong></td>
</tr>
<tr>
<td><strong>SID</strong></td>
<td><strong>objectSid</strong></td>
</tr>
<tr>
<td><strong>Версия объекта</strong></td>
<td><strong>uSNChanged</strong></td>
</tr>
<tr>
<td><strong>Уникальное имя</strong></td>
<td><strong>distinguishedName</strong></td>
</tr>
<tr>
<td>Ф. И. О.</td>
<td>displayName</td>
</tr>
<tr>
<td>Имя</td>
<td>givenName</td>
</tr>
<tr>
<td>Должность</td>
<td>title</td>
</tr>
<tr>
<td>Отдел</td>
<td>department</td>
</tr>
<tr>
<td>Офис</td>
<td>physicalDeliveryOfficeName</td>
</tr>
<tr>
<td>Skype</td>
<td>pager</td>
</tr>
<tr>
<td>Руководитель</td>
<td>manager</td>
</tr>
<tr>
<td>Телефон</td>
<td>telephoneNumber</td>
</tr>
<tr>
<td>Фото профиля</td>
<td>thumbnailPhoto</td>
</tr>
<tr>
<td>Язык</td>
<td>preferredLanguage</td>
</tr>
</tbody>
</table>
<h2 class="pageBreakBefore" id="accounts_dc_sync_authorization">Механизм авторизации через сервер каталогов (Active Directory)</h2>
<p>После ввода адреса эл. почты или имени пользователя и пароля на начальной странице Система идентифицирует аккаунт в собственной базе данных. Если аккаунт существует в базе данных Системы и у него указана проверка подлинности по LDAP или по федеративной аутентификации, то Система посылает запрос в Active Directory или Active Directory Federation Services для аутентификации имени пользователя и пароля. В случае успеха создаётся токен сеанса, который при последующих веб-запросах автоматически передаётся в Систему и позволяет ей получить информацию о текущем пользователе для авторизации запроса. В собственной базе данных Система пароль не хранит.</p>
<p>Если в свойствах аккаунта изменить <strong>Способ аутентификации</strong> на <strong>Локальную аутентификацию</strong>, то авторизация пользователя будет проходить локально. Администратор может сменить пароль аккаунта непосредственно в Системе, в таком случае при последующей синхронизации с Active Directory пароль не будет перезаписан. Пароль хранится в базе данных Системы.</p>
<h2 id="accounts_dc_sync_setup">Настройка подключения к серверу каталогов (Active Directory)</h2>
<p>Инструкции по настройке подключения к серверу каталогов см. в следующих статьях:</p>
<div class="relatedTopics">
<p><strong>Comindware Platform</strong></p>
<ul>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4687">Сервер каталогов. Настройка подключения</a></li>
</ul>
<p><strong>Linux</strong></p>
<ul>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4605">Аутентификация через Active Directory. Настройка контроллера домена и экземпляра ПО</a></li>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4613">Аутентификация через единый вход (SSO). Настройка контроллера домена, экземпляра ПО и компьютера конечного пользователя</a></li>
</ul>
<p><strong>Windows</strong></p>
<ul>
<li><a class="mkdocs_imported_link" href="https://kb.comindware.ru/article.php?id=4657">Настройка единого входа (SSO-аутентификации) в ОС Windows</a></li>
</ul>
</div>
</article>
</div>
</div>
<a class="md-top md-icon mkdocs_imported_link" data-md-component="top" href="#">
<i class="fa-light fa-arrow-up">&zwnj;<!--icon--></i>
            К началу
          </a>
</main>
</div>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></div>